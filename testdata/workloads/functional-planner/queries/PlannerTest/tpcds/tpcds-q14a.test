# TPCDS-Q14a first of two
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1999 AND 1999 + 2
 intersect 
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1999 AND 1999 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1999 AND 1999 + 2) t1
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1999 and 1999 + 2
       union all 
       select cs_quantity quantity 
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1999 and 1999 + 2 
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1999 and 1999 + 2) x)
 select channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1999+2 
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1999+2 
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1999+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
LIMIT 100
---- PLAN
Max Per-Host Resource Reservation: Memory=99.50MB Threads=16
Per-Host Resource Estimates: Memory=1.07GB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=1.07GB mem-reservation=99.50MB thread-reservation=16 runtime-filters-memory=10.00MB
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
126:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100
|  in pipelines: 126(GETNEXT), 125(OPEN)
|
125:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=101.43K
|  in pipelines: 125(GETNEXT), 124(OPEN)
|
124:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=64.00MB mem-reservation=39.81MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=101.43K
|  in pipelines: 124(GETNEXT), 29(OPEN), 70(OPEN), 111(OPEN)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=54.00K
|  in pipelines: 29(GETNEXT), 70(GETNEXT), 111(GETNEXT)
|
|--123:NESTED LOOP JOIN [INNER JOIN]
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=18.00K
|  |  in pipelines: 111(GETNEXT), 122(OPEN)
|  |
|  |--122:AGGREGATE [FINALIZE]
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1
|  |  |  in pipelines: 122(GETNEXT), 113(OPEN), 116(OPEN), 119(OPEN)
|  |  |
|  |  112:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=5.04M
|  |  |  in pipelines: 113(GETNEXT), 116(GETNEXT), 119(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF107[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=719.38K
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--120:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_parquet.web_sales]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF107[min_max] -> ws_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=94 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  |--118:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF105[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=1.44M
|  |  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |  |
|  |  |  |--117:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  116:SCAN HDFS [tpcds_parquet.catalog_sales]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF105[min_max] -> cs_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=144.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=92 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 116(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=2.88M
|  |  |  in pipelines: 113(GETNEXT), 114(OPEN)
|  |  |
|  |  |--114:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:SCAN HDFS [tpcds_parquet.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=90 row-size=12B cardinality=2.88M
|  |     in pipelines: 113(GETNEXT)
|  |
|  111:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=18.00K
|  |  in pipelines: 111(GETNEXT), 83(OPEN)
|  |
|  110:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  runtime filters: RF073[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 86(OPEN)
|  |
|  |--107:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  |  fk/pk conjuncts: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  |  runtime filters: RF081[min_max] <- iss.i_brand_id, RF082[min_max] <- iss.i_category_id, RF083[min_max] <- iss.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=71,75 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 86(GETNEXT), 92(OPEN)
|  |  |
|  |  |--106:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 92(GETNEXT), 105(OPEN)
|  |  |  |
|  |  |  |--105:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=167 row-size=12B cardinality=18.00K
|  |  |  |  |  in pipelines: 105(GETNEXT), 98(OPEN)
|  |  |  |  |
|  |  |  |  102:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  runtime filters: RF099[min_max] <- d3.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=81,82,83 row-size=40B cardinality=719.38K
|  |  |  |  |  in pipelines: 98(GETNEXT), 100(OPEN)
|  |  |  |  |
|  |  |  |  |--100:SCAN HDFS [tpcds_parquet.date_dim d3]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K
|  |  |  |  |     in pipelines: 100(GETNEXT)
|  |  |  |  |
|  |  |  |  101:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=81,82 row-size=32B cardinality=719.38K
|  |  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |  |
|  |  |  |  |--99:SCAN HDFS [tpcds_parquet.item iws]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=82 row-size=20B cardinality=18.00K
|  |  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  98:SCAN HDFS [tpcds_parquet.web_sales]
|  |  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |  |     runtime filters: RF099[min_max] -> ws_sold_date_sk, RF101[min_max] -> ws_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=719.38K size=45.09MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |  |     mem-estimate=64.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |     tuple-ids=81 row-size=12B cardinality=719.38K
|  |  |  |     in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 92(GETNEXT), 103(OPEN)
|  |  |  |
|  |  |  |--103:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=166 row-size=12B cardinality=18.00K
|  |  |  |  |  in pipelines: 103(GETNEXT), 93(OPEN)
|  |  |  |  |
|  |  |  |  97:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  runtime filters: RF095[min_max] <- d2.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=77,78,79 row-size=40B cardinality=1.44M
|  |  |  |  |  in pipelines: 93(GETNEXT), 95(OPEN)
|  |  |  |  |
|  |  |  |  |--95:SCAN HDFS [tpcds_parquet.date_dim d2]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K
|  |  |  |  |     in pipelines: 95(GETNEXT)
|  |  |  |  |
|  |  |  |  96:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=77,78 row-size=32B cardinality=1.44M
|  |  |  |  |  in pipelines: 93(GETNEXT), 94(OPEN)
|  |  |  |  |
|  |  |  |  |--94:SCAN HDFS [tpcds_parquet.item ics]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=78 row-size=20B cardinality=18.00K
|  |  |  |  |     in pipelines: 94(GETNEXT)
|  |  |  |  |
|  |  |  |  93:SCAN HDFS [tpcds_parquet.catalog_sales]
|  |  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |  |     runtime filters: RF095[min_max] -> cs_sold_date_sk, RF097[min_max] -> cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=1.44M size=96.62MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |     tuple-ids=77 row-size=12B cardinality=1.44M
|  |  |  |     in pipelines: 93(GETNEXT)
|  |  |  |
|  |  |  92:AGGREGATE [FINALIZE]
|  |  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 92(GETNEXT), 87(OPEN)
|  |  |  |
|  |  |  91:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=72,73,74 row-size=40B cardinality=2.88M
|  |  |  |  in pipelines: 87(GETNEXT), 89(OPEN)
|  |  |  |
|  |  |  |--89:SCAN HDFS [tpcds_parquet.date_dim d1]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=74 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 89(GETNEXT)
|  |  |  |
|  |  |  90:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  |  runtime filters: RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=72,73 row-size=32B cardinality=2.88M
|  |  |  |  in pipelines: 87(GETNEXT), 88(OPEN)
|  |  |  |
|  |  |  |--88:SCAN HDFS [tpcds_parquet.item iss]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=73 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  87:SCAN HDFS [tpcds_parquet.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |  |     runtime filters: RF093[min_max] -> ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.88M size=200.96MB
|  |  |       partitions: 1824/1824 rows=2.88M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=72 row-size=12B cardinality=2.88M
|  |  |     in pipelines: 87(GETNEXT)
|  |  |
|  |  86:SCAN HDFS [tpcds_parquet.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF081[min_max] -> i_brand_id, RF082[min_max] -> i_category_id, RF083[min_max] -> i_class_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=71 row-size=20B cardinality=18.00K
|  |     in pipelines: 86(GETNEXT)
|  |
|  109:HASH JOIN [INNER JOIN]
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 84(OPEN)
|  |
|  |--84:SCAN HDFS [tpcds_parquet.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF073[min_max] -> tpcds_parquet.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=69 row-size=20B cardinality=18.00K
|  |     in pipelines: 84(GETNEXT)
|  |
|  108:HASH JOIN [INNER JOIN]
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  runtime filters: RF076[bloom] <- d_date_sk, RF077[min_max] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 85(OPEN)
|  |
|  |--85:SCAN HDFS [tpcds_parquet.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=70 row-size=12B cardinality=108
|  |     in pipelines: 85(GETNEXT)
|  |
|  83:SCAN HDFS [tpcds_parquet.web_sales]
|     HDFS partitions=1/1 files=2 size=45.09MB
|     runtime filters: RF077[min_max] -> ws_sold_date_sk, RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk
|     stored statistics:
|       table: rows=719.38K size=45.09MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=644.77K
|     mem-estimate=128.00MB mem-reservation=4.00MB thread-reservation=1
|     tuple-ids=68 row-size=20B cardinality=42.85K(filtered from 719.38K)
|     in pipelines: 83(GETNEXT)
|
|--82:NESTED LOOP JOIN [INNER JOIN]
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=18.00K
|  |  in pipelines: 70(GETNEXT), 81(OPEN)
|  |
|  |--81:AGGREGATE [FINALIZE]
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1
|  |  |  in pipelines: 81(GETNEXT), 72(OPEN), 75(OPEN), 78(OPEN)
|  |  |
|  |  71:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=5.04M
|  |  |  in pipelines: 72(GETNEXT), 75(GETNEXT), 78(GETNEXT)
|  |  |
|  |  |--80:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF071[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=719.38K
|  |  |  |  in pipelines: 78(GETNEXT), 79(OPEN)
|  |  |  |
|  |  |  |--79:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 79(GETNEXT)
|  |  |  |
|  |  |  78:SCAN HDFS [tpcds_parquet.web_sales]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF071[min_max] -> ws_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=60 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 78(GETNEXT)
|  |  |
|  |  |--77:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF069[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=1.44M
|  |  |  |  in pipelines: 75(GETNEXT), 76(OPEN)
|  |  |  |
|  |  |  |--76:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 76(GETNEXT)
|  |  |  |
|  |  |  75:SCAN HDFS [tpcds_parquet.catalog_sales]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF069[min_max] -> cs_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=144.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=58 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=2.88M
|  |  |  in pipelines: 72(GETNEXT), 73(OPEN)
|  |  |
|  |  |--73:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 73(GETNEXT)
|  |  |
|  |  72:SCAN HDFS [tpcds_parquet.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=56 row-size=12B cardinality=2.88M
|  |     in pipelines: 72(GETNEXT)
|  |
|  70:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=18.00K
|  |  in pipelines: 70(GETNEXT), 42(OPEN)
|  |
|  69:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  runtime filters: RF037[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 45(OPEN)
|  |
|  |--66:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  |  fk/pk conjuncts: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  |  runtime filters: RF045[min_max] <- iss.i_brand_id, RF046[min_max] <- iss.i_category_id, RF047[min_max] <- iss.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=37,41 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 45(GETNEXT), 51(OPEN)
|  |  |
|  |  |--65:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 51(GETNEXT), 64(OPEN)
|  |  |  |
|  |  |  |--64:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=146 row-size=12B cardinality=18.00K
|  |  |  |  |  in pipelines: 64(GETNEXT), 57(OPEN)
|  |  |  |  |
|  |  |  |  61:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  runtime filters: RF063[min_max] <- d3.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=47,48,49 row-size=40B cardinality=719.38K
|  |  |  |  |  in pipelines: 57(GETNEXT), 59(OPEN)
|  |  |  |  |
|  |  |  |  |--59:SCAN HDFS [tpcds_parquet.date_dim d3]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K
|  |  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  60:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=47,48 row-size=32B cardinality=719.38K
|  |  |  |  |  in pipelines: 57(GETNEXT), 58(OPEN)
|  |  |  |  |
|  |  |  |  |--58:SCAN HDFS [tpcds_parquet.item iws]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=48 row-size=20B cardinality=18.00K
|  |  |  |  |     in pipelines: 58(GETNEXT)
|  |  |  |  |
|  |  |  |  57:SCAN HDFS [tpcds_parquet.web_sales]
|  |  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |  |     runtime filters: RF063[min_max] -> ws_sold_date_sk, RF065[min_max] -> ws_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=719.38K size=45.09MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |  |     mem-estimate=64.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |     tuple-ids=47 row-size=12B cardinality=719.38K
|  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  63:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 51(GETNEXT), 62(OPEN)
|  |  |  |
|  |  |  |--62:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=145 row-size=12B cardinality=18.00K
|  |  |  |  |  in pipelines: 62(GETNEXT), 52(OPEN)
|  |  |  |  |
|  |  |  |  56:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  runtime filters: RF059[min_max] <- d2.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=43,44,45 row-size=40B cardinality=1.44M
|  |  |  |  |  in pipelines: 52(GETNEXT), 54(OPEN)
|  |  |  |  |
|  |  |  |  |--54:SCAN HDFS [tpcds_parquet.date_dim d2]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K
|  |  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  55:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=43,44 row-size=32B cardinality=1.44M
|  |  |  |  |  in pipelines: 52(GETNEXT), 53(OPEN)
|  |  |  |  |
|  |  |  |  |--53:SCAN HDFS [tpcds_parquet.item ics]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  |     tuple-ids=44 row-size=20B cardinality=18.00K
|  |  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |  |
|  |  |  |  52:SCAN HDFS [tpcds_parquet.catalog_sales]
|  |  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |  |     runtime filters: RF059[min_max] -> cs_sold_date_sk, RF061[min_max] -> cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=1.44M size=96.62MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |     tuple-ids=43 row-size=12B cardinality=1.44M
|  |  |  |     in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  51:AGGREGATE [FINALIZE]
|  |  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 51(GETNEXT), 46(OPEN)
|  |  |  |
|  |  |  50:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=38,39,40 row-size=40B cardinality=2.88M
|  |  |  |  in pipelines: 46(GETNEXT), 48(OPEN)
|  |  |  |
|  |  |  |--48:SCAN HDFS [tpcds_parquet.date_dim d1]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=40 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  49:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  |  runtime filters: RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=38,39 row-size=32B cardinality=2.88M
|  |  |  |  in pipelines: 46(GETNEXT), 47(OPEN)
|  |  |  |
|  |  |  |--47:SCAN HDFS [tpcds_parquet.item iss]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=39 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 47(GETNEXT)
|  |  |  |
|  |  |  46:SCAN HDFS [tpcds_parquet.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |  |     runtime filters: RF057[min_max] -> ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.88M size=200.96MB
|  |  |       partitions: 1824/1824 rows=2.88M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=38 row-size=12B cardinality=2.88M
|  |  |     in pipelines: 46(GETNEXT)
|  |  |
|  |  45:SCAN HDFS [tpcds_parquet.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF045[min_max] -> i_brand_id, RF046[min_max] -> i_category_id, RF047[min_max] -> i_class_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=37 row-size=20B cardinality=18.00K
|  |     in pipelines: 45(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 43(OPEN)
|  |
|  |--43:SCAN HDFS [tpcds_parquet.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF037[min_max] -> tpcds_parquet.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=35 row-size=20B cardinality=18.00K
|  |     in pipelines: 43(GETNEXT)
|  |
|  67:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  runtime filters: RF040[bloom] <- d_date_sk, RF041[min_max] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 44(OPEN)
|  |
|  |--44:SCAN HDFS [tpcds_parquet.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=36 row-size=12B cardinality=108
|  |     in pipelines: 44(GETNEXT)
|  |
|  42:SCAN HDFS [tpcds_parquet.catalog_sales]
|     HDFS partitions=1/1 files=3 size=96.62MB
|     runtime filters: RF041[min_max] -> cs_sold_date_sk, RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=96.62MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=650.14K
|     mem-estimate=192.00MB mem-reservation=4.00MB thread-reservation=1
|     tuple-ids=34 row-size=20B cardinality=85.31K(filtered from 1.44M)
|     in pipelines: 42(GETNEXT)
|
41:NESTED LOOP JOIN [INNER JOIN]
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=18.00K
|  in pipelines: 29(GETNEXT), 40(OPEN)
|
|--40:AGGREGATE [FINALIZE]
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1
|  |  in pipelines: 40(GETNEXT), 31(OPEN), 34(OPEN), 37(OPEN)
|  |
|  30:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=5.04M
|  |  in pipelines: 31(GETNEXT), 34(GETNEXT), 37(GETNEXT)
|  |
|  |--39:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  runtime filters: RF035[min_max] <- d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=719.38K
|  |  |  in pipelines: 37(GETNEXT), 38(OPEN)
|  |  |
|  |  |--38:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 38(GETNEXT)
|  |  |
|  |  37:SCAN HDFS [tpcds_parquet.web_sales]
|  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |     runtime filters: RF035[min_max] -> ws_sold_date_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=45.09MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=26 row-size=12B cardinality=719.38K
|  |     in pipelines: 37(GETNEXT)
|  |
|  |--36:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  runtime filters: RF033[min_max] <- d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=1.44M
|  |  |  in pipelines: 34(GETNEXT), 35(OPEN)
|  |  |
|  |  |--35:SCAN HDFS [tpcds_parquet.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 35(GETNEXT)
|  |  |
|  |  34:SCAN HDFS [tpcds_parquet.catalog_sales]
|  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |     runtime filters: RF033[min_max] -> cs_sold_date_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=96.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |     mem-estimate=144.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=24 row-size=12B cardinality=1.44M
|  |     in pipelines: 34(GETNEXT)
|  |
|  33:HASH JOIN [INNER JOIN]
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=2.88M
|  |  in pipelines: 31(GETNEXT), 32(OPEN)
|  |
|  |--32:SCAN HDFS [tpcds_parquet.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=23 row-size=8B cardinality=7.30K
|  |     in pipelines: 32(GETNEXT)
|  |
|  31:SCAN HDFS [tpcds_parquet.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=22 row-size=12B cardinality=2.88M
|     in pipelines: 31(GETNEXT)
|
29:AGGREGATE [FINALIZE]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=18.00K
|  in pipelines: 29(GETNEXT), 01(OPEN)
|
28:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: ss_item_sk = i_item_sk
|  runtime filters: RF000[bloom] <- i_item_sk, RF001[min_max] <- i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 04(OPEN)
|
|--25:HASH JOIN [INNER JOIN]
|  |  hash predicates: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  fk/pk conjuncts: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  runtime filters: RF006[bloom] <- iss.i_brand_id, RF007[bloom] <- iss.i_category_id, RF008[bloom] <- iss.i_class_id, RF009[min_max] <- iss.i_brand_id, RF010[min_max] <- iss.i_category_id, RF011[min_max] <- iss.i_class_id
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=3,7 row-size=32B cardinality=18.00K
|  |  in pipelines: 04(GETNEXT), 10(OPEN)
|  |
|  |--24:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  runtime filters: RF012[bloom] <- iws.i_brand_id, RF013[bloom] <- iws.i_category_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 10(GETNEXT), 23(OPEN)
|  |  |
|  |  |--23:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 23(GETNEXT), 16(OPEN)
|  |  |  |
|  |  |  20:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  runtime filters: RF027[min_max] <- d3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,14,15 row-size=40B cardinality=719.38K
|  |  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |  |
|  |  |  |--18:SCAN HDFS [tpcds_parquet.date_dim d3]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=15 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  19:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,14 row-size=32B cardinality=719.38K
|  |  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--17:SCAN HDFS [tpcds_parquet.item iws]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=14 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:SCAN HDFS [tpcds_parquet.web_sales]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF027[min_max] -> ws_sold_date_sk, RF029[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=64.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=13 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  22:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 10(GETNEXT), 21(OPEN)
|  |  |
|  |  |--21:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 21(GETNEXT), 11(OPEN)
|  |  |  |
|  |  |  15:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  runtime filters: RF023[min_max] <- d2.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=9,10,11 row-size=40B cardinality=1.44M
|  |  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |  |
|  |  |  |--13:SCAN HDFS [tpcds_parquet.date_dim d2]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=11 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  14:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  runtime filters: RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=9,10 row-size=32B cardinality=1.44M
|  |  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |  |
|  |  |  |--12:SCAN HDFS [tpcds_parquet.item ics]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=10 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  11:SCAN HDFS [tpcds_parquet.catalog_sales]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF023[min_max] -> cs_sold_date_sk, RF025[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=9 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 10(GETNEXT), 05(OPEN)
|  |  |
|  |  09:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=4,5,6 row-size=40B cardinality=2.88M
|  |  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |  |
|  |  |--07:SCAN HDFS [tpcds_parquet.date_dim d1]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=6 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 07(GETNEXT)
|  |  |
|  |  08:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  runtime filters: RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=4,5 row-size=32B cardinality=2.88M
|  |  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |  |
|  |  |--06:SCAN HDFS [tpcds_parquet.item iss]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF012[bloom] -> iss.i_brand_id, RF013[bloom] -> iss.i_category_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=5 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 06(GETNEXT)
|  |  |
|  |  05:SCAN HDFS [tpcds_parquet.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     runtime filters: RF021[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=12B cardinality=2.88M
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:SCAN HDFS [tpcds_parquet.item]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF009[min_max] -> i_brand_id, RF010[min_max] -> i_category_id, RF011[min_max] -> i_class_id, RF006[bloom] -> i_brand_id, RF007[bloom] -> i_category_id, RF008[bloom] -> i_class_id
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|     tuple-ids=3 row-size=20B cardinality=18.00K
|     in pipelines: 04(GETNEXT)
|
27:HASH JOIN [INNER JOIN]
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  runtime filters: RF002[bloom] <- i_item_sk, RF003[min_max] <- i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--02:SCAN HDFS [tpcds_parquet.item]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF001[min_max] -> tpcds_parquet.item.i_item_sk, RF000[bloom] -> tpcds_parquet.item.i_item_sk
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|     tuple-ids=1 row-size=20B cardinality=18.00K
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN]
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  runtime filters: RF004[bloom] <- d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=32B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_parquet.date_dim]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=2 row-size=12B cardinality=108
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_parquet.store_sales]
   HDFS partitions=1824/1824 files=1824 size=200.96MB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk, RF002[bloom] -> ss_item_sk
   stored statistics:
     table: rows=2.88M size=200.96MB
     partitions: 1824/1824 rows=2.88M
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
   mem-estimate=48.00MB mem-reservation=1.00MB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=170.55K(filtered from 2.88M)
   in pipelines: 01(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=267.50MB Threads=117
Per-Host Resource Estimates: Memory=3.37GB
F77:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
207:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  limit: 100
|  mem-estimate=16.80KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100
|  in pipelines: 126(GETNEXT)
|
F76:PLAN FRAGMENT [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)] hosts=3 instances=3
Per-Host Resources: mem-estimate=60.00MB mem-reservation=23.81MB thread-reservation=1
126:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100
|  in pipelines: 126(GETNEXT), 125(OPEN)
|
125:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=101.43K
|  in pipelines: 125(GETNEXT), 206(OPEN)
|
206:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=50.00MB mem-reservation=19.06MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=101.43K
|  in pipelines: 206(GETNEXT), 146(OPEN), 172(OPEN), 198(OPEN)
|
205:EXCHANGE [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)]
|  mem-estimate=8.91MB mem-reservation=0B thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=106.81K
|  in pipelines: 146(GETNEXT), 172(GETNEXT), 198(GETNEXT)
|
F75:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
Per-Host Resources: mem-estimate=63.77MB mem-reservation=17.94MB thread-reservation=1
124:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=50.00MB mem-reservation=16.00MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=106.81K
|  in pipelines: 146(GETNEXT), 172(GETNEXT), 198(GETNEXT)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=54.00K
|  in pipelines: 146(GETNEXT), 172(GETNEXT), 198(GETNEXT)
|
|--123:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=18.00K
|  |  in pipelines: 198(GETNEXT), 203(OPEN)
|  |
|  |--204:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1
|  |  |  in pipelines: 203(GETNEXT)
|  |  |
|  |  F74:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  203:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1
|  |  |  in pipelines: 203(GETNEXT), 122(OPEN)
|  |  |
|  |  202:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=3
|  |  |  in pipelines: 122(GETNEXT)
|  |  |
|  |  F73:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=146.02MB mem-reservation=5.94MB thread-reservation=2
|  |  122:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=3
|  |  |  in pipelines: 122(GETNEXT), 113(OPEN), 116(OPEN), 119(OPEN)
|  |  |
|  |  112:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=5.04M
|  |  |  in pipelines: 113(GETNEXT), 116(GETNEXT), 119(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF107[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=719.38K
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--201:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  120:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF107[min_max] -> ws_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=94 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  |--118:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF105[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=1.44M
|  |  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |  |
|  |  |  |--200:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=93 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |  |
|  |  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  117:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  116:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF105[min_max] -> cs_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=144.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=92 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 116(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=2.88M
|  |  |  in pipelines: 113(GETNEXT), 114(OPEN)
|  |  |
|  |  |--199:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=91 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 114(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  114:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=90 row-size=12B cardinality=2.88M
|  |     in pipelines: 113(GETNEXT)
|  |
|  198:AGGREGATE [FINALIZE]
|  |  output: sum:merge(ws_quantity * ws_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=18.00K
|  |  in pipelines: 198(GETNEXT), 83(OPEN)
|  |
|  197:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=520.40KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=25.05K
|  |  in pipelines: 83(GETNEXT)
|  |
|  F50:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  Per-Host Resources: mem-estimate=145.86MB mem-reservation=12.81MB thread-reservation=2 runtime-filters-memory=1.00MB
|  111:AGGREGATE [STREAMING]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=25.05K
|  |  in pipelines: 83(GETNEXT)
|  |
|  110:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  runtime filters: RF073[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 184(OPEN)
|  |
|  |--196:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=682.50KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT)
|  |  |
|  |  F56:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=16.68MB mem-reservation=7.75MB thread-reservation=1
|  |  107:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 86(OPEN)
|  |  |
|  |  |--195:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 86(GETNEXT)
|  |  |  |
|  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=64.28MB mem-reservation=256.00KB thread-reservation=2
|  |  |  86:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=71 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 86(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 193(OPEN)
|  |  |
|  |  |--194:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=137.47KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 193(GETNEXT)
|  |  |  |
|  |  |  F64:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=2 instances=2
|  |  |  Per-Host Resources: mem-estimate=10.24MB mem-reservation=1.94MB thread-reservation=1
|  |  |  193:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 193(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  192:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=242.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F61:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Host Resources: mem-estimate=78.31MB mem-reservation=12.88MB thread-reservation=2
|  |  |  105:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  runtime filters: RF099[min_max] <- d3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=40B cardinality=719.38K
|  |  |  |  in pipelines: 98(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  |--191:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=83 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |  |
|  |  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  100:SCAN HDFS [tpcds_parquet.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  101:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=32B cardinality=719.38K
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--190:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=82 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  F62:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  |  99:SCAN HDFS [tpcds_parquet.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=82 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF099[min_max] -> ws_sold_date_sk, RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=64.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=81 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  104:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 188(OPEN)
|  |  |
|  |  |--189:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=118.31KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 188(GETNEXT)
|  |  |  |
|  |  |  F60:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=3
|  |  |  Per-Host Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  |  188:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 188(GETNEXT), 93(OPEN)
|  |  |  |
|  |  |  187:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 93(GETNEXT)
|  |  |  |
|  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Host Resources: mem-estimate=110.31MB mem-reservation=12.88MB thread-reservation=2
|  |  |  103:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 93(GETNEXT)
|  |  |  |
|  |  |  97:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  runtime filters: RF095[min_max] <- d2.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=40B cardinality=1.44M
|  |  |  |  in pipelines: 93(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  |--186:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=79 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  95:SCAN HDFS [tpcds_parquet.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  96:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=32B cardinality=1.44M
|  |  |  |  in pipelines: 93(GETNEXT), 94(OPEN)
|  |  |  |
|  |  |  |--185:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=78 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 94(GETNEXT)
|  |  |  |  |
|  |  |  |  F58:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  |  94:SCAN HDFS [tpcds_parquet.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=78 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 94(GETNEXT)
|  |  |  |
|  |  |  93:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF095[min_max] -> cs_sold_date_sk, RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=77 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 93(GETNEXT)
|  |  |
|  |  184:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 87(OPEN)
|  |  |
|  |  183:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F53:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=30.31MB mem-reservation=9.38MB thread-reservation=2
|  |  92:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  91:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=40B cardinality=2.88M
|  |  |  in pipelines: 87(GETNEXT), 89(OPEN)
|  |  |
|  |  |--182:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=74 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 89(GETNEXT)
|  |  |  |
|  |  |  F55:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  89:SCAN HDFS [tpcds_parquet.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 89(GETNEXT)
|  |  |
|  |  90:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  runtime filters: RF093[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=32B cardinality=2.88M
|  |  |  in pipelines: 87(GETNEXT), 88(OPEN)
|  |  |
|  |  |--181:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  88:SCAN HDFS [tpcds_parquet.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=73 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  87:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     runtime filters: RF093[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=72 row-size=12B cardinality=2.88M
|  |     in pipelines: 87(GETNEXT)
|  |
|  109:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 84(OPEN)
|  |
|  |--180:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=69 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 84(GETNEXT)
|  |  |
|  |  F52:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  84:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF073[min_max] -> tpcds_parquet.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=69 row-size=20B cardinality=18.00K
|  |     in pipelines: 84(GETNEXT)
|  |
|  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  runtime filters: RF076[bloom] <- d_date_sk, RF077[min_max] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 85(OPEN)
|  |
|  |--179:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=70 row-size=12B cardinality=108
|  |  |  in pipelines: 85(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.06MB mem-reservation=512.00KB thread-reservation=2
|  |  85:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=70 row-size=12B cardinality=108
|  |     in pipelines: 85(GETNEXT)
|  |
|  83:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|     HDFS partitions=1/1 files=2 size=45.09MB
|     runtime filters: RF077[min_max] -> ws_sold_date_sk, RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk
|     stored statistics:
|       table: rows=719.38K size=45.09MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=644.77K
|     mem-estimate=128.00MB mem-reservation=4.00MB thread-reservation=1
|     tuple-ids=68 row-size=20B cardinality=42.85K(filtered from 719.38K)
|     in pipelines: 83(GETNEXT)
|
|--82:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=18.00K
|  |  in pipelines: 172(GETNEXT), 177(OPEN)
|  |
|  |--178:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1
|  |  |  in pipelines: 177(GETNEXT)
|  |  |
|  |  F49:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  177:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1
|  |  |  in pipelines: 177(GETNEXT), 81(OPEN)
|  |  |
|  |  176:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=3
|  |  |  in pipelines: 81(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=146.02MB mem-reservation=5.94MB thread-reservation=2
|  |  81:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=3
|  |  |  in pipelines: 81(GETNEXT), 72(OPEN), 75(OPEN), 78(OPEN)
|  |  |
|  |  71:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=5.04M
|  |  |  in pipelines: 72(GETNEXT), 75(GETNEXT), 78(GETNEXT)
|  |  |
|  |  |--80:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF071[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=719.38K
|  |  |  |  in pipelines: 78(GETNEXT), 79(OPEN)
|  |  |  |
|  |  |  |--175:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 79(GETNEXT)
|  |  |  |  |
|  |  |  |  F47:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  79:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 79(GETNEXT)
|  |  |  |
|  |  |  78:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF071[min_max] -> ws_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=60 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 78(GETNEXT)
|  |  |
|  |  |--77:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  runtime filters: RF069[min_max] <- d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=1.44M
|  |  |  |  in pipelines: 75(GETNEXT), 76(OPEN)
|  |  |  |
|  |  |  |--174:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 76(GETNEXT)
|  |  |  |  |
|  |  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  76:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 76(GETNEXT)
|  |  |  |
|  |  |  75:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF069[min_max] -> cs_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=144.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=58 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=2.88M
|  |  |  in pipelines: 72(GETNEXT), 73(OPEN)
|  |  |
|  |  |--173:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 73(GETNEXT)
|  |  |  |
|  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  73:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 73(GETNEXT)
|  |  |
|  |  72:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=56 row-size=12B cardinality=2.88M
|  |     in pipelines: 72(GETNEXT)
|  |
|  172:AGGREGATE [FINALIZE]
|  |  output: sum:merge(cs_quantity * cs_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=18.00K
|  |  in pipelines: 172(GETNEXT), 42(OPEN)
|  |
|  171:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=622.45KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=42.88K
|  |  in pipelines: 42(GETNEXT)
|  |
|  F25:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=209.86MB mem-reservation=12.81MB thread-reservation=2 runtime-filters-memory=1.00MB
|  70:AGGREGATE [STREAMING]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=42.88K
|  |  in pipelines: 42(GETNEXT)
|  |
|  69:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  runtime filters: RF037[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 158(OPEN)
|  |
|  |--170:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=682.50KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT)
|  |  |
|  |  F31:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=16.68MB mem-reservation=7.75MB thread-reservation=1
|  |  66:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 45(OPEN)
|  |  |
|  |  |--169:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=37 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 45(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=64.28MB mem-reservation=256.00KB thread-reservation=2
|  |  |  45:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=37 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 45(GETNEXT)
|  |  |
|  |  65:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 167(OPEN)
|  |  |
|  |  |--168:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=137.47KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 167(GETNEXT)
|  |  |  |
|  |  |  F39:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=2 instances=2
|  |  |  Per-Host Resources: mem-estimate=10.24MB mem-reservation=1.94MB thread-reservation=1
|  |  |  167:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 167(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  166:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=242.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Host Resources: mem-estimate=78.31MB mem-reservation=12.88MB thread-reservation=2
|  |  |  64:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  runtime filters: RF063[min_max] <- d3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=40B cardinality=719.38K
|  |  |  |  in pipelines: 57(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--165:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=49 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  59:SCAN HDFS [tpcds_parquet.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  60:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=32B cardinality=719.38K
|  |  |  |  in pipelines: 57(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  |--164:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=48 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |  |
|  |  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  |  58:SCAN HDFS [tpcds_parquet.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=48 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  57:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF063[min_max] -> ws_sold_date_sk, RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=64.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=47 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 57(GETNEXT)
|  |  |
|  |  63:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 162(OPEN)
|  |  |
|  |  |--163:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=118.31KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 162(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=3
|  |  |  Per-Host Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  |  162:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 162(GETNEXT), 52(OPEN)
|  |  |  |
|  |  |  161:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  F32:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Host Resources: mem-estimate=110.31MB mem-reservation=12.88MB thread-reservation=2
|  |  |  62:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  runtime filters: RF059[min_max] <- d2.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=40B cardinality=1.44M
|  |  |  |  in pipelines: 52(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--160:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  |  54:SCAN HDFS [tpcds_parquet.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  55:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=32B cardinality=1.44M
|  |  |  |  in pipelines: 52(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  |--159:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=44 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |  |
|  |  |  |  F33:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  |  53:SCAN HDFS [tpcds_parquet.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |     tuple-ids=44 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF059[min_max] -> cs_sold_date_sk, RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |  |     tuple-ids=43 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  158:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 46(OPEN)
|  |  |
|  |  157:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 46(GETNEXT)
|  |  |
|  |  F28:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=30.31MB mem-reservation=9.38MB thread-reservation=2
|  |  51:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 46(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=40B cardinality=2.88M
|  |  |  in pipelines: 46(GETNEXT), 48(OPEN)
|  |  |
|  |  |--156:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  F30:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  48:SCAN HDFS [tpcds_parquet.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  49:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  runtime filters: RF057[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=32B cardinality=2.88M
|  |  |  in pipelines: 46(GETNEXT), 47(OPEN)
|  |  |
|  |  |--155:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=39 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 47(GETNEXT)
|  |  |  |
|  |  |  F29:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  47:SCAN HDFS [tpcds_parquet.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=39 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 47(GETNEXT)
|  |  |
|  |  46:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     runtime filters: RF057[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=38 row-size=12B cardinality=2.88M
|  |     in pipelines: 46(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 43(OPEN)
|  |
|  |--154:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=35 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 43(GETNEXT)
|  |  |
|  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  43:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF037[min_max] -> tpcds_parquet.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=35 row-size=20B cardinality=18.00K
|  |     in pipelines: 43(GETNEXT)
|  |
|  67:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  runtime filters: RF040[bloom] <- d_date_sk, RF041[min_max] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 44(OPEN)
|  |
|  |--153:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=12B cardinality=108
|  |  |  in pipelines: 44(GETNEXT)
|  |  |
|  |  F26:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.06MB mem-reservation=512.00KB thread-reservation=2
|  |  44:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=36 row-size=12B cardinality=108
|  |     in pipelines: 44(GETNEXT)
|  |
|  42:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|     HDFS partitions=1/1 files=3 size=96.62MB
|     runtime filters: RF041[min_max] -> cs_sold_date_sk, RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=96.62MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=650.14K
|     mem-estimate=192.00MB mem-reservation=4.00MB thread-reservation=1
|     tuple-ids=34 row-size=20B cardinality=85.31K(filtered from 1.44M)
|     in pipelines: 42(GETNEXT)
|
41:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=18.00K
|  in pipelines: 146(GETNEXT), 151(OPEN)
|
|--152:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1
|  |  in pipelines: 151(GETNEXT)
|  |
|  F24:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  151:AGGREGATE [FINALIZE]
|  |  output: avg:merge(quantity * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1
|  |  in pipelines: 151(GETNEXT), 40(OPEN)
|  |
|  150:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=3
|  |  in pipelines: 40(GETNEXT)
|  |
|  F23:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=146.02MB mem-reservation=5.94MB thread-reservation=2
|  40:AGGREGATE
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=3
|  |  in pipelines: 40(GETNEXT), 31(OPEN), 34(OPEN), 37(OPEN)
|  |
|  30:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=5.04M
|  |  in pipelines: 31(GETNEXT), 34(GETNEXT), 37(GETNEXT)
|  |
|  |--39:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  runtime filters: RF035[min_max] <- d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=719.38K
|  |  |  in pipelines: 37(GETNEXT), 38(OPEN)
|  |  |
|  |  |--149:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 38(GETNEXT)
|  |  |  |
|  |  |  F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  38:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 38(GETNEXT)
|  |  |
|  |  37:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |     runtime filters: RF035[min_max] -> ws_sold_date_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=45.09MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=26 row-size=12B cardinality=719.38K
|  |     in pipelines: 37(GETNEXT)
|  |
|  |--36:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  runtime filters: RF033[min_max] <- d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=1.44M
|  |  |  in pipelines: 34(GETNEXT), 35(OPEN)
|  |  |
|  |  |--148:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 35(GETNEXT)
|  |  |  |
|  |  |  F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  35:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 35(GETNEXT)
|  |  |
|  |  34:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |     runtime filters: RF033[min_max] -> cs_sold_date_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=96.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |     mem-estimate=144.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=24 row-size=12B cardinality=1.44M
|  |     in pipelines: 34(GETNEXT)
|  |
|  33:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=2.88M
|  |  in pipelines: 31(GETNEXT), 32(OPEN)
|  |
|  |--147:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=8B cardinality=7.30K
|  |  |  in pipelines: 32(GETNEXT)
|  |  |
|  |  F18:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  32:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=23 row-size=8B cardinality=7.30K
|  |     in pipelines: 32(GETNEXT)
|  |
|  31:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=22 row-size=12B cardinality=2.88M
|     in pipelines: 31(GETNEXT)
|
146:AGGREGATE [FINALIZE]
|  output: sum:merge(ss_quantity * ss_list_price), count:merge(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=18.00K
|  in pipelines: 146(GETNEXT), 01(OPEN)
|
145:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  mem-estimate=725.95KB mem-reservation=0B thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=51.71K
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
Per-Host Resources: mem-estimate=67.86MB mem-reservation=12.81MB thread-reservation=2 runtime-filters-memory=3.00MB
29:AGGREGATE [STREAMING]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=51.71K
|  in pipelines: 01(GETNEXT)
|
28:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash predicates: ss_item_sk = i_item_sk
|  runtime filters: RF000[bloom] <- i_item_sk, RF001[min_max] <- i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 132(OPEN)
|
|--144:EXCHANGE [BROADCAST]
|  |  mem-estimate=682.50KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=21.68MB mem-reservation=12.75MB thread-reservation=1 runtime-filters-memory=5.00MB
|  25:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  runtime filters: RF006[bloom] <- i_brand_id, RF007[bloom] <- i_category_id, RF008[bloom] <- i_class_id, RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 04(OPEN)
|  |
|  |--143:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=3 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 04(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=64.28MB mem-reservation=256.00KB thread-reservation=2
|  |  04:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=3 row-size=20B cardinality=18.00K
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  runtime filters: RF012[bloom] <- iws.i_brand_id, RF013[bloom] <- iws.i_category_id
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 141(OPEN)
|  |
|  |--142:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=137.47KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 141(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=10.24MB mem-reservation=1.94MB thread-reservation=1
|  |  141:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 141(GETNEXT), 16(OPEN)
|  |  |
|  |  140:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=242.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=36.00K
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=78.31MB mem-reservation=12.88MB thread-reservation=2
|  |  23:AGGREGATE [STREAMING]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=36.00K
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  runtime filters: RF027[min_max] <- d3.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=40B cardinality=719.38K
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--139:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  18:SCAN HDFS [tpcds_parquet.date_dim d3, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=32B cardinality=719.38K
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--138:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=14 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  17:SCAN HDFS [tpcds_parquet.item iws, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=14 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |     runtime filters: RF027[min_max] -> ws_sold_date_sk, RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=45.09MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |     mem-estimate=64.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=13 row-size=12B cardinality=719.38K
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 136(OPEN)
|  |
|  |--137:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=118.31KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 136(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  136:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 136(GETNEXT), 11(OPEN)
|  |  |
|  |  135:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=110.31MB mem-reservation=12.88MB thread-reservation=2
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  15:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  runtime filters: RF023[min_max] <- d2.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=40B cardinality=1.44M
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--134:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  |  13:SCAN HDFS [tpcds_parquet.date_dim d2, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  runtime filters: RF025[min_max] <- ics.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=32B cardinality=1.44M
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--133:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=64.09MB mem-reservation=256.00KB thread-reservation=2
|  |  |  12:SCAN HDFS [tpcds_parquet.item ics, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |  |     tuple-ids=10 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |     runtime filters: RF023[min_max] -> cs_sold_date_sk, RF025[min_max] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=96.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=9 row-size=12B cardinality=1.44M
|  |     in pipelines: 11(GETNEXT)
|  |
|  132:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 05(OPEN)
|  |
|  131:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=54.00K
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=30.31MB mem-reservation=9.38MB thread-reservation=2
|  10:AGGREGATE [STREAMING]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=54.00K
|  |  in pipelines: 05(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=40B cardinality=2.88M
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--130:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=8B cardinality=7.30K
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.05MB mem-reservation=512.00KB thread-reservation=2
|  |  07:SCAN HDFS [tpcds_parquet.date_dim d1, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=6 row-size=8B cardinality=7.30K
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  runtime filters: RF021[min_max] <- iss.i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5 row-size=32B cardinality=2.88M
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--129:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=69.09MB mem-reservation=5.25MB thread-reservation=2 runtime-filters-memory=5.00MB
|  |  06:SCAN HDFS [tpcds_parquet.item iss, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id, RF006[bloom] -> iss.i_brand_id, RF007[bloom] -> iss.i_category_id, RF008[bloom] -> iss.i_class_id, RF012[bloom] -> iss.i_brand_id, RF013[bloom] -> iss.i_category_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|  |     tuple-ids=5 row-size=20B cardinality=18.00K
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     runtime filters: RF021[min_max] -> ss_item_sk
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=4 row-size=12B cardinality=2.88M
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN, BROADCAST]
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  runtime filters: RF002[bloom] <- i_item_sk, RF003[min_max] <- i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--128:EXCHANGE [BROADCAST]
|  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=20B cardinality=18.00K
|  |  in pipelines: 02(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=65.09MB mem-reservation=1.25MB thread-reservation=2 runtime-filters-memory=1.00MB
|  02:SCAN HDFS [tpcds_parquet.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF001[min_max] -> tpcds_parquet.item.i_item_sk, RF000[bloom] -> tpcds_parquet.item.i_item_sk
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=64.00MB mem-reservation=256.00KB thread-reservation=1
|     tuple-ids=1 row-size=20B cardinality=18.00K
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN, BROADCAST]
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  runtime filters: RF004[bloom] <- d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=32B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--127:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=48.06MB mem-reservation=512.00KB thread-reservation=2
|  03:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=2 row-size=12B cardinality=108
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=200.96MB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk, RF002[bloom] -> ss_item_sk
   stored statistics:
     table: rows=2.88M size=200.96MB
     partitions: 1824/1824 rows=2.88M
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
   mem-estimate=48.00MB mem-reservation=1.00MB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=170.55K(filtered from 2.88M)
   in pipelines: 01(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=431.38MB Threads=135
Per-Host Resource Estimates: Memory=2.03GB
F77:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.03MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
207:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  limit: 100
|  mem-estimate=32.03KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100
|  in pipelines: 126(GETNEXT)
|
F76:PLAN FRAGMENT [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)] hosts=3 instances=6
Per-Instance Resources: mem-estimate=60.00MB mem-reservation=16.31MB thread-reservation=1
126:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100
|  in pipelines: 126(GETNEXT), 125(OPEN)
|
125:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=101.43K
|  in pipelines: 125(GETNEXT), 206(OPEN)
|
206:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=50.00MB mem-reservation=13.44MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=101.43K
|  in pipelines: 206(GETNEXT), 146(OPEN), 172(OPEN), 198(OPEN)
|
205:EXCHANGE [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)]
|  mem-estimate=9.67MB mem-reservation=0B thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=106.81K
|  in pipelines: 146(GETNEXT), 172(GETNEXT), 198(GETNEXT)
|
F75:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
Per-Instance Resources: mem-estimate=66.92MB mem-reservation=13.94MB thread-reservation=1
124:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=50.00MB mem-reservation=12.00MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=106.81K
|  in pipelines: 146(GETNEXT), 172(GETNEXT), 198(GETNEXT)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=54.00K
|  in pipelines: 146(GETNEXT), 172(GETNEXT), 198(GETNEXT)
|
|--123:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=18.00K
|  |  in pipelines: 198(GETNEXT), 203(OPEN)
|  |
|  |--F86:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  |
|  |  204:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1
|  |  |  in pipelines: 203(GETNEXT)
|  |  |
|  |  F74:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  203:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1
|  |  |  in pipelines: 203(GETNEXT), 122(OPEN)
|  |  |
|  |  202:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=3
|  |  |  in pipelines: 122(GETNEXT)
|  |  |
|  |  F73:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  |  Per-Instance Resources: mem-estimate=48.02MB mem-reservation=4.00MB thread-reservation=1
|  |  122:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=3
|  |  |  in pipelines: 122(GETNEXT), 113(OPEN), 116(OPEN), 119(OPEN)
|  |  |
|  |  112:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=5.04M
|  |  |  in pipelines: 113(GETNEXT), 116(GETNEXT), 119(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=719.38K
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--F89:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  runtime filters: RF107[min_max] <- d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  201:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  120:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF107[min_max] -> ws_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  |--118:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=1.44M
|  |  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |  |
|  |  |  |--F88:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  runtime filters: RF105[min_max] <- d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  200:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=93 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |  |
|  |  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  117:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  116:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF105[min_max] -> cs_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 116(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=2.88M
|  |  |  in pipelines: 113(GETNEXT), 114(OPEN)
|  |  |
|  |  |--F87:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=91 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 114(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  114:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=2.88M
|  |     in pipelines: 113(GETNEXT)
|  |
|  198:AGGREGATE [FINALIZE]
|  |  output: sum:merge(ws_quantity * ws_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=18.00K
|  |  in pipelines: 198(GETNEXT), 83(OPEN)
|  |
|  197:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=520.40KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=25.05K
|  |  in pipelines: 83(GETNEXT)
|  |
|  F50:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=42.94MB mem-reservation=6.00MB thread-reservation=1
|  111:AGGREGATE [STREAMING]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=25.05K
|  |  in pipelines: 83(GETNEXT)
|  |
|  110:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=36
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 184(OPEN)
|  |
|  |--F114:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=4.66MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF073[min_max] <- i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  196:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=802.50KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT)
|  |  |
|  |  F56:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  Per-Instance Resources: mem-estimate=10.30MB mem-reservation=1.94MB thread-reservation=1
|  |  107:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=37
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 86(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=37 plan-id=38 cohort-id=11
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  195:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 86(GETNEXT)
|  |  |  |
|  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  |  86:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=71 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 86(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=38
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 193(OPEN)
|  |  |
|  |  |--F116:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  |  Per-Instance Resources: mem-estimate=2.07MB mem-reservation=1.94MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=38 plan-id=39 cohort-id=11
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  194:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=137.47KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 193(GETNEXT)
|  |  |  |
|  |  |  F64:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=10.38MB mem-reservation=1.94MB thread-reservation=1
|  |  |  193:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 193(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  192:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=242.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F61:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=42.12MB mem-reservation=9.00MB thread-reservation=1
|  |  |  105:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=167 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=40B cardinality=719.38K
|  |  |  |  in pipelines: 98(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  |--F117:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=12
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  runtime filters: RF099[min_max] <- d3.d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  191:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=83 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |  |
|  |  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  100:SCAN HDFS [tpcds_parquet.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  101:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=40
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=32B cardinality=719.38K
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--F118:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=12
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  190:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=82 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  F62:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  99:SCAN HDFS [tpcds_parquet.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=82 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF099[min_max] -> ws_sold_date_sk, RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=81 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  104:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=41
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 188(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  |  Per-Instance Resources: mem-estimate=2.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=41 plan-id=42 cohort-id=11
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  189:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=118.31KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 188(GETNEXT)
|  |  |  |
|  |  |  F60:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=10.38MB mem-reservation=1.94MB thread-reservation=1
|  |  |  188:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 188(GETNEXT), 93(OPEN)
|  |  |  |
|  |  |  187:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 93(GETNEXT)
|  |  |  |
|  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=58.19MB mem-reservation=9.00MB thread-reservation=1
|  |  |  103:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=166 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 93(GETNEXT)
|  |  |  |
|  |  |  97:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=42
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=40B cardinality=1.44M
|  |  |  |  in pipelines: 93(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=42 plan-id=43 cohort-id=13
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  runtime filters: RF095[min_max] <- d2.d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  186:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=79 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  95:SCAN HDFS [tpcds_parquet.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  96:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=43
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=32B cardinality=1.44M
|  |  |  |  in pipelines: 93(GETNEXT), 94(OPEN)
|  |  |  |
|  |  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=43 plan-id=44 cohort-id=13
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  185:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=78 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 94(GETNEXT)
|  |  |  |  |
|  |  |  |  F58:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  94:SCAN HDFS [tpcds_parquet.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=78 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 94(GETNEXT)
|  |  |  |
|  |  |  93:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF095[min_max] -> cs_sold_date_sk, RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=77 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 93(GETNEXT)
|  |  |
|  |  184:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 184(GETNEXT), 87(OPEN)
|  |  |
|  |  183:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=306.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F53:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  |  92:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  91:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=44
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=40B cardinality=2.88M
|  |  |  in pipelines: 87(GETNEXT), 89(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=44 plan-id=45 cohort-id=11
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  182:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=74 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 89(GETNEXT)
|  |  |  |
|  |  |  F55:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  89:SCAN HDFS [tpcds_parquet.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 89(GETNEXT)
|  |  |
|  |  90:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=45
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=32B cardinality=2.88M
|  |  |  in pipelines: 87(GETNEXT), 88(OPEN)
|  |  |
|  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=45 plan-id=46 cohort-id=11
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  88:SCAN HDFS [tpcds_parquet.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=73 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  87:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     runtime filters: RF093[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=72 row-size=12B cardinality=2.88M
|  |     in pipelines: 87(GETNEXT)
|  |
|  109:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=46
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 84(OPEN)
|  |
|  |--F124:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=46 plan-id=47 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  180:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=69 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 84(GETNEXT)
|  |  |
|  |  F52:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  84:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF073[min_max] -> tpcds_parquet.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=20B cardinality=18.00K
|  |     in pipelines: 84(GETNEXT)
|  |
|  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=47
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.85K
|  |  in pipelines: 83(GETNEXT), 85(OPEN)
|  |
|  |--F125:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  JOIN BUILD
|  |  |  join-table-id=47 plan-id=48 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF076[bloom] <- d_date_sk, RF077[min_max] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  179:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=70 row-size=12B cardinality=108
|  |  |  in pipelines: 85(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  85:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108
|  |     in pipelines: 85(GETNEXT)
|  |
|  83:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|     HDFS partitions=1/1 files=2 size=45.09MB
|     runtime filters: RF077[min_max] -> ws_sold_date_sk, RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk
|     stored statistics:
|       table: rows=719.38K size=45.09MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=644.77K
|     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=68 row-size=20B cardinality=42.85K(filtered from 719.38K)
|     in pipelines: 83(GETNEXT)
|
|--82:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=18.00K
|  |  in pipelines: 172(GETNEXT), 177(OPEN)
|  |
|  |--F82:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  |
|  |  178:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1
|  |  |  in pipelines: 177(GETNEXT)
|  |  |
|  |  F49:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  177:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1
|  |  |  in pipelines: 177(GETNEXT), 81(OPEN)
|  |  |
|  |  176:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=3
|  |  |  in pipelines: 81(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  |  Per-Instance Resources: mem-estimate=48.02MB mem-reservation=4.00MB thread-reservation=1
|  |  81:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=3
|  |  |  in pipelines: 81(GETNEXT), 72(OPEN), 75(OPEN), 78(OPEN)
|  |  |
|  |  71:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=5.04M
|  |  |  in pipelines: 72(GETNEXT), 75(GETNEXT), 78(GETNEXT)
|  |  |
|  |  |--80:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=719.38K
|  |  |  |  in pipelines: 78(GETNEXT), 79(OPEN)
|  |  |  |
|  |  |  |--F85:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  runtime filters: RF071[min_max] <- d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 79(GETNEXT)
|  |  |  |  |
|  |  |  |  F47:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  79:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 79(GETNEXT)
|  |  |  |
|  |  |  78:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF071[min_max] -> ws_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 78(GETNEXT)
|  |  |
|  |  |--77:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=1.44M
|  |  |  |  in pipelines: 75(GETNEXT), 76(OPEN)
|  |  |  |
|  |  |  |--F84:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  runtime filters: RF069[min_max] <- d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  174:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 76(GETNEXT)
|  |  |  |  |
|  |  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  76:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 76(GETNEXT)
|  |  |  |
|  |  |  75:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF069[min_max] -> cs_sold_date_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=2.88M
|  |  |  in pipelines: 72(GETNEXT), 73(OPEN)
|  |  |
|  |  |--F83:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  173:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 73(GETNEXT)
|  |  |  |
|  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  73:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 73(GETNEXT)
|  |  |
|  |  72:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=2.88M
|  |     in pipelines: 72(GETNEXT)
|  |
|  172:AGGREGATE [FINALIZE]
|  |  output: sum:merge(cs_quantity * cs_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=18.00K
|  |  in pipelines: 172(GETNEXT), 42(OPEN)
|  |
|  171:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=622.45KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=42.88K
|  |  in pipelines: 42(GETNEXT)
|  |
|  F25:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=58.94MB mem-reservation=6.00MB thread-reservation=1
|  70:AGGREGATE [STREAMING]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=42.88K
|  |  in pipelines: 42(GETNEXT)
|  |
|  69:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=24
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 158(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.66MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=24 plan-id=25 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF037[min_max] <- i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  170:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=802.50KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT)
|  |  |
|  |  F31:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  Per-Instance Resources: mem-estimate=10.30MB mem-reservation=1.94MB thread-reservation=1
|  |  66:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=25
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 45(OPEN)
|  |  |
|  |  |--F103:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=08
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  169:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=37 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 45(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  |  45:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=37 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 45(GETNEXT)
|  |  |
|  |  65:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=26
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 167(OPEN)
|  |  |
|  |  |--F104:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  |  Per-Instance Resources: mem-estimate=2.07MB mem-reservation=1.94MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=08
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  168:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=137.47KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 167(GETNEXT)
|  |  |  |
|  |  |  F39:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=10.38MB mem-reservation=1.94MB thread-reservation=1
|  |  |  167:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 167(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  166:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=242.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  Per-Instance Resources: mem-estimate=42.12MB mem-reservation=9.00MB thread-reservation=1
|  |  |  64:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=36.00K
|  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=40B cardinality=719.38K
|  |  |  |  in pipelines: 57(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F105:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=09
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  runtime filters: RF063[min_max] <- d3.d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=49 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  59:SCAN HDFS [tpcds_parquet.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  60:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=32B cardinality=719.38K
|  |  |  |  in pipelines: 57(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=09
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  164:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=48 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |  |
|  |  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  58:SCAN HDFS [tpcds_parquet.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=48 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  57:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |  |     runtime filters: RF063[min_max] -> ws_sold_date_sk, RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=45.09MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |  |     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=47 row-size=12B cardinality=719.38K
|  |  |     in pipelines: 57(GETNEXT)
|  |  |
|  |  63:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=29
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 162(OPEN)
|  |  |
|  |  |--F107:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  |  Per-Instance Resources: mem-estimate=2.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=29 plan-id=30 cohort-id=08
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  163:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=118.31KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 162(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=10.38MB mem-reservation=1.94MB thread-reservation=1
|  |  |  162:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=18.00K
|  |  |  |  in pipelines: 162(GETNEXT), 52(OPEN)
|  |  |  |
|  |  |  161:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  F32:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=58.19MB mem-reservation=9.00MB thread-reservation=1
|  |  |  62:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=145 row-size=12B cardinality=54.00K
|  |  |  |  in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=30
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=40B cardinality=1.44M
|  |  |  |  in pipelines: 52(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=10
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  runtime filters: RF059[min_max] <- d2.d_date_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  160:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  54:SCAN HDFS [tpcds_parquet.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  55:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=31
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=32B cardinality=1.44M
|  |  |  |  in pipelines: 52(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  |--F109:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=31 plan-id=32 cohort-id=10
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |
|  |  |  |  159:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=44 row-size=20B cardinality=18.00K
|  |  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |  |
|  |  |  |  F33:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  53:SCAN HDFS [tpcds_parquet.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=44 row-size=20B cardinality=18.00K
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |  |     runtime filters: RF059[min_max] -> cs_sold_date_sk, RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=96.62MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |  |     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=43 row-size=12B cardinality=1.44M
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  158:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 158(GETNEXT), 46(OPEN)
|  |  |
|  |  157:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=306.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 46(GETNEXT)
|  |  |
|  |  F28:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  |  51:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 46(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=40B cardinality=2.88M
|  |  |  in pipelines: 46(GETNEXT), 48(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=08
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  156:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  F30:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  48:SCAN HDFS [tpcds_parquet.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  49:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=32B cardinality=2.88M
|  |  |  in pipelines: 46(GETNEXT), 47(OPEN)
|  |  |
|  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=08
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  155:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=39 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 47(GETNEXT)
|  |  |  |
|  |  |  F29:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  47:SCAN HDFS [tpcds_parquet.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=39 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 47(GETNEXT)
|  |  |
|  |  46:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=200.96MB
|  |     runtime filters: RF057[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=200.96MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=2.88M
|  |     in pipelines: 46(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=34
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 43(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=34 plan-id=35 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  154:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=35 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 43(GETNEXT)
|  |  |
|  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  43:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF037[min_max] -> tpcds_parquet.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=20B cardinality=18.00K
|  |     in pipelines: 43(GETNEXT)
|  |
|  67:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=35
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.31K
|  |  in pipelines: 42(GETNEXT), 44(OPEN)
|  |
|  |--F113:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  JOIN BUILD
|  |  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF040[bloom] <- d_date_sk, RF041[min_max] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  153:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=12B cardinality=108
|  |  |  in pipelines: 44(GETNEXT)
|  |  |
|  |  F26:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  44:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108
|  |     in pipelines: 44(GETNEXT)
|  |
|  42:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|     HDFS partitions=1/1 files=3 size=96.62MB
|     runtime filters: RF041[min_max] -> cs_sold_date_sk, RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=96.62MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=650.14K
|     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=34 row-size=20B cardinality=85.31K(filtered from 1.44M)
|     in pipelines: 42(GETNEXT)
|
41:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=18.00K
|  in pipelines: 146(GETNEXT), 151(OPEN)
|
|--F78:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |
|  152:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1
|  |  in pipelines: 151(GETNEXT)
|  |
|  F24:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  151:AGGREGATE [FINALIZE]
|  |  output: avg:merge(quantity * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1
|  |  in pipelines: 151(GETNEXT), 40(OPEN)
|  |
|  150:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=3
|  |  in pipelines: 40(GETNEXT)
|  |
|  F23:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  Per-Instance Resources: mem-estimate=48.02MB mem-reservation=4.00MB thread-reservation=1
|  40:AGGREGATE
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=3
|  |  in pipelines: 40(GETNEXT), 31(OPEN), 34(OPEN), 37(OPEN)
|  |
|  30:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=5.04M
|  |  in pipelines: 31(GETNEXT), 34(GETNEXT), 37(GETNEXT)
|  |
|  |--39:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=719.38K
|  |  |  in pipelines: 37(GETNEXT), 38(OPEN)
|  |  |
|  |  |--F81:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  runtime filters: RF035[min_max] <- d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 38(GETNEXT)
|  |  |  |
|  |  |  F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  38:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 38(GETNEXT)
|  |  |
|  |  37:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |     runtime filters: RF035[min_max] -> ws_sold_date_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=45.09MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=719.38K
|  |     in pipelines: 37(GETNEXT)
|  |
|  |--36:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=1.44M
|  |  |  in pipelines: 34(GETNEXT), 35(OPEN)
|  |  |
|  |  |--F80:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  runtime filters: RF033[min_max] <- d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  148:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 35(GETNEXT)
|  |  |  |
|  |  |  F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  35:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 35(GETNEXT)
|  |  |
|  |  34:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |     runtime filters: RF033[min_max] -> cs_sold_date_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=96.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=1.44M
|  |     in pipelines: 34(GETNEXT)
|  |
|  33:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=2.88M
|  |  in pipelines: 31(GETNEXT), 32(OPEN)
|  |
|  |--F79:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  147:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=8B cardinality=7.30K
|  |  |  in pipelines: 32(GETNEXT)
|  |  |
|  |  F18:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  32:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K
|  |     in pipelines: 32(GETNEXT)
|  |
|  31:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=2.88M
|     in pipelines: 31(GETNEXT)
|
146:AGGREGATE [FINALIZE]
|  output: sum:merge(ss_quantity * ss_list_price), count:merge(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=18.00K
|  in pipelines: 146(GETNEXT), 01(OPEN)
|
145:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  mem-estimate=845.95KB mem-reservation=0B thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=51.71K
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
Per-Instance Resources: mem-estimate=26.94MB mem-reservation=3.00MB thread-reservation=1
29:AGGREGATE [STREAMING]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=51.71K
|  in pipelines: 01(GETNEXT)
|
28:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: ss_item_sk = i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 132(OPEN)
|
|--F90:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=5.66MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: i_item_sk
|  |  runtime filters: RF000[bloom] <- i_item_sk, RF001[min_max] <- i_item_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |
|  144:EXCHANGE [BROADCAST]
|  |  mem-estimate=802.50KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  Per-Instance Resources: mem-estimate=10.30MB mem-reservation=1.94MB thread-reservation=1
|  25:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 04(OPEN)
|  |
|  |--F91:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  Per-Instance Resources: mem-estimate=5.30MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  runtime filters: RF006[bloom] <- i_brand_id, RF007[bloom] <- i_category_id, RF008[bloom] <- i_class_id, RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  143:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=3 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 04(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  04:SCAN HDFS [tpcds_parquet.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=3 row-size=20B cardinality=18.00K
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 141(OPEN)
|  |
|  |--F92:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  Per-Instance Resources: mem-estimate=4.07MB mem-reservation=3.94MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  runtime filters: RF012[bloom] <- iws.i_brand_id, RF013[bloom] <- iws.i_category_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  142:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=137.47KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 141(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=2 instances=2
|  |  Per-Instance Resources: mem-estimate=10.38MB mem-reservation=1.94MB thread-reservation=1
|  |  141:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 141(GETNEXT), 16(OPEN)
|  |  |
|  |  140:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=242.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=36.00K
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Instance Resources: mem-estimate=42.12MB mem-reservation=9.00MB thread-reservation=1
|  |  23:AGGREGATE [STREAMING]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=36.00K
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=15
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=40B cardinality=719.38K
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F93:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=15 plan-id=16 cohort-id=06
|  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  runtime filters: RF027[min_max] <- d3.d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  139:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  18:SCAN HDFS [tpcds_parquet.date_dim d3, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=32B cardinality=719.38K
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F94:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=06
|  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  138:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=14 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  17:SCAN HDFS [tpcds_parquet.item iws, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=14 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_parquet.web_sales, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=45.09MB
|  |     runtime filters: RF027[min_max] -> ws_sold_date_sk, RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=45.09MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=644.77K
|  |     mem-estimate=32.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=13 row-size=12B cardinality=719.38K
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=17
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 136(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6
|  |  |  Per-Instance Resources: mem-estimate=2.05MB mem-reservation=1.94MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  137:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=118.31KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 136(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=10.38MB mem-reservation=1.94MB thread-reservation=1
|  |  136:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=18.00K
|  |  |  in pipelines: 136(GETNEXT), 11(OPEN)
|  |  |
|  |  135:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=258.94KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=58.19MB mem-reservation=9.00MB thread-reservation=1
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=54.00K
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  15:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=40B cardinality=1.44M
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=07
|  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  runtime filters: RF023[min_max] <- d2.d_date_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  134:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  13:SCAN HDFS [tpcds_parquet.date_dim d2, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=32B cardinality=1.44M
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=07
|  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  runtime filters: RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |
|  |  |  133:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=20B cardinality=18.00K
|  |  |  |  in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  12:SCAN HDFS [tpcds_parquet.item ics, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=20B cardinality=18.00K
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_parquet.catalog_sales, RANDOM]
|  |     HDFS partitions=1/1 files=3 size=96.62MB
|  |     runtime filters: RF023[min_max] -> cs_sold_date_sk, RF025[min_max] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=96.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=650.14K
|  |     mem-estimate=48.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=1.44M
|  |     in pipelines: 11(GETNEXT)
|  |
|  132:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=18.00K
|  |  in pipelines: 132(GETNEXT), 05(OPEN)
|  |
|  131:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  mem-estimate=306.94KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=54.00K
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  10:AGGREGATE [STREAMING]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=54.00K
|  |  in pipelines: 05(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=20
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=40B cardinality=2.88M
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=3.94MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  build expressions: d1.d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  130:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=8B cardinality=7.30K
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  07:SCAN HDFS [tpcds_parquet.date_dim d1, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=7.30K
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=21
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5 row-size=32B cardinality=2.88M
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--F99:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=21 plan-id=22 cohort-id=05
|  |  |  build expressions: iss.i_item_sk
|  |  |  runtime filters: RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  129:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=20B cardinality=18.00K
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Shared Resources: mem-estimate=5.00MB mem-reservation=5.00MB thread-reservation=0 runtime-filters-memory=5.00MB
|  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  06:SCAN HDFS [tpcds_parquet.item iss, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id, RF006[bloom] -> iss.i_brand_id, RF007[bloom] -> iss.i_category_id, RF008[bloom] -> iss.i_class_id, RF012[bloom] -> iss.i_brand_id, RF013[bloom] -> iss.i_category_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=5 row-size=20B cardinality=18.00K
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     runtime filters: RF021[min_max] -> ss_item_sk
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=12B cardinality=2.88M
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=22
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--F100:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=5.24MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  JOIN BUILD
|  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  build expressions: i_item_sk
|  |  runtime filters: RF002[bloom] <- i_item_sk, RF003[min_max] <- i_item_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |
|  128:EXCHANGE [BROADCAST]
|  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=20B cardinality=18.00K
|  |  in pipelines: 02(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  02:SCAN HDFS [tpcds_parquet.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF001[min_max] -> tpcds_parquet.item.i_item_sk, RF000[bloom] -> tpcds_parquet.item.i_item_sk
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|     tuple-ids=1 row-size=20B cardinality=18.00K
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=23
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=32B cardinality=170.55K
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--F101:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  JOIN BUILD
|  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  build expressions: d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |
|  127:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  03:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_parquet.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=200.96MB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk, RF002[bloom] -> ss_item_sk
   stored statistics:
     table: rows=2.88M size=200.96MB
     partitions: 1824/1824 rows=2.88M
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=170.55K(filtered from 2.88M)
   in pipelines: 01(GETNEXT)
====
