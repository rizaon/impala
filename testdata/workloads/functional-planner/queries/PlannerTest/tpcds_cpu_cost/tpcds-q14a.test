# TPCDS-Q14a first of two
# start query 14 in stream 0 using template query14.tpl using seed 521152908
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1998 AND 1998 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1998 AND 1998 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1998 AND 1998 + 2) x
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2) x)
  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
 limit 100;
---- PLAN
Max Per-Host Resource Reservation: Memory=249.88MB Threads=1
Per-Host Resource Estimates: Memory=550MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=550.22MB mem-reservation=249.88MB thread-reservation=1 runtime-filters-memory=10.00MB
|  max-parallelism=1 segment-costs=[20422279899, 10211969877, 5106386099, 28976894, 1528934128, 11061232872, 20422279899, 10211969877, 5106386099, 28976894, 762314301, 11061232872, 20422279899, 10211969877, 5106386099, 28976894, 383352035, 11061232872, 5642527, 2955815, 5278200, 600]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
129:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=5278200
|  in pipelines: 129(GETNEXT), 128(OPEN)
|
128:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=494.90K cost=2955815
|  in pipelines: 128(GETNEXT), 127(OPEN)
|
127:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=154.51MB mem-reservation=56.81MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=5471298
|  in pipelines: 127(GETNEXT), 30(OPEN), 72(OPEN), 114(OPEN)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=447.36K cost=79567
|  in pipelines: 30(GETNEXT), 72(GETNEXT), 114(GETNEXT)
|
|--126:NESTED LOOP JOIN [INNER JOIN]
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 114(GETNEXT), 125(OPEN)
|  |
|  |--125:AGGREGATE [FINALIZE]
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 125(GETNEXT), 116(OPEN), 119(OPEN), 122(OPEN)
|  |  |
|  |  115:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=15.12G cost=772026236
|  |  |  in pipelines: 116(GETNEXT), 119(GETNEXT), 122(GETNEXT)
|  |  |
|  |  |--124:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 122(GETNEXT), 123(OPEN)
|  |  |  |
|  |  |  |--123:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 123(GETNEXT)
|  |  |  |
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |
|  |  |--117:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  116:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 116(GETNEXT)
|  |
|  114:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=185180789
|  |  in pipelines: 114(GETNEXT), 85(OPEN)
|  |
|  113:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: ws_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF072[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF073[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=44B cardinality=127.77M cost=56299145
|  |  in pipelines: 85(GETNEXT), 112(OPEN)
|  |
|  |--112:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=17786592
|  |  |  in pipelines: 112(GETNEXT), 88(OPEN)
|  |  |
|  |  109:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  |  fk/pk conjuncts: none
|  |  |  runtime filters: RF081[min_max] <- iss.i_brand_id, RF082[min_max] <- iss.i_category_id, RF083[min_max] <- iss.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=71,75 row-size=28B cardinality=57.60M cost=10678580
|  |  |  in pipelines: 88(GETNEXT), 94(OPEN)
|  |  |
|  |  |--108:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=214389
|  |  |  |  in pipelines: 94(GETNEXT), 107(OPEN)
|  |  |  |
|  |  |  |--107:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  |  |  in pipelines: 107(GETNEXT), 100(OPEN)
|  |  |  |  |
|  |  |  |  104:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=81,82,83 row-size=32B cardinality=2.16G cost=944952811
|  |  |  |  |  in pipelines: 100(GETNEXT), 102(OPEN)
|  |  |  |  |
|  |  |  |  |--102:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |  |
|  |  |  |  103:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=81,82 row-size=24B cardinality=2.16G cost=945305506
|  |  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |  |
|  |  |  |  |--101:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=82 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |  |     runtime filters: RF101[min_max] -> ws_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=2.16G size=145.75GB
|  |  |  |       partitions: 1824/1824 rows=2.16G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |  |     tuple-ids=81 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |  |     in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  106:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=214389
|  |  |  |  in pipelines: 94(GETNEXT), 105(OPEN)
|  |  |  |
|  |  |  |--105:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 105(GETNEXT), 95(OPEN)
|  |  |  |  |
|  |  |  |  99:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=77,78,79 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  |  in pipelines: 95(GETNEXT), 97(OPEN)
|  |  |  |  |
|  |  |  |  |--97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |  |
|  |  |  |  98:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=77,78 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |  |  |
|  |  |  |  |--96:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=78 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 96(GETNEXT)
|  |  |  |  |
|  |  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF097[min_max] -> cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=77 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  94:AGGREGATE [FINALIZE]
|  |  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 94(GETNEXT), 89(OPEN)
|  |  |  |
|  |  |  93:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=72,73,74 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  |  in pipelines: 89(GETNEXT), 91(OPEN)
|  |  |  |
|  |  |  |--91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=74 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 91(GETNEXT)
|  |  |  |
|  |  |  92:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  |  runtime filters: RF092[bloom] <- iss.i_item_sk, RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=72,73 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |  |
|  |  |  |--90:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=73 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF093[min_max] -> ss_item_sk, RF092[bloom] -> ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=72 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 89(GETNEXT)
|  |  |
|  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF081[min_max] -> i_brand_id, RF082[min_max] -> i_category_id, RF083[min_max] -> i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=71 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 88(GETNEXT)
|  |
|  111:HASH JOIN [INNER JOIN]
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=44B cardinality=127.83M cost=56327115
|  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |
|  |--86:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF072[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 86(GETNEXT)
|  |
|  110:HASH JOIN [INNER JOIN]
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  runtime filters: RF076[bloom] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=28B cardinality=127.89M cost=55978804
|  |  in pipelines: 85(GETNEXT), 87(OPEN)
|  |
|  |--87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 87(GETNEXT)
|  |
|  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk, RF072[bloom] -> ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=68 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 85(GETNEXT)
|
|--84:NESTED LOOP JOIN [INNER JOIN]
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 72(GETNEXT), 83(OPEN)
|  |
|  |--83:AGGREGATE [FINALIZE]
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 83(GETNEXT), 74(OPEN), 77(OPEN), 80(OPEN)
|  |  |
|  |  73:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=15.12G cost=772026236
|  |  |  in pipelines: 74(GETNEXT), 77(GETNEXT), 80(GETNEXT)
|  |  |
|  |  |--82:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |  |
|  |  |  |--81:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  |--79:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 77(GETNEXT), 78(OPEN)
|  |  |  |
|  |  |  |--78:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 78(GETNEXT)
|  |  |  |
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 74(GETNEXT)
|  |
|  72:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=368287628
|  |  in pipelines: 72(GETNEXT), 43(OPEN)
|  |
|  71:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF036[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF037[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=44B cardinality=254.56M cost=111814239
|  |  in pipelines: 43(GETNEXT), 70(OPEN)
|  |
|  |--70:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=17786592
|  |  |  in pipelines: 70(GETNEXT), 46(OPEN)
|  |  |
|  |  67:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  |  fk/pk conjuncts: none
|  |  |  runtime filters: RF045[min_max] <- iss.i_brand_id, RF046[min_max] <- iss.i_category_id, RF047[min_max] <- iss.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=37,41 row-size=28B cardinality=57.60M cost=10678580
|  |  |  in pipelines: 46(GETNEXT), 52(OPEN)
|  |  |
|  |  |--66:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=214389
|  |  |  |  in pipelines: 52(GETNEXT), 65(OPEN)
|  |  |  |
|  |  |  |--65:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  |  |  in pipelines: 65(GETNEXT), 58(OPEN)
|  |  |  |  |
|  |  |  |  62:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=47,48,49 row-size=32B cardinality=2.16G cost=944952811
|  |  |  |  |  in pipelines: 58(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  |--60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  61:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=47,48 row-size=24B cardinality=2.16G cost=945305506
|  |  |  |  |  in pipelines: 58(GETNEXT), 59(OPEN)
|  |  |  |  |
|  |  |  |  |--59:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=48 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |  |     runtime filters: RF065[min_max] -> ws_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=2.16G size=145.75GB
|  |  |  |       partitions: 1824/1824 rows=2.16G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |  |     tuple-ids=47 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |  |     in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  64:HASH JOIN [LEFT SEMI JOIN]
|  |  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=214389
|  |  |  |  in pipelines: 52(GETNEXT), 63(OPEN)
|  |  |  |
|  |  |  |--63:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 63(GETNEXT), 53(OPEN)
|  |  |  |  |
|  |  |  |  57:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=43,44,45 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  |  in pipelines: 53(GETNEXT), 55(OPEN)
|  |  |  |  |
|  |  |  |  |--55:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  56:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=43,44 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |  |
|  |  |  |  |--54:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=44 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF061[min_max] -> cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=43 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:AGGREGATE [FINALIZE]
|  |  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 52(GETNEXT), 47(OPEN)
|  |  |  |
|  |  |  51:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=38,39,40 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  |  in pipelines: 47(GETNEXT), 49(OPEN)
|  |  |  |
|  |  |  |--49:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 49(GETNEXT)
|  |  |  |
|  |  |  50:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  |  runtime filters: RF056[bloom] <- iss.i_item_sk, RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=38,39 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |  |  |
|  |  |  |--48:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=39 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF057[min_max] -> ss_item_sk, RF056[bloom] -> ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=38 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 47(GETNEXT)
|  |  |
|  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF045[min_max] -> i_brand_id, RF046[min_max] -> i_category_id, RF047[min_max] -> i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=37 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 46(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=44B cardinality=254.69M cost=111869966
|  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |
|  |--44:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF037[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF036[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 44(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  runtime filters: RF040[bloom] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=28B cardinality=254.82M cost=111533149
|  |  in pipelines: 43(GETNEXT), 45(OPEN)
|  |
|  |--45:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 45(GETNEXT)
|  |
|  43:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk, RF036[bloom] -> cs_item_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=34 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 43(GETNEXT)
|
42:NESTED LOOP JOIN [INNER JOIN]
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 30(GETNEXT), 41(OPEN)
|
|--41:AGGREGATE [FINALIZE]
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 41(GETNEXT), 32(OPEN), 35(OPEN), 38(OPEN)
|  |
|  31:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=15.12G cost=772026236
|  |  in pipelines: 32(GETNEXT), 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=2.16G cost=945425284
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 38(GETNEXT)
|  |
|  |--37:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 35(GETNEXT)
|  |
|  34:HASH JOIN [INNER JOIN]
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=8.64G cost=3781706938
|  |  in pipelines: 32(GETNEXT), 33(OPEN)
|  |
|  |--33:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 33(GETNEXT)
|  |
|  32:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 32(GETNEXT)
|
30:AGGREGATE [FINALIZE]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=738702696
|  in pipelines: 30(GETNEXT), 01(OPEN)
|
29:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,1 row-size=44B cardinality=511.06M cost=224118221
|  in pipelines: 01(GETNEXT), 28(OPEN)
|
|--28:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=17786592
|  |  in pipelines: 28(GETNEXT), 04(OPEN)
|  |
|  25:HASH JOIN [INNER JOIN]
|  |  hash predicates: i_brand_id = iss.i_brand_id, i_category_id = iss.i_category_id, i_class_id = iss.i_class_id
|  |  fk/pk conjuncts: none
|  |  runtime filters: RF009[min_max] <- iss.i_brand_id, RF010[min_max] <- iss.i_category_id, RF011[min_max] <- iss.i_class_id
|  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=3,7 row-size=28B cardinality=57.60M cost=10678580
|  |  in pipelines: 04(GETNEXT), 10(OPEN)
|  |
|  |--24:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=214389
|  |  |  in pipelines: 10(GETNEXT), 23(OPEN)
|  |  |
|  |  |--23:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  |  in pipelines: 23(GETNEXT), 16(OPEN)
|  |  |  |
|  |  |  20:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,14,15 row-size=32B cardinality=2.16G cost=944952811
|  |  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |  |
|  |  |  |--18:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  19:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=13,14 row-size=24B cardinality=2.16G cost=945305506
|  |  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--17:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=14 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF029[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=13 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  22:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=214389
|  |  |  in pipelines: 10(GETNEXT), 21(OPEN)
|  |  |
|  |  |--21:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  in pipelines: 21(GETNEXT), 11(OPEN)
|  |  |  |
|  |  |  15:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=9,10,11 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |  |
|  |  |  |--13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  14:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  runtime filters: RF024[bloom] <- ics.i_item_sk, RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=9,10 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |  |
|  |  |  |--12:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF025[min_max] -> cs_item_sk, RF024[bloom] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=9 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  in pipelines: 10(GETNEXT), 05(OPEN)
|  |  |
|  |  09:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=4,5,6 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |  |
|  |  |--07:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 07(GETNEXT)
|  |  |
|  |  08:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  runtime filters: RF020[bloom] <- iss.i_item_sk, RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=4,5 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |  |
|  |  |--06:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=5 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 06(GETNEXT)
|  |  |
|  |  05:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF021[min_max] -> ss_item_sk, RF020[bloom] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=4 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF009[min_max] -> i_brand_id, RF010[min_max] -> i_category_id, RF011[min_max] -> i_class_id
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=3 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 04(GETNEXT)
|
27:HASH JOIN [INNER JOIN]
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  runtime filters: RF003[min_max] <- i_item_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,1 row-size=44B cardinality=511.32M cost=224230100
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--02:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=1 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN]
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  runtime filters: RF004[bloom] <- d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916534
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 01(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=6.91GB Threads=293
Per-Host Resource Estimates: Memory=11.58GB
F80:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1587 [max(1 (self) vs 1587 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
216:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=34
|  in pipelines: 129(GETNEXT)
|
F79:PLAN FRAGMENT [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=94.68MB mem-reservation=30.44MB thread-reservation=1
max-parallelism=10 segment-costs=[3630009, 2955815, 5278200, 157] cpu-comparison-result=1587 [max(10 (self) vs 1587 (sum children))]
129:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=5278200
|  in pipelines: 129(GETNEXT), 128(OPEN)
|
128:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=494.90K cost=2955815
|  in pipelines: 128(GETNEXT), 215(OPEN)
|
215:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=57.00MB mem-reservation=25.69MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=2955813
|  in pipelines: 215(GETNEXT), 151(OPEN), 179(OPEN), 207(OPEN)
|
214:EXCHANGE [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)]
|  mem-estimate=37.68MB mem-reservation=0B thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=674196
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
F78:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Instance Resources: mem-estimate=74.93MB mem-reservation=11.94MB thread-reservation=1
max-parallelism=109 segment-costs=[931895, 931895, 931895, 8945360, 8923964] cpu-comparison-result=1587 [max(109 (self) vs 1587 (sum children))]
127:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=50.00MB mem-reservation=10.00MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=8774131
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=447.36K cost=79567
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
|--126:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 207(GETNEXT), 212(OPEN)
|  |
|  |--F89:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  213:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 212(GETNEXT)
|  |  |
|  |  F77:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  212:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 212(GETNEXT), 125(OPEN)
|  |  |
|  |  211:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 125(GETNEXT)
|  |  |
|  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 1] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  125:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 125(GETNEXT), 116(OPEN), 119(OPEN), 122(OPEN)
|  |  |
|  |  115:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=15.12G cost=772026236
|  |  |  in pipelines: 116(GETNEXT), 119(GETNEXT), 122(GETNEXT)
|  |  |
|  |  |--124:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 122(GETNEXT), 123(OPEN)
|  |  |  |
|  |  |  |--F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 123(GETNEXT)
|  |  |  |  |
|  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 123(GETNEXT)
|  |  |  |
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--F91:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=93 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |  |
|  |  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |
|  |  |--F90:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  208:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=91 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  116:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 116(GETNEXT)
|  |
|  207:AGGREGATE [FINALIZE]
|  |  output: sum:merge(ws_quantity * ws_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=890634
|  |  in pipelines: 207(GETNEXT), 85(OPEN)
|  |
|  206:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=2.47MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=41261
|  |  in pipelines: 85(GETNEXT)
|  |
|  F52:PLAN FRAGMENT [RANDOM] hosts=10 instances=50 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=50 segment-costs=[462891756, 422546] cpu-comparison-result=409 [max(50 (self) vs 409 (sum children))]
|  114:AGGREGATE [STREAMING]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=265540290
|  |  in pipelines: 85(GETNEXT)
|  |
|  113:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=36
|  |  hash predicates: ws_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=44B cardinality=127.77M cost=55939145
|  |  in pipelines: 85(GETNEXT), 204(OPEN)
|  |
|  |--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=87.45MB mem-reservation=86.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF072[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF073[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=85.00MB mem-reservation=85.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  205:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 204(GETNEXT)
|  |  |
|  |  F68:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.29MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1086444, 11664] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  204:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=1039824
|  |  |  in pipelines: 204(GETNEXT), 191(OPEN)
|  |  |
|  |  203:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=300.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=46620
|  |  |  in pipelines: 191(GETNEXT)
|  |  |
|  |  F58:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=22.05MB mem-reservation=10.94MB thread-reservation=1
|  |  max-parallelism=20 segment-costs=[904993, 110395717, 278208] cpu-comparison-result=384 [max(20 (self) vs 384 (sum children))]
|  |  112:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=99789810
|  |  |  in pipelines: 191(GETNEXT)
|  |  |
|  |  109:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=37
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: none
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=28B cardinality=57.60M cost=10475369
|  |  |  in pipelines: 191(GETNEXT), 88(OPEN)
|  |  |
|  |  |--F118:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=4.33MB mem-reservation=2.88MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[426492]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=37 plan-id=38 cohort-id=11
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  202:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=16B cardinality=360.00K cost=66492
|  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.56MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[639360]
|  |  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=71 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  108:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=38
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 191(GETNEXT), 200(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=38 plan-id=39 cohort-id=11
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  201:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 200(GETNEXT)
|  |  |  |
|  |  |  F66:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  200:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 200(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  199:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=520 segment-costs=[5186282830, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  107:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=3047563509
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=32B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 100(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=12
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  198:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=83 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |  |
|  |  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  103:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=40
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=24B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=12
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  197:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=82 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F64:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=82 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=81 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=41
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 191(GETNEXT), 195(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=41 plan-id=42 cohort-id=11
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  196:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 195(GETNEXT)
|  |  |  |
|  |  |  F62:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  195:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 195(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  194:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  105:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=6014287315
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=42
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 95(GETNEXT), 97(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=42 plan-id=43 cohort-id=13
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  193:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=79 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 97(GETNEXT)
|  |  |  |  |
|  |  |  |  F61:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  98:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=43
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=43 plan-id=44 cohort-id=13
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  192:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=78 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 96(GETNEXT)
|  |  |  |  |
|  |  |  |  F60:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=78 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=77 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  191:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 191(GETNEXT), 89(OPEN)
|  |  |
|  |  190:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  F55:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=27.25MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  94:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=11947236639
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  93:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=44
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 89(GETNEXT), 91(OPEN)
|  |  |
|  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=44 plan-id=45 cohort-id=11
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=74 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 91(GETNEXT)
|  |  |  |
|  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 91(GETNEXT)
|  |  |
|  |  92:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=45
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |
|  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=45 plan-id=46 cohort-id=11
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF092[bloom] <- iss.i_item_sk, RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  188:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=73 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 90(GETNEXT)
|  |  |
|  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF093[min_max] -> ss_item_sk, RF092[bloom] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=72 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 89(GETNEXT)
|  |
|  111:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=46
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=44B cardinality=127.83M cost=55967115
|  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |
|  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=175.57MB mem-reservation=170.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=46 plan-id=47 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  |  mem-estimate=170.00MB mem-reservation=170.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  187:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=69 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 86(GETNEXT)
|  |  |
|  |  F54:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF072[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 86(GETNEXT)
|  |
|  110:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=47
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 85(GETNEXT), 87(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=10.70MB mem-reservation=10.69MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=47 plan-id=48 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF076[bloom] <- d_date_sk
|  |  |  mem-estimate=9.69MB mem-reservation=9.69MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  186:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=70 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F53:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 87(GETNEXT)
|  |
|  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk, RF072[bloom] -> ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=68 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 85(GETNEXT)
|
|--84:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 179(GETNEXT), 184(OPEN)
|  |
|  |--F85:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  185:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 184(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  184:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 184(GETNEXT), 83(OPEN)
|  |  |
|  |  183:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 83(GETNEXT)
|  |  |
|  |  F50:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 1] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  83:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 83(GETNEXT), 74(OPEN), 77(OPEN), 80(OPEN)
|  |  |
|  |  73:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=15.12G cost=772026236
|  |  |  in pipelines: 74(GETNEXT), 77(GETNEXT), 80(GETNEXT)
|  |  |
|  |  |--82:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |  |
|  |  |  |--F88:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  182:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 81(GETNEXT)
|  |  |  |  |
|  |  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  |--79:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 77(GETNEXT), 78(OPEN)
|  |  |  |
|  |  |  |--F87:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 78(GETNEXT)
|  |  |  |  |
|  |  |  |  F47:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  78:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 78(GETNEXT)
|  |  |  |
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--F86:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 75(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 74(GETNEXT)
|  |
|  179:AGGREGATE [FINALIZE]
|  |  output: sum:merge(cs_quantity * cs_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=890634
|  |  in pipelines: 179(GETNEXT), 43(OPEN)
|  |
|  178:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=4.03MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=41261
|  |  in pipelines: 43(GETNEXT)
|  |
|  F26:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=90 segment-costs=[841854022, 422546] cpu-comparison-result=409 [max(90 (self) vs 409 (sum children))]
|  72:AGGREGATE [STREAMING]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=448647129
|  |  in pipelines: 43(GETNEXT)
|  |
|  71:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=24
|  |  hash predicates: cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=44B cardinality=254.56M cost=111454239
|  |  in pipelines: 43(GETNEXT), 176(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=155.45MB mem-reservation=154.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=24 plan-id=25 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF036[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF037[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=153.00MB mem-reservation=153.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  177:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 176(GETNEXT)
|  |  |
|  |  F42:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.29MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1086444, 11664] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  176:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=1039824
|  |  |  in pipelines: 176(GETNEXT), 163(OPEN)
|  |  |
|  |  175:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=300.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=46620
|  |  |  in pipelines: 163(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=22.05MB mem-reservation=10.94MB thread-reservation=1
|  |  max-parallelism=20 segment-costs=[904993, 110395717, 278208] cpu-comparison-result=384 [max(20 (self) vs 384 (sum children))]
|  |  70:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=99789810
|  |  |  in pipelines: 163(GETNEXT)
|  |  |
|  |  67:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=25
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: none
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=28B cardinality=57.60M cost=10475369
|  |  |  in pipelines: 163(GETNEXT), 46(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=4.33MB mem-reservation=2.88MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[426492]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=08
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  174:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=37 row-size=16B cardinality=360.00K cost=66492
|  |  |  |  in pipelines: 46(GETNEXT)
|  |  |  |
|  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.56MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[639360]
|  |  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=37 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 46(GETNEXT)
|  |  |
|  |  66:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=26
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 163(GETNEXT), 172(OPEN)
|  |  |
|  |  |--F107:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=08
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  173:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 172(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  172:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 172(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  171:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=520 segment-costs=[5186282830, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=3047563509
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  62:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=32B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 58(GETNEXT), 60(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=09
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  170:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=49 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=24B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 58(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=09
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  169:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=48 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=48 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=47 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  64:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=29
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 163(GETNEXT), 167(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=29 plan-id=30 cohort-id=08
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  168:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 167(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  167:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 167(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  166:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  63:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=6014287315
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=30
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 53(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=10
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=31
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=31 plan-id=32 cohort-id=10
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  164:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=44 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=44 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=43 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  163:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 163(GETNEXT), 47(OPEN)
|  |  |
|  |  162:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=27.25MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  52:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=11947236639
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 47(GETNEXT), 49(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=08
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  161:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 49(GETNEXT)
|  |  |  |
|  |  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 49(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=08
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF056[bloom] <- iss.i_item_sk, RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  160:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=39 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  F30:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=39 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF057[min_max] -> ss_item_sk, RF056[bloom] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 47(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=34
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=44B cardinality=254.69M cost=111509966
|  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |
|  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=311.57MB mem-reservation=306.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=34 plan-id=35 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  |  mem-estimate=306.00MB mem-reservation=306.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=35 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 44(GETNEXT)
|  |  |
|  |  F28:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  44:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF037[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF036[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 44(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=35
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 43(GETNEXT), 45(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=18.45MB mem-reservation=18.44MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF040[bloom] <- d_date_sk
|  |  |  mem-estimate=17.44MB mem-reservation=17.44MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  158:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 45(GETNEXT)
|  |  |
|  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  45:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 45(GETNEXT)
|  |
|  43:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk, RF036[bloom] -> cs_item_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=34 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 43(GETNEXT)
|
42:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 151(GETNEXT), 156(OPEN)
|
|--F81:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  157:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 156(GETNEXT)
|  |
|  F25:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  156:AGGREGATE [FINALIZE]
|  |  output: avg:merge(quantity * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 156(GETNEXT), 41(OPEN)
|  |
|  155:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 41(GETNEXT)
|  |
|  F24:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 1] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  41:AGGREGATE
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 41(GETNEXT), 32(OPEN), 35(OPEN), 38(OPEN)
|  |
|  31:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=15.12G cost=772026236
|  |  in pipelines: 32(GETNEXT), 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--F84:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  154:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 39(GETNEXT)
|  |  |  |
|  |  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 38(GETNEXT)
|  |
|  |--37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--F83:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  153:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 36(GETNEXT)
|  |  |  |
|  |  |  F21:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 35(GETNEXT)
|  |
|  34:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 32(GETNEXT), 33(OPEN)
|  |
|  |--F82:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  152:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 33(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  33:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 33(GETNEXT)
|  |
|  32:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 32(GETNEXT)
|
151:AGGREGATE [FINALIZE]
|  output: sum:merge(ss_quantity * ss_list_price), count:merge(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=890634
|  in pipelines: 151(GETNEXT), 01(OPEN)
|
150:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  mem-estimate=4.77MB mem-reservation=0B thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=41261
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
Per-Instance Resources: mem-estimate=43.03MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=109 segment-costs=[1608473849, 422546] cpu-comparison-result=409 [max(109 (self) vs 409 (sum children))]
30:AGGREGATE [STREAMING]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=819062197
|  in pipelines: 01(GETNEXT)
|
29:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,1 row-size=44B cardinality=511.06M cost=223758221
|  in pipelines: 01(GETNEXT), 148(OPEN)
|
|--F93:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=189.45MB mem-reservation=188.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |
|  149:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=478440
|  |  in pipelines: 148(GETNEXT)
|  |
|  F16:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.29MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[1086444, 11664] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  148:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=1039824
|  |  in pipelines: 148(GETNEXT), 135(OPEN)
|  |
|  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  mem-estimate=300.62KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=46620
|  |  in pipelines: 135(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=22.05MB mem-reservation=10.94MB thread-reservation=1
|  max-parallelism=20 segment-costs=[904993, 110395717, 278208] cpu-comparison-result=384 [max(20 (self) vs 384 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=99789810
|  |  in pipelines: 135(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=28B cardinality=57.60M cost=10475369
|  |  in pipelines: 135(GETNEXT), 04(OPEN)
|  |
|  |--F94:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=4.33MB mem-reservation=2.88MB thread-reservation=1
|  |  |  max-parallelism=20 segment-costs=[426492]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  runtime filters: RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0 cost=360000
|  |  |
|  |  146:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=3 row-size=16B cardinality=360.00K cost=66492
|  |  |  in pipelines: 04(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.56MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[639360]
|  |  04:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=3 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=65269
|  |  in pipelines: 135(GETNEXT), 144(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |
|  |  145:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 144(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  144:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 144(GETNEXT), 16(OPEN)
|  |  |
|  |  143:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  23:AGGREGATE [STREAMING]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=3047563509
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=15
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=15 plan-id=16 cohort-id=06
|  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  142:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  18:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=06
|  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  141:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=14 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=14 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=13 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=17
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=65269
|  |  in pipelines: 135(GETNEXT), 139(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |
|  |  140:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 139(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  139:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 139(GETNEXT), 11(OPEN)
|  |  |
|  |  138:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=6.00MB thread-reservation=1
|  |  max-parallelism=1030 segment-costs=[10291866608, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=6014287315
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  15:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=07
|  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  137:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=07
|  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  runtime filters: RF024[bloom] <- ics.i_item_sk, RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  136:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF025[min_max] -> cs_item_sk, RF024[bloom] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |     in pipelines: 11(GETNEXT)
|  |
|  135:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=880195
|  |  in pipelines: 135(GETNEXT), 05(OPEN)
|  |
|  134:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=24798
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=27.25MB mem-reservation=9.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[20502176631, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  10:AGGREGATE [STREAMING]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=11947236639
|  |  in pipelines: 05(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=20
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=32B cardinality=8.64G cost=3779809729
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  build expressions: d1.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  133:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=21
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=4,5 row-size=24B cardinality=8.64G cost=3779809729
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=21 plan-id=22 cohort-id=05
|  |  |  build expressions: iss.i_item_sk
|  |  |  runtime filters: RF020[bloom] <- iss.i_item_sk, RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  132:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=5 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF021[min_max] -> ss_item_sk, RF020[bloom] -> ss_item_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=4 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=22
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,1 row-size=44B cardinality=511.32M cost=223870100
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=379.57MB mem-reservation=374.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  build expressions: i_item_sk
|  |  runtime filters: RF003[min_max] <- i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  131:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 02(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  02:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=1 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=23
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.33MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  build expressions: d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  130:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 01(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=6.91GB Threads=293
Per-Host Resource Estimates: Memory=11.58GB
F80:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1587 [max(1 (self) vs 1587 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
216:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=34
|  in pipelines: 129(GETNEXT)
|
F79:PLAN FRAGMENT [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=94.68MB mem-reservation=30.44MB thread-reservation=1
max-parallelism=10 segment-costs=[3630009, 2955815, 5278200, 157] cpu-comparison-result=1587 [max(10 (self) vs 1587 (sum children))]
129:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=5278200
|  in pipelines: 129(GETNEXT), 128(OPEN)
|
128:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=494.90K cost=2955815
|  in pipelines: 128(GETNEXT), 215(OPEN)
|
215:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=57.00MB mem-reservation=25.69MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=2955813
|  in pipelines: 215(GETNEXT), 151(OPEN), 179(OPEN), 207(OPEN)
|
214:EXCHANGE [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)]
|  mem-estimate=37.68MB mem-reservation=0B thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=674196
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
F78:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Instance Resources: mem-estimate=74.93MB mem-reservation=11.94MB thread-reservation=1
max-parallelism=109 segment-costs=[931895, 931895, 931895, 8945360, 8923964] cpu-comparison-result=1587 [max(109 (self) vs 1587 (sum children))]
127:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=50.00MB mem-reservation=10.00MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=494.90K cost=8774131
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=447.36K cost=79567
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
|--126:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 207(GETNEXT), 212(OPEN)
|  |
|  |--F89:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  213:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 212(GETNEXT)
|  |  |
|  |  F77:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  212:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 212(GETNEXT), 125(OPEN)
|  |  |
|  |  211:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 125(GETNEXT)
|  |  |
|  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 1] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  125:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 125(GETNEXT), 116(OPEN), 119(OPEN), 122(OPEN)
|  |  |
|  |  115:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=15.12G cost=772026236
|  |  |  in pipelines: 116(GETNEXT), 119(GETNEXT), 122(GETNEXT)
|  |  |
|  |  |--124:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 122(GETNEXT), 123(OPEN)
|  |  |  |
|  |  |  |--F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 123(GETNEXT)
|  |  |  |  |
|  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 123(GETNEXT)
|  |  |  |
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--F91:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=93 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |  |
|  |  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |
|  |  |--F90:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  208:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=91 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  116:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 116(GETNEXT)
|  |
|  207:AGGREGATE [FINALIZE]
|  |  output: sum:merge(ws_quantity * ws_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=890634
|  |  in pipelines: 207(GETNEXT), 85(OPEN)
|  |
|  206:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=2.47MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=41261
|  |  in pipelines: 85(GETNEXT)
|  |
|  F52:PLAN FRAGMENT [RANDOM] hosts=10 instances=50 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=50 segment-costs=[462891756, 422546] cpu-comparison-result=409 [max(50 (self) vs 409 (sum children))]
|  114:AGGREGATE [STREAMING]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=149.12K cost=265540290
|  |  in pipelines: 85(GETNEXT)
|  |
|  113:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=36
|  |  hash predicates: ws_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=44B cardinality=127.77M cost=55939145
|  |  in pipelines: 85(GETNEXT), 204(OPEN)
|  |
|  |--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=87.45MB mem-reservation=86.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF072[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF073[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=85.00MB mem-reservation=85.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  205:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 204(GETNEXT)
|  |  |
|  |  F68:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.29MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1086444, 11664] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  204:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=1039824
|  |  |  in pipelines: 204(GETNEXT), 191(OPEN)
|  |  |
|  |  203:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=300.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=46620
|  |  |  in pipelines: 191(GETNEXT)
|  |  |
|  |  F58:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=22.05MB mem-reservation=10.94MB thread-reservation=1
|  |  max-parallelism=20 segment-costs=[904993, 110395717, 278208] cpu-comparison-result=384 [max(20 (self) vs 384 (sum children))]
|  |  112:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=4B cardinality=360.00K cost=99789810
|  |  |  in pipelines: 191(GETNEXT)
|  |  |
|  |  109:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=37
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: none
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=28B cardinality=57.60M cost=10475369
|  |  |  in pipelines: 191(GETNEXT), 88(OPEN)
|  |  |
|  |  |--F118:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=4.33MB mem-reservation=2.88MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[426492]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=37 plan-id=38 cohort-id=11
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  202:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=16B cardinality=360.00K cost=66492
|  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.56MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[639360]
|  |  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=71 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  108:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=38
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 191(GETNEXT), 200(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=38 plan-id=39 cohort-id=11
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  201:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 200(GETNEXT)
|  |  |  |
|  |  |  F66:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  200:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 200(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  199:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=520 segment-costs=[5186282830, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  107:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=149.12K cost=3047563509
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=32B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 100(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=12
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  198:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=83 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |  |
|  |  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  103:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=40
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=24B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=12
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  197:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=82 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F64:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=82 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=81 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=41
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 191(GETNEXT), 195(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=41 plan-id=42 cohort-id=11
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  196:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 195(GETNEXT)
|  |  |  |
|  |  |  F62:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  195:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 195(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  194:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  105:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=149.12K cost=6014287315
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=42
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 95(GETNEXT), 97(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=42 plan-id=43 cohort-id=13
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  193:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=79 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 97(GETNEXT)
|  |  |  |  |
|  |  |  |  F61:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  98:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=43
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=43 plan-id=44 cohort-id=13
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  192:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=78 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 96(GETNEXT)
|  |  |  |  |
|  |  |  |  F60:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=78 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=77 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  191:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 191(GETNEXT), 89(OPEN)
|  |  |
|  |  190:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  F55:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=27.25MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  94:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=149.12K cost=11947236639
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  93:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=44
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 89(GETNEXT), 91(OPEN)
|  |  |
|  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=44 plan-id=45 cohort-id=11
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=74 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 91(GETNEXT)
|  |  |  |
|  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 91(GETNEXT)
|  |  |
|  |  92:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=45
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |
|  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=45 plan-id=46 cohort-id=11
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF092[bloom] <- iss.i_item_sk, RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  188:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=73 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 90(GETNEXT)
|  |  |
|  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF093[min_max] -> ss_item_sk, RF092[bloom] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=72 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 89(GETNEXT)
|  |
|  111:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=46
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=44B cardinality=127.83M cost=55967115
|  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |
|  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=175.57MB mem-reservation=170.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=46 plan-id=47 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  |  mem-estimate=170.00MB mem-reservation=170.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  187:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=69 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 86(GETNEXT)
|  |  |
|  |  F54:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF072[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 86(GETNEXT)
|  |
|  110:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=47
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 85(GETNEXT), 87(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=10.70MB mem-reservation=10.69MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=47 plan-id=48 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF076[bloom] <- d_date_sk
|  |  |  mem-estimate=9.69MB mem-reservation=9.69MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  186:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=70 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F53:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 87(GETNEXT)
|  |
|  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk, RF072[bloom] -> ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=68 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 85(GETNEXT)
|
|--84:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 179(GETNEXT), 184(OPEN)
|  |
|  |--F85:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  185:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 184(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  184:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 184(GETNEXT), 83(OPEN)
|  |  |
|  |  183:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 83(GETNEXT)
|  |  |
|  |  F50:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 1] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  83:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 83(GETNEXT), 74(OPEN), 77(OPEN), 80(OPEN)
|  |  |
|  |  73:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=15.12G cost=772026236
|  |  |  in pipelines: 74(GETNEXT), 77(GETNEXT), 80(GETNEXT)
|  |  |
|  |  |--82:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |  |
|  |  |  |--F88:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  182:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 81(GETNEXT)
|  |  |  |  |
|  |  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  |--79:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 77(GETNEXT), 78(OPEN)
|  |  |  |
|  |  |  |--F87:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 78(GETNEXT)
|  |  |  |  |
|  |  |  |  F47:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  78:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 78(GETNEXT)
|  |  |  |
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--F86:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 75(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 74(GETNEXT)
|  |
|  179:AGGREGATE [FINALIZE]
|  |  output: sum:merge(cs_quantity * cs_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=890634
|  |  in pipelines: 179(GETNEXT), 43(OPEN)
|  |
|  178:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=4.03MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=41261
|  |  in pipelines: 43(GETNEXT)
|  |
|  F26:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=90 segment-costs=[841854022, 422546] cpu-comparison-result=409 [max(90 (self) vs 409 (sum children))]
|  72:AGGREGATE [STREAMING]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=149.12K cost=448647129
|  |  in pipelines: 43(GETNEXT)
|  |
|  71:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=24
|  |  hash predicates: cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=44B cardinality=254.56M cost=111454239
|  |  in pipelines: 43(GETNEXT), 176(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=155.45MB mem-reservation=154.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=24 plan-id=25 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF036[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF037[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=153.00MB mem-reservation=153.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  177:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 176(GETNEXT)
|  |  |
|  |  F42:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.29MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1086444, 11664] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  |  176:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=1039824
|  |  |  in pipelines: 176(GETNEXT), 163(OPEN)
|  |  |
|  |  175:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=300.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=46620
|  |  |  in pipelines: 163(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=22.05MB mem-reservation=10.94MB thread-reservation=1
|  |  max-parallelism=20 segment-costs=[904993, 110395717, 278208] cpu-comparison-result=384 [max(20 (self) vs 384 (sum children))]
|  |  70:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=4B cardinality=360.00K cost=99789810
|  |  |  in pipelines: 163(GETNEXT)
|  |  |
|  |  67:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=25
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: none
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=28B cardinality=57.60M cost=10475369
|  |  |  in pipelines: 163(GETNEXT), 46(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=4.33MB mem-reservation=2.88MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[426492]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=08
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  174:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=37 row-size=16B cardinality=360.00K cost=66492
|  |  |  |  in pipelines: 46(GETNEXT)
|  |  |  |
|  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.56MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[639360]
|  |  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=37 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 46(GETNEXT)
|  |  |
|  |  66:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=26
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 163(GETNEXT), 172(OPEN)
|  |  |
|  |  |--F107:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=08
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  173:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 172(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  172:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 172(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  171:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=520 segment-costs=[5186282830, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=149.12K cost=3047563509
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  62:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=32B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 58(GETNEXT), 60(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=09
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  170:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=49 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=24B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 58(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=09
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  169:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=48 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=48 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=47 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  64:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=29
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=65269
|  |  |  in pipelines: 163(GETNEXT), 167(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=29 plan-id=30 cohort-id=08
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |  |
|  |  |  168:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 167(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  |  167:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=880195
|  |  |  |  in pipelines: 167(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  166:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=24798
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  63:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=149.12K cost=6014287315
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=30
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 53(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=10
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=31
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=31 plan-id=32 cohort-id=10
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  164:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=44 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=44 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=43 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  163:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 163(GETNEXT), 47(OPEN)
|  |  |
|  |  162:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=27.25MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  52:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=149.12K cost=11947236639
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 47(GETNEXT), 49(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=08
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  161:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 49(GETNEXT)
|  |  |  |
|  |  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 49(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=08
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF056[bloom] <- iss.i_item_sk, RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  160:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=39 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  F30:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=39 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF057[min_max] -> ss_item_sk, RF056[bloom] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 47(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=34
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=44B cardinality=254.69M cost=111509966
|  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |
|  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=311.57MB mem-reservation=306.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=34 plan-id=35 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  |  mem-estimate=306.00MB mem-reservation=306.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=35 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 44(GETNEXT)
|  |  |
|  |  F28:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  44:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF037[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF036[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 44(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=35
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 43(GETNEXT), 45(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=18.45MB mem-reservation=18.44MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF040[bloom] <- d_date_sk
|  |  |  mem-estimate=17.44MB mem-reservation=17.44MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  158:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 45(GETNEXT)
|  |  |
|  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  45:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 45(GETNEXT)
|  |
|  43:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk, RF036[bloom] -> cs_item_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=34 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 43(GETNEXT)
|
42:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 151(GETNEXT), 156(OPEN)
|
|--F81:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  157:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 156(GETNEXT)
|  |
|  F25:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  156:AGGREGATE [FINALIZE]
|  |  output: avg:merge(quantity * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 156(GETNEXT), 41(OPEN)
|  |
|  155:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 41(GETNEXT)
|  |
|  F24:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 1] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  41:AGGREGATE
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 41(GETNEXT), 32(OPEN), 35(OPEN), 38(OPEN)
|  |
|  31:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=15.12G cost=772026236
|  |  in pipelines: 32(GETNEXT), 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--F84:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  154:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 39(GETNEXT)
|  |  |  |
|  |  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 38(GETNEXT)
|  |
|  |--37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--F83:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  153:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 36(GETNEXT)
|  |  |  |
|  |  |  F21:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 35(GETNEXT)
|  |
|  34:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 32(GETNEXT), 33(OPEN)
|  |
|  |--F82:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  152:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 33(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  33:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2000 AS INT), d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 33(GETNEXT)
|  |
|  32:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 32(GETNEXT)
|
151:AGGREGATE [FINALIZE]
|  output: sum:merge(ss_quantity * ss_list_price), count:merge(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=890634
|  in pipelines: 151(GETNEXT), 01(OPEN)
|
150:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  mem-estimate=4.77MB mem-reservation=0B thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=41261
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
Per-Instance Resources: mem-estimate=43.03MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=109 segment-costs=[1608473849, 422546] cpu-comparison-result=409 [max(109 (self) vs 409 (sum children))]
30:AGGREGATE [STREAMING]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=149.12K cost=819062197
|  in pipelines: 01(GETNEXT)
|
29:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,1 row-size=44B cardinality=511.06M cost=223758221
|  in pipelines: 01(GETNEXT), 148(OPEN)
|
|--F93:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=189.45MB mem-reservation=188.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |
|  149:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=478440
|  |  in pipelines: 148(GETNEXT)
|  |
|  F16:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.29MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[1086444, 11664] cpu-comparison-result=384 [max(10 (self) vs 384 (sum children))]
|  148:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=1039824
|  |  in pipelines: 148(GETNEXT), 135(OPEN)
|  |
|  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  mem-estimate=300.62KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=46620
|  |  in pipelines: 135(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=22.05MB mem-reservation=10.94MB thread-reservation=1
|  max-parallelism=20 segment-costs=[904993, 110395717, 278208] cpu-comparison-result=384 [max(20 (self) vs 384 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=4B cardinality=360.00K cost=99789810
|  |  in pipelines: 135(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=28B cardinality=57.60M cost=10475369
|  |  in pipelines: 135(GETNEXT), 04(OPEN)
|  |
|  |--F94:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=4.33MB mem-reservation=2.88MB thread-reservation=1
|  |  |  max-parallelism=20 segment-costs=[426492]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  runtime filters: RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0 cost=360000
|  |  |
|  |  146:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=3 row-size=16B cardinality=360.00K cost=66492
|  |  |  in pipelines: 04(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.56MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[639360]
|  |  04:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=3 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=65269
|  |  in pipelines: 135(GETNEXT), 144(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |
|  |  145:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 144(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  144:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 144(GETNEXT), 16(OPEN)
|  |  |
|  |  143:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  23:AGGREGATE [STREAMING]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=3047563509
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=15
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=15 plan-id=16 cohort-id=06
|  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  142:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  18:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2000 AS INT), d3.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=06
|  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  141:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=14 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=14 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=13 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=17
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=65269
|  |  in pipelines: 135(GETNEXT), 139(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=10 instances=20 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.26MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=20 segment-costs=[173918] cpu-comparison-result=120 [max(20 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=149120
|  |  |
|  |  140:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=334.75KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 139(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=12.05MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[904993, 192066] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  139:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=880195
|  |  |  in pipelines: 139(GETNEXT), 11(OPEN)
|  |  |
|  |  138:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=24798
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=6.00MB thread-reservation=1
|  |  max-parallelism=1030 segment-costs=[10291866608, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=149.12K cost=6014287315
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  15:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=07
|  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  137:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2000 AS INT), d2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=07
|  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  runtime filters: RF024[bloom] <- ics.i_item_sk, RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  136:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF025[min_max] -> cs_item_sk, RF024[bloom] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |     in pipelines: 11(GETNEXT)
|  |
|  135:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=880195
|  |  in pipelines: 135(GETNEXT), 05(OPEN)
|  |
|  134:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  mem-estimate=2.05MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=24798
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=27.25MB mem-reservation=9.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[20502176631, 192066] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  10:AGGREGATE [STREAMING]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=149.12K cost=11947236639
|  |  in pipelines: 05(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=20
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=32B cardinality=8.64G cost=3779809729
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  build expressions: d1.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  133:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2000 AS INT), d1.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=21
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=4,5 row-size=24B cardinality=8.64G cost=3779809729
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=21 plan-id=22 cohort-id=05
|  |  |  build expressions: iss.i_item_sk
|  |  |  runtime filters: RF020[bloom] <- iss.i_item_sk, RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  132:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=5 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF021[min_max] -> ss_item_sk, RF020[bloom] -> ss_item_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=4 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=22
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,1 row-size=44B cardinality=511.32M cost=223870100
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=379.57MB mem-reservation=374.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  build expressions: i_item_sk
|  |  runtime filters: RF003[min_max] <- i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  131:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 02(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  02:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=1 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=23
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.33MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  build expressions: d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  130:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2000 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 01(GETNEXT)
====
