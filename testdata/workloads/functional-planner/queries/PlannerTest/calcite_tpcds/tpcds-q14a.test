# TPCDS-Q14a first of two
# start query 14 in stream 0 using template query14.tpl using seed 521152908
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1998 AND 1998 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1998 AND 1998 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1998 AND 1998 + 2) x
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2) x)
  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
 limit 100
---- PLAN
Max Per-Host Resource Reservation: Memory=319.38MB Threads=1
Per-Host Resource Estimates: Memory=1009MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=1008.70MB mem-reservation=319.38MB thread-reservation=1 runtime-filters-memory=10.00MB
|  max-parallelism=1 segment-costs=[5106386099, 20422279899, 10211969877, 1760391, 2659596, 781291489, 11061232872, 5106386099, 20422279899, 10211969877, 1760391, 2659596, 389875629, 11061232872, 5106386099, 20422279899, 10211969877, 1760391, 2659596, 196387493, 11061232872, 11504873, 10687615, 20955666, 600]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END, aggif(valid_tid(152,153,154,155,156) IN (152, 153, 154, 155, 156), CASE valid_tid(152,153,154,155,156) WHEN 152 THEN sum(SALES) WHEN 153 THEN sum(SALES) WHEN 154 THEN sum(SALES) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) END), aggif(valid_tid(152,153,154,155,156) IN (152, 153, 154, 155, 156), CASE valid_tid(152,153,154,155,156) WHEN 152 THEN sum(NUMBER_SALES) WHEN 153 THEN sum(NUMBER_SALES) WHEN 154 THEN sum(NUMBER_SALES) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
136:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=158 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 136(GETNEXT), 135(OPEN)
|
135:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(152,153,154,155,156) IN (CAST(152 AS INT), CAST(153 AS INT), CAST(154 AS INT), CAST(155 AS INT), CAST(156 AS INT)), CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN sum(SALES) WHEN CAST(153 AS INT) THEN sum(SALES) WHEN CAST(154 AS INT) THEN sum(SALES) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) END), aggif(valid_tid(152,153,154,155,156) IN (CAST(152 AS INT), CAST(153 AS INT), CAST(154 AS INT), CAST(155 AS INT), CAST(156 AS INT)), CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(153 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(154 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN CHANNEL WHEN CAST(153 AS INT) THEN CHANNEL WHEN CAST(154 AS INT) THEN CHANNEL WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_BRAND_ID WHEN CAST(153 AS INT) THEN I_BRAND_ID WHEN CAST(154 AS INT) THEN I_BRAND_ID WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_CLASS_ID WHEN CAST(153 AS INT) THEN I_CLASS_ID WHEN CAST(154 AS INT) THEN NULL WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_CATEGORY_ID WHEN CAST(153 AS INT) THEN NULL WHEN CAST(154 AS INT) THEN NULL WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN CAST(152 AS INT) WHEN CAST(153 AS INT) THEN CAST(153 AS INT) WHEN CAST(154 AS INT) THEN CAST(154 AS INT) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=157 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 135(GETNEXT), 134(OPEN)
|
134:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=11333645
|  in pipelines: 134(GETNEXT), 32(OPEN), 76(OPEN), 120(OPEN)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=151 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 32(GETNEXT), 76(GETNEXT), 120(GETNEXT)
|
|--133:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=134,150 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 120(GETNEXT), 132(OPEN)
|  |
|  |--132:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=150 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 132(GETNEXT), 123(OPEN), 126(OPEN), 129(OPEN)
|  |  |
|  |  121:UNION
|  |  |  pass-through-operands: 122
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 123(GETNEXT), 126(GETNEXT), 129(GETNEXT)
|  |  |
|  |  |--131:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=144,146 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |  |
|  |  |  |--130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=146 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=144 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 129(GETNEXT)
|  |  |
|  |  122:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=143 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 123(GETNEXT), 126(GETNEXT)
|  |  |
|  |  |--128:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=139,141 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 126(GETNEXT), 127(OPEN)
|  |  |  |
|  |  |  |--127:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=141 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 127(GETNEXT)
|  |  |  |
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=139 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=135,137 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 123(GETNEXT), 124(OPEN)
|  |  |
|  |  |--124:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=137 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 124(GETNEXT)
|  |  |
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=135 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 123(GETNEXT)
|  |
|  120:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=149.12K cost=19125839
|  |  in pipelines: 120(GETNEXT), 90(OPEN)
|  |
|  119:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  runtime filters: RF060[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF061[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=101,103,105 row-size=44B cardinality=12.78M cost=35139222
|  |  in pipelines: 90(GETNEXT), 117(OPEN)
|  |
|  |--118:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_10.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_10.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_10.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=157271
|  |  |  in pipelines: 117(GETNEXT), 95(OPEN)
|  |  |
|  |  |--95:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_10.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_10.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=107 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  117:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 117(GETNEXT), 116(OPEN), 110(OPEN)
|  |  |
|  |  96:UNION
|  |  |  pass-through-operands: 116
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=132 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 116(GETNEXT), 110(GETNEXT)
|  |  |
|  |  |--110:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 110(GETNEXT), 103(OPEN), 109(OPEN)
|  |  |  |
|  |  |  97:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=123 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 103(GETNEXT), 109(GETNEXT)
|  |  |  |
|  |  |  |--109:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 109(GETNEXT), 104(OPEN)
|  |  |  |  |
|  |  |  |  108:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118,120 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  |  in pipelines: 104(GETNEXT), 107(OPEN)
|  |  |  |  |
|  |  |  |  |--107:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=120 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  runtime filters: RF083[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 104(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--105:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=118 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF083[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  103:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 103(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=109,111,113 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  |  in pipelines: 98(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--101:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=113 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  runtime filters: RF078[bloom] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk, RF079[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=109,111 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--99:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=111 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF079[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk, RF078[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  116:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  in pipelines: 116(GETNEXT), 111(OPEN)
|  |  |
|  |  115:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125,127,129 row-size=32B cardinality=2.16G cost=944952811
|  |  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |  |
|  |  |--114:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=129 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF075[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=125,127 row-size=24B cardinality=2.16G cost=945305506
|  |  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |  |
|  |  |--112:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=127 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 112(GETNEXT)
|  |  |
|  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF075[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=125 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 111(GETNEXT)
|  |
|  94:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=101,103,105 row-size=44B cardinality=127.83M cost=56327115
|  |  in pipelines: 90(GETNEXT), 93(OPEN)
|  |
|  |--93:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF060[bloom] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=105 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 93(GETNEXT)
|  |
|  92:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=101,103 row-size=28B cardinality=127.89M cost=55978804
|  |  in pipelines: 90(GETNEXT), 91(OPEN)
|  |
|  |--91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=103 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 91(GETNEXT)
|  |
|  90:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk, RF060[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=101 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 90(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=100 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 32(GETNEXT), 76(GETNEXT)
|
|--89:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83,99 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 76(GETNEXT), 88(OPEN)
|  |
|  |--88:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 88(GETNEXT), 79(OPEN), 82(OPEN), 85(OPEN)
|  |  |
|  |  77:UNION
|  |  |  pass-through-operands: 78
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=97 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 79(GETNEXT), 82(GETNEXT), 85(GETNEXT)
|  |  |
|  |  |--87:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=93,95 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |  |  |
|  |  |  |--86:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 86(GETNEXT)
|  |  |  |
|  |  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=93 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 85(GETNEXT)
|  |  |
|  |  78:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=92 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 79(GETNEXT), 82(GETNEXT)
|  |  |
|  |  |--84:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=88,90 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 82(GETNEXT), 83(OPEN)
|  |  |  |
|  |  |  |--83:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=90 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 83(GETNEXT)
|  |  |  |
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=88 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=84,86 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 79(GETNEXT), 80(OPEN)
|  |  |
|  |  |--80:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=86 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  79:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=84 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 79(GETNEXT)
|  |
|  76:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=149.12K cost=37436523
|  |  in pipelines: 76(GETNEXT), 46(OPEN)
|  |
|  75:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  runtime filters: RF030[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF031[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=50,52,54 row-size=44B cardinality=25.46M cost=69976341
|  |  in pipelines: 46(GETNEXT), 73(OPEN)
|  |
|  |--74:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_5.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_5.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=82,56 row-size=36B cardinality=36.00K cost=157271
|  |  |  in pipelines: 73(GETNEXT), 51(OPEN)
|  |  |
|  |  |--51:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_5.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_5.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=56 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 51(GETNEXT)
|  |  |
|  |  73:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 73(GETNEXT), 72(OPEN), 66(OPEN)
|  |  |
|  |  52:UNION
|  |  |  pass-through-operands: 72
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=81 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 72(GETNEXT), 66(GETNEXT)
|  |  |
|  |  |--66:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 66(GETNEXT), 59(OPEN), 65(OPEN)
|  |  |  |
|  |  |  53:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 59(GETNEXT), 65(GETNEXT)
|  |  |  |
|  |  |  |--65:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 65(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  64:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=65,67,69 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  |  in pipelines: 60(GETNEXT), 63(OPEN)
|  |  |  |  |
|  |  |  |  |--63:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=69 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 63(GETNEXT)
|  |  |  |  |
|  |  |  |  62:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  runtime filters: RF053[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=65,67 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 60(GETNEXT), 61(OPEN)
|  |  |  |  |
|  |  |  |  |--61:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=67 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 61(GETNEXT)
|  |  |  |  |
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF053[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=65 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  59:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 59(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  58:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,60,62 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  |  in pipelines: 54(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  |--57:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=62 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  runtime filters: RF048[bloom] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk, RF049[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=58,60 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 54(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--55:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=60 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF049[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk, RF048[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 54(GETNEXT)
|  |  |
|  |  72:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  in pipelines: 72(GETNEXT), 67(OPEN)
|  |  |
|  |  71:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=74,76,78 row-size=32B cardinality=2.16G cost=944952811
|  |  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |  |
|  |  |--70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=78 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 70(GETNEXT)
|  |  |
|  |  69:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF045[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=74,76 row-size=24B cardinality=2.16G cost=945305506
|  |  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |  |
|  |  |--68:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=76 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 68(GETNEXT)
|  |  |
|  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF045[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=74 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 67(GETNEXT)
|  |
|  50:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50,52,54 row-size=44B cardinality=254.69M cost=111869966
|  |  in pipelines: 46(GETNEXT), 49(OPEN)
|  |
|  |--49:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=54 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 49(GETNEXT)
|  |
|  48:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=50,52 row-size=28B cardinality=254.82M cost=111533149
|  |  in pipelines: 46(GETNEXT), 47(OPEN)
|  |
|  |--47:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=52 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 47(GETNEXT)
|  |
|  46:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=50 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 46(GETNEXT)
|
45:NESTED LOOP JOIN [INNER JOIN]
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=33,49 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 32(GETNEXT), 44(OPEN)
|
|--44:AGGREGATE [FINALIZE]
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 44(GETNEXT), 35(OPEN), 38(OPEN), 41(OPEN)
|  |
|  33:UNION
|  |  pass-through-operands: 34
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=47 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 35(GETNEXT), 38(GETNEXT), 41(GETNEXT)
|  |
|  |--43:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=43,45 row-size=20B cardinality=2.16G cost=945425284
|  |  |  in pipelines: 41(GETNEXT), 42(OPEN)
|  |  |
|  |  |--42:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 42(GETNEXT)
|  |  |
|  |  41:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=43 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 41(GETNEXT)
|  |
|  34:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=42 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,40 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 38(GETNEXT)
|  |
|  37:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=20B cardinality=8.64G cost=3781706938
|  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |
|  |--36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 36(GETNEXT)
|  |
|  35:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=34 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 35(GETNEXT)
|
32:AGGREGATE [FINALIZE]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=149.12K cost=74478030
|  in pipelines: 32(GETNEXT), 02(OPEN)
|
31:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=0,2,4 row-size=44B cardinality=51.11M cost=140449917
|  in pipelines: 02(GETNEXT), 29(OPEN)
|
|--30:HASH JOIN [INNER JOIN]
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_0.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_0.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=32,6 row-size=36B cardinality=36.00K cost=157271
|  |  in pipelines: 29(GETNEXT), 07(OPEN)
|  |
|  |--07:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_0.i_item_sk)
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_0.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 07(GETNEXT)
|  |
|  29:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 29(GETNEXT), 28(OPEN), 22(OPEN)
|  |
|  08:UNION
|  |  pass-through-operands: 28
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 28(GETNEXT), 22(GETNEXT)
|  |
|  |--22:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 22(GETNEXT), 15(OPEN), 21(OPEN)
|  |  |
|  |  09:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 15(GETNEXT), 21(GETNEXT)
|  |  |
|  |  |--21:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  in pipelines: 21(GETNEXT), 16(OPEN)
|  |  |  |
|  |  |  20:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=15,17,19 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  in pipelines: 16(GETNEXT), 19(OPEN)
|  |  |  |
|  |  |  |--19:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=19 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 19(GETNEXT)
|  |  |  |
|  |  |  18:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  runtime filters: RF022[bloom] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk, RF023[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=15,17 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--17:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF022[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  15:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  in pipelines: 15(GETNEXT), 10(OPEN)
|  |  |
|  |  14:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=8,10,12 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  in pipelines: 10(GETNEXT), 13(OPEN)
|  |  |
|  |  |--13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=12 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  12:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=8,10 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
|  |  |
|  |  |--11:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=8 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 10(GETNEXT)
|  |
|  28:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=149.12K cost=2967204009
|  |  in pipelines: 28(GETNEXT), 23(OPEN)
|  |
|  27:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=24,26,28 row-size=32B cardinality=2.16G cost=944952811
|  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |
|  |--26:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=28 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 26(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF015[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=24,26 row-size=24B cardinality=2.16G cost=945305506
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--24:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=24 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 23(GETNEXT)
|
06:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=44B cardinality=511.32M cost=224230100
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--05:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916534
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 02(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=11.21GB Threads=328
Per-Host Resource Estimates: Memory=30.79GB
F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END, aggif(valid_tid(152,153,154,155,156) IN (152, 153, 154, 155, 156), CASE valid_tid(152,153,154,155,156) WHEN 152 THEN sum(SALES) WHEN 153 THEN sum(SALES) WHEN 154 THEN sum(SALES) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) END), aggif(valid_tid(152,153,154,155,156) IN (152, 153, 154, 155, 156), CASE valid_tid(152,153,154,155,156) WHEN 152 THEN sum(NUMBER_SALES) WHEN 153 THEN sum(NUMBER_SALES) WHEN 154 THEN sum(NUMBER_SALES) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
223:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=158 row-size=48B cardinality=100 cost=34
|  in pipelines: 136(GETNEXT)
|
F92:PLAN FRAGMENT [HASH(CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(CHANNEL) WHEN 153 THEN murmur_hash(CHANNEL) WHEN 154 THEN murmur_hash(CHANNEL) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_BRAND_ID) WHEN 153 THEN murmur_hash(I_BRAND_ID) WHEN 154 THEN murmur_hash(I_BRAND_ID) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CLASS_ID) WHEN 153 THEN murmur_hash(I_CLASS_ID) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CATEGORY_ID) WHEN 153 THEN murmur_hash(NULL) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[13125702, 10687615, 20955666, 157] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
136:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=158 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 136(GETNEXT), 135(OPEN)
|
135:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(152,153,154,155,156) IN (CAST(152 AS INT), CAST(153 AS INT), CAST(154 AS INT), CAST(155 AS INT), CAST(156 AS INT)), CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN sum(SALES) WHEN CAST(153 AS INT) THEN sum(SALES) WHEN CAST(154 AS INT) THEN sum(SALES) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) END), aggif(valid_tid(152,153,154,155,156) IN (CAST(152 AS INT), CAST(153 AS INT), CAST(154 AS INT), CAST(155 AS INT), CAST(156 AS INT)), CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(153 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(154 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN CHANNEL WHEN CAST(153 AS INT) THEN CHANNEL WHEN CAST(154 AS INT) THEN CHANNEL WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_BRAND_ID WHEN CAST(153 AS INT) THEN I_BRAND_ID WHEN CAST(154 AS INT) THEN I_BRAND_ID WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_CLASS_ID WHEN CAST(153 AS INT) THEN I_CLASS_ID WHEN CAST(154 AS INT) THEN NULL WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_CATEGORY_ID WHEN CAST(153 AS INT) THEN NULL WHEN CAST(154 AS INT) THEN NULL WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN CAST(152 AS INT) WHEN CAST(153 AS INT) THEN CAST(153 AS INT) WHEN CAST(154 AS INT) THEN CAST(154 AS INT) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=157 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 135(GETNEXT), 222(OPEN)
|
222:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=10687785
|  in pipelines: 222(GETNEXT), 158(OPEN), 186(OPEN), 214(OPEN)
|
221:EXCHANGE [HASH(CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(CHANNEL) WHEN 153 THEN murmur_hash(CHANNEL) WHEN 154 THEN murmur_hash(CHANNEL) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_BRAND_ID) WHEN 153 THEN murmur_hash(I_BRAND_ID) WHEN 154 THEN murmur_hash(I_BRAND_ID) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CLASS_ID) WHEN 153 THEN murmur_hash(I_CLASS_ID) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CATEGORY_ID) WHEN 153 THEN murmur_hash(NULL) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END)]
|  mem-estimate=32.85MB mem-reservation=0B thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=2437917
|  in pipelines: 158(GETNEXT), 186(GETNEXT), 214(GETNEXT)
|
F91:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
Per-Instance Resources: mem-estimate=555.67MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=90 segment-costs=[29697476, 24044235, 16389428, 11505411, 32269345] cpu-comparison-result=1557 [max(90 (self) vs 1557 (sum children))]
134:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=11334183
|  in pipelines: 158(GETNEXT), 186(GETNEXT), 214(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=151 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 158(GETNEXT), 186(GETNEXT), 214(GETNEXT)
|
|--133:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=134,150 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 214(GETNEXT), 219(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  220:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=150 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 219(GETNEXT)
|  |  |
|  |  F90:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  219:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=150 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 219(GETNEXT), 132(OPEN)
|  |  |
|  |  218:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 132(GETNEXT)
|  |  |
|  |  F89:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  132:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=149 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 132(GETNEXT), 123(OPEN), 126(OPEN), 129(OPEN)
|  |  |
|  |  121:UNION
|  |  |  pass-through-operands: 122
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 123(GETNEXT), 126(GETNEXT), 129(GETNEXT)
|  |  |
|  |  |--131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=144,146 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |  |
|  |  |  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  217:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=146 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 130(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=146 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=144 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 129(GETNEXT)
|  |  |
|  |  122:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=143 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 123(GETNEXT), 126(GETNEXT)
|  |  |
|  |  |--128:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=139,141 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 126(GETNEXT), 127(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  216:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=141 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 127(GETNEXT)
|  |  |  |  |
|  |  |  |  F85:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  127:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=141 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 127(GETNEXT)
|  |  |  |
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=139 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=135,137 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 123(GETNEXT), 124(OPEN)
|  |  |
|  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  215:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=137 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 124(GETNEXT)
|  |  |  |
|  |  |  F83:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  124:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=137 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 124(GETNEXT)
|  |  |
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=135 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 123(GETNEXT)
|  |
|  214:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=149.12K cost=13862637
|  |  in pipelines: 214(GETNEXT), 90(OPEN)
|  |
|  213:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  mem-estimate=11.17MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=9.13M cost=2526791
|  |  in pipelines: 90(GETNEXT)
|  |
|  F61:PLAN FRAGMENT [RANDOM] hosts=10 instances=30 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=40.06MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=30 segment-costs=[236319811, 25876095] cpu-comparison-result=399 [max(30 (self) vs 399 (sum children))]
|  120:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=9.13M cost=59804268
|  |  in pipelines: 90(GETNEXT)
|  |
|  119:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=101,103,105 row-size=44B cardinality=12.78M cost=35103222
|  |  in pipelines: 90(GETNEXT), 210(OPEN)
|  |
|  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=11.29MB mem-reservation=9.62MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  runtime filters: RF060[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF061[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  mem-estimate=8.62MB mem-reservation=8.62MB spill-buffer=128.00KB thread-reservation=0 cost=36000
|  |  |
|  |  212:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=47840
|  |  |  in pipelines: 210(GETNEXT)
|  |  |
|  |  F79:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=131.67MB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 126325] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  118:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=33
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_10.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_10.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_10.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 210(GETNEXT), 95(OPEN)
|  |  |
|  |  |--F127:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_category_id, tpcds_partitioned_parquet_snap.item_10.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  211:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=107 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F80:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_10.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_10.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=107 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  210:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 210(GETNEXT), 198(OPEN), 208(OPEN)
|  |  |
|  |  209:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 198(GETNEXT), 208(GETNEXT)
|  |  |
|  |  F78:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  117:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 198(GETNEXT), 208(GETNEXT)
|  |  |
|  |  96:UNION
|  |  |  pass-through-operands: 198
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=132 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 198(GETNEXT), 208(GETNEXT)
|  |  |
|  |  |--208:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 208(GETNEXT), 202(OPEN), 206(OPEN)
|  |  |  |
|  |  |  207:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 202(GETNEXT), 206(GETNEXT)
|  |  |  |
|  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  110:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 202(GETNEXT), 206(GETNEXT)
|  |  |  |
|  |  |  97:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=123 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 202(GETNEXT), 206(GETNEXT)
|  |  |  |
|  |  |  |--206:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 206(GETNEXT), 104(OPEN)
|  |  |  |  |
|  |  |  |  205:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  109:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=38
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118,120 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 104(GETNEXT), 107(OPEN)
|  |  |  |  |
|  |  |  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  204:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=120 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 107(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  107:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=120 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=39
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 104(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  |  runtime filters: RF083[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  203:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=118 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 105(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  105:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=118 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF083[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  202:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 202(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  201:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  103:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=36
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=109,111,113 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 98(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F130:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  200:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=113 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=113 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=109,111 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--F131:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  runtime filters: RF078[bloom] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk, RF079[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=111 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  F69:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  99:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=111 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF079[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk, RF078[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  198:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 198(GETNEXT), 111(OPEN)
|  |  |
|  |  197:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  116:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125,127,129 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |  |
|  |  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  196:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=129 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 114(GETNEXT)
|  |  |  |
|  |  |  F66:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  114:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=129 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=125,127 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |  |
|  |  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  |  runtime filters: RF075[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  195:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=127 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=127 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 112(GETNEXT)
|  |  |
|  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF075[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=125 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 111(GETNEXT)
|  |
|  94:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=101,103,105 row-size=44B cardinality=127.83M cost=55967115
|  |  in pipelines: 90(GETNEXT), 93(OPEN)
|  |
|  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=107.57MB mem-reservation=102.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=102.00MB mem-reservation=102.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  194:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=105 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 93(GETNEXT)
|  |  |
|  |  F63:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  93:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF060[bloom] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=105 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 93(GETNEXT)
|  |
|  92:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=101,103 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 90(GETNEXT), 91(OPEN)
|  |
|  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.83MB mem-reservation=6.81MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=5.81MB mem-reservation=5.81MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  193:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=103 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 91(GETNEXT)
|  |  |
|  |  F62:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=103 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 91(GETNEXT)
|  |
|  90:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk, RF060[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=101 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 90(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=100 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 158(GETNEXT), 186(GETNEXT)
|
|--89:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83,99 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 186(GETNEXT), 191(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  192:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 191(GETNEXT)
|  |  |
|  |  F59:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  191:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 191(GETNEXT), 88(OPEN)
|  |  |
|  |  190:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 88(GETNEXT)
|  |  |
|  |  F58:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  88:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 88(GETNEXT), 79(OPEN), 82(OPEN), 85(OPEN)
|  |  |
|  |  77:UNION
|  |  |  pass-through-operands: 78
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=97 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 79(GETNEXT), 82(GETNEXT), 85(GETNEXT)
|  |  |
|  |  |--87:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=93,95 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |  |  |
|  |  |  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 86(GETNEXT)
|  |  |  |  |
|  |  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 86(GETNEXT)
|  |  |  |
|  |  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=93 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 85(GETNEXT)
|  |  |
|  |  78:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=92 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 79(GETNEXT), 82(GETNEXT)
|  |  |
|  |  |--84:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=88,90 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 82(GETNEXT), 83(OPEN)
|  |  |  |
|  |  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  188:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=90 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 83(GETNEXT)
|  |  |  |  |
|  |  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  83:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=90 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 83(GETNEXT)
|  |  |  |
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=88 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=84,86 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 79(GETNEXT), 80(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  187:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=86 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 80(GETNEXT)
|  |  |  |
|  |  |  F52:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=86 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  79:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=84 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 79(GETNEXT)
|  |
|  186:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=149.12K cost=20286572
|  |  in pipelines: 186(GETNEXT), 46(OPEN)
|  |
|  185:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  mem-estimate=11.95MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=13.58M cost=3757663
|  |  in pipelines: 46(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [RANDOM] hosts=10 instances=50 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=40.06MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=50 segment-costs=[449952526, 38481081] cpu-comparison-result=399 [max(50 (self) vs 399 (sum children))]
|  76:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=13.58M cost=98259531
|  |  in pipelines: 46(GETNEXT)
|  |
|  75:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=50,52,54 row-size=44B cardinality=25.46M cost=69940341
|  |  in pipelines: 46(GETNEXT), 182(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=17.04MB mem-reservation=15.38MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  runtime filters: RF030[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF031[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  mem-estimate=14.38MB mem-reservation=14.38MB spill-buffer=128.00KB thread-reservation=0 cost=36000
|  |  |
|  |  184:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82,56 row-size=36B cardinality=36.00K cost=47840
|  |  |  in pipelines: 182(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=131.67MB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 126325] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  74:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=23
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_5.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_5.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82,56 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 182(GETNEXT), 51(OPEN)
|  |  |
|  |  |--F117:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=23 plan-id=24 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_category_id, tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  183:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=56 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 51(GETNEXT)
|  |  |  |
|  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_5.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_5.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=56 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 51(GETNEXT)
|  |  |
|  |  182:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 182(GETNEXT), 170(OPEN), 180(OPEN)
|  |  |
|  |  181:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 170(GETNEXT), 180(GETNEXT)
|  |  |
|  |  F47:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  73:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 170(GETNEXT), 180(GETNEXT)
|  |  |
|  |  52:UNION
|  |  |  pass-through-operands: 170
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=81 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 170(GETNEXT), 180(GETNEXT)
|  |  |
|  |  |--180:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 180(GETNEXT), 174(OPEN), 178(OPEN)
|  |  |  |
|  |  |  179:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  66:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |  |  |
|  |  |  53:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |  |  |
|  |  |  |--178:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 178(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  64:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=28
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=65,67,69 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 60(GETNEXT), 63(OPEN)
|  |  |  |  |
|  |  |  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=69 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 63(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  63:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=69 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 63(GETNEXT)
|  |  |  |  |
|  |  |  |  62:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=29
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=65,67 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 60(GETNEXT), 61(OPEN)
|  |  |  |  |
|  |  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  |  runtime filters: RF053[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=67 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 61(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  61:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=67 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 61(GETNEXT)
|  |  |  |  |
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF053[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=65 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  174:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 174(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  173:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  59:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  58:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=26
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,60,62 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 54(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  172:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=62 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=62 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=58,60 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 54(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  runtime filters: RF048[bloom] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk, RF049[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  171:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=60 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=60 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF049[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk, RF048[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 54(GETNEXT)
|  |  |
|  |  170:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 170(GETNEXT), 67(OPEN)
|  |  |
|  |  169:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 67(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  72:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 67(GETNEXT)
|  |  |
|  |  71:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=74,76,78 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |  |
|  |  |--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  168:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=78 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 70(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=78 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 70(GETNEXT)
|  |  |
|  |  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=74,76 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  |  runtime filters: RF045[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  167:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=76 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 68(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  68:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=76 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 68(GETNEXT)
|  |  |
|  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF045[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=74 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 67(GETNEXT)
|  |
|  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50,52,54 row-size=44B cardinality=254.69M cost=111509966
|  |  in pipelines: 46(GETNEXT), 49(OPEN)
|  |
|  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=175.57MB mem-reservation=170.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=170.00MB mem-reservation=170.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  166:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=54 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 49(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=54 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 49(GETNEXT)
|  |
|  48:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=50,52 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 46(GETNEXT), 47(OPEN)
|  |
|  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=10.70MB mem-reservation=10.69MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=9.69MB mem-reservation=9.69MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  165:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=52 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=52 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 47(GETNEXT)
|  |
|  46:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=50 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 46(GETNEXT)
|
45:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=33,49 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 158(GETNEXT), 163(OPEN)
|
|--F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  164:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 163(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  163:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 163(GETNEXT), 44(OPEN)
|  |
|  162:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 44(GETNEXT)
|  |
|  F28:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  44:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=48 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 44(GETNEXT), 35(OPEN), 38(OPEN), 41(OPEN)
|  |
|  33:UNION
|  |  pass-through-operands: 34
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=47 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 35(GETNEXT), 38(GETNEXT), 41(GETNEXT)
|  |
|  |--43:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=43,45 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 41(GETNEXT), 42(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  161:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 42(GETNEXT)
|  |  |  |
|  |  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  42:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 42(GETNEXT)
|  |  |
|  |  41:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=43 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 41(GETNEXT)
|  |
|  34:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=42 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,40 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  160:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 39(GETNEXT)
|  |  |  |
|  |  |  F24:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 38(GETNEXT)
|  |
|  37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 36(GETNEXT)
|  |  |
|  |  F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 36(GETNEXT)
|  |
|  35:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=34 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 35(GETNEXT)
|
158:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=149.12K cost=25030787
|  in pipelines: 158(GETNEXT), 02(OPEN)
|
157:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  mem-estimate=13.52MB mem-reservation=0B thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=16.87M cost=4666689
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
Per-Instance Resources: mem-estimate=40.06MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=90 segment-costs=[856245596, 47790137] cpu-comparison-result=399 [max(90 (self) vs 399 (sum children))]
32:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=16.87M cost=150178248
|  in pipelines: 02(GETNEXT)
|
31:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=0,2,4 row-size=44B cardinality=51.11M cost=140413917
|  in pipelines: 02(GETNEXT), 154(OPEN)
|
|--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=28.54MB mem-reservation=26.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  mem-estimate=25.88MB mem-reservation=25.88MB spill-buffer=128.00KB thread-reservation=0 cost=36000
|  |
|  156:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=32,6 row-size=36B cardinality=36.00K cost=47840
|  |  in pipelines: 154(GETNEXT)
|  |
|  F18:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=131.67MB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 126325] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  30:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_0.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_0.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=32,6 row-size=36B cardinality=36.00K cost=121271
|  |  in pipelines: 154(GETNEXT), 07(OPEN)
|  |
|  |--F107:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[42649]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_category_id, tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  155:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=16B cardinality=36.00K cost=6649
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[148701]
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_0.i_item_sk)
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_0.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 07(GETNEXT)
|  |
|  154:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 154(GETNEXT), 142(OPEN), 152(OPEN)
|  |
|  153:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 142(GETNEXT), 152(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  29:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 142(GETNEXT), 152(GETNEXT)
|  |
|  08:UNION
|  |  pass-through-operands: 142
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 142(GETNEXT), 152(GETNEXT)
|  |
|  |--152:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 152(GETNEXT), 146(OPEN), 150(OPEN)
|  |  |
|  |  151:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 146(GETNEXT), 150(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  22:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 146(GETNEXT), 150(GETNEXT)
|  |  |
|  |  09:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 146(GETNEXT), 150(GETNEXT)
|  |  |
|  |  |--150:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 150(GETNEXT), 16(OPEN)
|  |  |  |
|  |  |  149:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  21:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=18
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=15,17,19 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 16(GETNEXT), 19(OPEN)
|  |  |  |
|  |  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  148:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=19 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 19(GETNEXT)
|  |  |  |  |
|  |  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  19:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=19 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 19(GETNEXT)
|  |  |  |
|  |  |  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=19
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=15,17 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  |  runtime filters: RF022[bloom] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk, RF023[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  147:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=17 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |  |
|  |  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF022[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  146:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 146(GETNEXT), 10(OPEN)
|  |  |
|  |  145:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  15:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=8,10,12 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 10(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  144:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=12 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=12 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=8,10 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
|  |  |
|  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  143:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 11(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=8 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 10(GETNEXT)
|  |
|  142:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=149.12K cost=25263984
|  |  in pipelines: 142(GETNEXT), 23(OPEN)
|  |
|  141:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=17.89M cost=2975838
|  |  in pipelines: 23(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=17.89M cost=3047563509
|  |  in pipelines: 23(GETNEXT)
|  |
|  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=14
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=24,26,28 row-size=32B cardinality=2.16G cost=944945506
|  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |
|  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  140:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=28 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 26(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  26:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=28 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 26(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=24,26 row-size=24B cardinality=2.16G cost=944945506
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  |  runtime filters: RF015[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  139:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=26 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=24 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 23(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=20
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=44B cardinality=511.32M cost=223870100
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=311.57MB mem-reservation=306.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=20 plan-id=21 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=306.00MB mem-reservation=306.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  138:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=18.45MB mem-reservation=18.44MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=17.44MB mem-reservation=17.44MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  137:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 02(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=11.21GB Threads=328
Per-Host Resource Estimates: Memory=30.79GB
F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END, aggif(valid_tid(152,153,154,155,156) IN (152, 153, 154, 155, 156), CASE valid_tid(152,153,154,155,156) WHEN 152 THEN sum(SALES) WHEN 153 THEN sum(SALES) WHEN 154 THEN sum(SALES) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) END), aggif(valid_tid(152,153,154,155,156) IN (152, 153, 154, 155, 156), CASE valid_tid(152,153,154,155,156) WHEN 152 THEN sum(NUMBER_SALES) WHEN 153 THEN sum(NUMBER_SALES) WHEN 154 THEN sum(NUMBER_SALES) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
223:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=158 row-size=48B cardinality=100 cost=34
|  in pipelines: 136(GETNEXT)
|
F92:PLAN FRAGMENT [HASH(CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(CHANNEL) WHEN 153 THEN murmur_hash(CHANNEL) WHEN 154 THEN murmur_hash(CHANNEL) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_BRAND_ID) WHEN 153 THEN murmur_hash(I_BRAND_ID) WHEN 154 THEN murmur_hash(I_BRAND_ID) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CLASS_ID) WHEN 153 THEN murmur_hash(I_CLASS_ID) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CATEGORY_ID) WHEN 153 THEN murmur_hash(NULL) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[13125702, 10687615, 20955666, 157] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
136:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(152,153,154,155,156) WHEN 152 THEN CHANNEL WHEN 153 THEN CHANNEL WHEN 154 THEN CHANNEL WHEN 155 THEN CHANNEL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_BRAND_ID WHEN 153 THEN I_BRAND_ID WHEN 154 THEN I_BRAND_ID WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CLASS_ID WHEN 153 THEN I_CLASS_ID WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST, CASE valid_tid(152,153,154,155,156) WHEN 152 THEN I_CATEGORY_ID WHEN 153 THEN NULL WHEN 154 THEN NULL WHEN 155 THEN NULL WHEN 156 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=158 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 136(GETNEXT), 135(OPEN)
|
135:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(152,153,154,155,156) IN (CAST(152 AS INT), CAST(153 AS INT), CAST(154 AS INT), CAST(155 AS INT), CAST(156 AS INT)), CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN sum(SALES) WHEN CAST(153 AS INT) THEN sum(SALES) WHEN CAST(154 AS INT) THEN sum(SALES) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) END), aggif(valid_tid(152,153,154,155,156) IN (CAST(152 AS INT), CAST(153 AS INT), CAST(154 AS INT), CAST(155 AS INT), CAST(156 AS INT)), CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(153 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(154 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN CHANNEL WHEN CAST(153 AS INT) THEN CHANNEL WHEN CAST(154 AS INT) THEN CHANNEL WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_BRAND_ID WHEN CAST(153 AS INT) THEN I_BRAND_ID WHEN CAST(154 AS INT) THEN I_BRAND_ID WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_CLASS_ID WHEN CAST(153 AS INT) THEN I_CLASS_ID WHEN CAST(154 AS INT) THEN NULL WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN I_CATEGORY_ID WHEN CAST(153 AS INT) THEN NULL WHEN CAST(154 AS INT) THEN NULL WHEN CAST(155 AS INT) THEN NULL WHEN CAST(156 AS INT) THEN NULL END, CASE valid_tid(152,153,154,155,156) WHEN CAST(152 AS INT) THEN CAST(152 AS INT) WHEN CAST(153 AS INT) THEN CAST(153 AS INT) WHEN CAST(154 AS INT) THEN CAST(154 AS INT) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=157 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 135(GETNEXT), 222(OPEN)
|
222:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=10687785
|  in pipelines: 222(GETNEXT), 158(OPEN), 186(OPEN), 214(OPEN)
|
221:EXCHANGE [HASH(CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(CHANNEL) WHEN 153 THEN murmur_hash(CHANNEL) WHEN 154 THEN murmur_hash(CHANNEL) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_BRAND_ID) WHEN 153 THEN murmur_hash(I_BRAND_ID) WHEN 154 THEN murmur_hash(I_BRAND_ID) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CLASS_ID) WHEN 153 THEN murmur_hash(I_CLASS_ID) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END,CASE valid_tid(152,153,154,155,156) WHEN 152 THEN murmur_hash(I_CATEGORY_ID) WHEN 153 THEN murmur_hash(NULL) WHEN 154 THEN murmur_hash(NULL) WHEN 155 THEN murmur_hash(NULL) WHEN 156 THEN murmur_hash(NULL) END)]
|  mem-estimate=32.85MB mem-reservation=0B thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=2437917
|  in pipelines: 158(GETNEXT), 186(GETNEXT), 214(GETNEXT)
|
F91:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
Per-Instance Resources: mem-estimate=555.67MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=90 segment-costs=[29697476, 24044235, 16389428, 11505411, 32269345] cpu-comparison-result=1557 [max(90 (self) vs 1557 (sum children))]
134:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=152N,153N,154N,155N,156N row-size=240B cardinality=1.79M cost=11334183
|  in pipelines: 158(GETNEXT), 186(GETNEXT), 214(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=151 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 158(GETNEXT), 186(GETNEXT), 214(GETNEXT)
|
|--133:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=134,150 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 214(GETNEXT), 219(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  220:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=150 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 219(GETNEXT)
|  |  |
|  |  F90:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  219:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=150 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 219(GETNEXT), 132(OPEN)
|  |  |
|  |  218:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 132(GETNEXT)
|  |  |
|  |  F89:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  132:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=149 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 132(GETNEXT), 123(OPEN), 126(OPEN), 129(OPEN)
|  |  |
|  |  121:UNION
|  |  |  pass-through-operands: 122
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 123(GETNEXT), 126(GETNEXT), 129(GETNEXT)
|  |  |
|  |  |--131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=144,146 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |  |
|  |  |  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  217:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=146 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 130(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=146 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=144 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 129(GETNEXT)
|  |  |
|  |  122:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=143 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 123(GETNEXT), 126(GETNEXT)
|  |  |
|  |  |--128:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=139,141 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 126(GETNEXT), 127(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  216:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=141 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 127(GETNEXT)
|  |  |  |  |
|  |  |  |  F85:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  127:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=141 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 127(GETNEXT)
|  |  |  |
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=139 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=135,137 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 123(GETNEXT), 124(OPEN)
|  |  |
|  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  215:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=137 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 124(GETNEXT)
|  |  |  |
|  |  |  F83:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  124:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=137 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 124(GETNEXT)
|  |  |
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=135 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 123(GETNEXT)
|  |
|  214:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=149.12K cost=13862637
|  |  in pipelines: 214(GETNEXT), 90(OPEN)
|  |
|  213:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  mem-estimate=11.17MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=9.13M cost=2526791
|  |  in pipelines: 90(GETNEXT)
|  |
|  F61:PLAN FRAGMENT [RANDOM] hosts=10 instances=30 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=40.06MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=30 segment-costs=[236319811, 25876095] cpu-comparison-result=399 [max(30 (self) vs 399 (sum children))]
|  120:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=134 row-size=36B cardinality=9.13M cost=59804268
|  |  in pipelines: 90(GETNEXT)
|  |
|  119:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=101,103,105 row-size=44B cardinality=12.78M cost=35103222
|  |  in pipelines: 90(GETNEXT), 210(OPEN)
|  |
|  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=11.29MB mem-reservation=9.62MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  runtime filters: RF060[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF061[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  mem-estimate=8.62MB mem-reservation=8.62MB spill-buffer=128.00KB thread-reservation=0 cost=36000
|  |  |
|  |  212:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=47840
|  |  |  in pipelines: 210(GETNEXT)
|  |  |
|  |  F79:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=131.67MB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 126325] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  118:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=33
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_10.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_10.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_10.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 210(GETNEXT), 95(OPEN)
|  |  |
|  |  |--F127:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_category_id, tpcds_partitioned_parquet_snap.item_10.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  211:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=107 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F80:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_10.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_10.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=107 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  210:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 210(GETNEXT), 198(OPEN), 208(OPEN)
|  |  |
|  |  209:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 198(GETNEXT), 208(GETNEXT)
|  |  |
|  |  F78:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  117:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 198(GETNEXT), 208(GETNEXT)
|  |  |
|  |  96:UNION
|  |  |  pass-through-operands: 198
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=132 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 198(GETNEXT), 208(GETNEXT)
|  |  |
|  |  |--208:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 208(GETNEXT), 202(OPEN), 206(OPEN)
|  |  |  |
|  |  |  207:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 202(GETNEXT), 206(GETNEXT)
|  |  |  |
|  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  110:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 202(GETNEXT), 206(GETNEXT)
|  |  |  |
|  |  |  97:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=123 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 202(GETNEXT), 206(GETNEXT)
|  |  |  |
|  |  |  |--206:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 206(GETNEXT), 104(OPEN)
|  |  |  |  |
|  |  |  |  205:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  109:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=38
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118,120 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 104(GETNEXT), 107(OPEN)
|  |  |  |  |
|  |  |  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  204:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=120 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 107(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  107:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=120 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=39
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 104(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  |  runtime filters: RF083[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  203:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=118 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 105(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  105:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=118 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF083[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  202:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 202(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  201:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  103:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=36
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=109,111,113 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 98(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F130:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  200:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=113 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=113 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=109,111 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--F131:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  runtime filters: RF078[bloom] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk, RF079[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=111 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  F69:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  99:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=111 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF079[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk, RF078[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  198:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 198(GETNEXT), 111(OPEN)
|  |  |
|  |  197:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  116:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125,127,129 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |  |
|  |  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  196:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=129 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 114(GETNEXT)
|  |  |  |
|  |  |  F66:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  114:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=129 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=125,127 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |  |
|  |  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  |  runtime filters: RF075[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  195:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=127 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=127 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 112(GETNEXT)
|  |  |
|  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF075[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=125 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 111(GETNEXT)
|  |
|  94:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=101,103,105 row-size=44B cardinality=127.83M cost=55967115
|  |  in pipelines: 90(GETNEXT), 93(OPEN)
|  |
|  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=107.57MB mem-reservation=102.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=102.00MB mem-reservation=102.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  194:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=105 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 93(GETNEXT)
|  |  |
|  |  F63:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  93:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF060[bloom] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=105 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 93(GETNEXT)
|  |
|  92:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=101,103 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 90(GETNEXT), 91(OPEN)
|  |
|  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.83MB mem-reservation=6.81MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=5.81MB mem-reservation=5.81MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  193:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=103 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 91(GETNEXT)
|  |  |
|  |  F62:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=103 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 91(GETNEXT)
|  |
|  90:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk, RF060[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=101 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 90(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=100 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 158(GETNEXT), 186(GETNEXT)
|
|--89:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83,99 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 186(GETNEXT), 191(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  192:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 191(GETNEXT)
|  |  |
|  |  F59:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  191:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 191(GETNEXT), 88(OPEN)
|  |  |
|  |  190:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 88(GETNEXT)
|  |  |
|  |  F58:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  88:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 88(GETNEXT), 79(OPEN), 82(OPEN), 85(OPEN)
|  |  |
|  |  77:UNION
|  |  |  pass-through-operands: 78
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=97 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 79(GETNEXT), 82(GETNEXT), 85(GETNEXT)
|  |  |
|  |  |--87:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=93,95 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |  |  |
|  |  |  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 86(GETNEXT)
|  |  |  |  |
|  |  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 86(GETNEXT)
|  |  |  |
|  |  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=93 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 85(GETNEXT)
|  |  |
|  |  78:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=92 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 79(GETNEXT), 82(GETNEXT)
|  |  |
|  |  |--84:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=88,90 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 82(GETNEXT), 83(OPEN)
|  |  |  |
|  |  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  188:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=90 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 83(GETNEXT)
|  |  |  |  |
|  |  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  83:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=90 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 83(GETNEXT)
|  |  |  |
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=88 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=84,86 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 79(GETNEXT), 80(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  187:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=86 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 80(GETNEXT)
|  |  |  |
|  |  |  F52:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=86 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  79:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=84 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 79(GETNEXT)
|  |
|  186:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=149.12K cost=20286572
|  |  in pipelines: 186(GETNEXT), 46(OPEN)
|  |
|  185:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  mem-estimate=11.95MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=13.58M cost=3757663
|  |  in pipelines: 46(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [RANDOM] hosts=10 instances=50 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  Per-Instance Resources: mem-estimate=40.06MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=50 segment-costs=[449952526, 38481081] cpu-comparison-result=399 [max(50 (self) vs 399 (sum children))]
|  76:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=83 row-size=36B cardinality=13.58M cost=98259531
|  |  in pipelines: 46(GETNEXT)
|  |
|  75:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=50,52,54 row-size=44B cardinality=25.46M cost=69940341
|  |  in pipelines: 46(GETNEXT), 182(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=17.04MB mem-reservation=15.38MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  runtime filters: RF030[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF031[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  mem-estimate=14.38MB mem-reservation=14.38MB spill-buffer=128.00KB thread-reservation=0 cost=36000
|  |  |
|  |  184:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82,56 row-size=36B cardinality=36.00K cost=47840
|  |  |  in pipelines: 182(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=131.67MB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 126325] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  74:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=23
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_5.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_5.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82,56 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 182(GETNEXT), 51(OPEN)
|  |  |
|  |  |--F117:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=23 plan-id=24 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_category_id, tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  183:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=56 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 51(GETNEXT)
|  |  |  |
|  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_5.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_5.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=56 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 51(GETNEXT)
|  |  |
|  |  182:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 182(GETNEXT), 170(OPEN), 180(OPEN)
|  |  |
|  |  181:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 170(GETNEXT), 180(GETNEXT)
|  |  |
|  |  F47:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  73:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 170(GETNEXT), 180(GETNEXT)
|  |  |
|  |  52:UNION
|  |  |  pass-through-operands: 170
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=81 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 170(GETNEXT), 180(GETNEXT)
|  |  |
|  |  |--180:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 180(GETNEXT), 174(OPEN), 178(OPEN)
|  |  |  |
|  |  |  179:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  66:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |  |  |
|  |  |  53:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |  |  |
|  |  |  |--178:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 178(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  64:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=28
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=65,67,69 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 60(GETNEXT), 63(OPEN)
|  |  |  |  |
|  |  |  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=69 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 63(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  63:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=69 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 63(GETNEXT)
|  |  |  |  |
|  |  |  |  62:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=29
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=65,67 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 60(GETNEXT), 61(OPEN)
|  |  |  |  |
|  |  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  |  runtime filters: RF053[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=67 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 61(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  61:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=67 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 61(GETNEXT)
|  |  |  |  |
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF053[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=65 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  174:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 174(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  173:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  59:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=64 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  58:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=26
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,60,62 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 54(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  172:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=62 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=62 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=58,60 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 54(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  runtime filters: RF048[bloom] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk, RF049[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  171:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=60 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=60 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF049[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk, RF048[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=58 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 54(GETNEXT)
|  |  |
|  |  170:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 170(GETNEXT), 67(OPEN)
|  |  |
|  |  169:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 67(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  72:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 67(GETNEXT)
|  |  |
|  |  71:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=74,76,78 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |  |
|  |  |--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  168:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=78 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 70(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=78 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 70(GETNEXT)
|  |  |
|  |  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=74,76 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  |  runtime filters: RF045[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  167:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=76 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 68(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  68:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=76 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 68(GETNEXT)
|  |  |
|  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF045[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=74 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 67(GETNEXT)
|  |
|  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50,52,54 row-size=44B cardinality=254.69M cost=111509966
|  |  in pipelines: 46(GETNEXT), 49(OPEN)
|  |
|  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=175.57MB mem-reservation=170.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=170.00MB mem-reservation=170.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  166:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=54 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 49(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=54 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 49(GETNEXT)
|  |
|  48:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=50,52 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 46(GETNEXT), 47(OPEN)
|  |
|  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=10.70MB mem-reservation=10.69MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=9.69MB mem-reservation=9.69MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  165:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=52 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=52 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 47(GETNEXT)
|  |
|  46:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=50 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 46(GETNEXT)
|
45:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=33,49 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 158(GETNEXT), 163(OPEN)
|
|--F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  164:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 163(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  163:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 163(GETNEXT), 44(OPEN)
|  |
|  162:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 44(GETNEXT)
|  |
|  F28:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  44:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=48 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 44(GETNEXT), 35(OPEN), 38(OPEN), 41(OPEN)
|  |
|  33:UNION
|  |  pass-through-operands: 34
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=47 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 35(GETNEXT), 38(GETNEXT), 41(GETNEXT)
|  |
|  |--43:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=43,45 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 41(GETNEXT), 42(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  161:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 42(GETNEXT)
|  |  |  |
|  |  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  42:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 42(GETNEXT)
|  |  |
|  |  41:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=43 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 41(GETNEXT)
|  |
|  34:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=42 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,40 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  160:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 39(GETNEXT)
|  |  |  |
|  |  |  F24:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 38(GETNEXT)
|  |
|  37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 36(GETNEXT)
|  |  |
|  |  F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 36(GETNEXT)
|  |
|  35:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=34 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 35(GETNEXT)
|
158:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=149.12K cost=25030787
|  in pipelines: 158(GETNEXT), 02(OPEN)
|
157:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  mem-estimate=13.52MB mem-reservation=0B thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=16.87M cost=4666689
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
Per-Instance Resources: mem-estimate=40.06MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=90 segment-costs=[856245596, 47790137] cpu-comparison-result=399 [max(90 (self) vs 399 (sum children))]
32:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=33 row-size=36B cardinality=16.87M cost=150178248
|  in pipelines: 02(GETNEXT)
|
31:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=0,2,4 row-size=44B cardinality=51.11M cost=140413917
|  in pipelines: 02(GETNEXT), 154(OPEN)
|
|--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=28.54MB mem-reservation=26.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  mem-estimate=25.88MB mem-reservation=25.88MB spill-buffer=128.00KB thread-reservation=0 cost=36000
|  |
|  156:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=32,6 row-size=36B cardinality=36.00K cost=47840
|  |  in pipelines: 154(GETNEXT)
|  |
|  F18:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=131.67MB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 126325] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  30:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_0.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_0.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=32,6 row-size=36B cardinality=36.00K cost=121271
|  |  in pipelines: 154(GETNEXT), 07(OPEN)
|  |
|  |--F107:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[42649]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_category_id, tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  155:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=16B cardinality=36.00K cost=6649
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[148701]
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_0.i_item_sk)
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_0.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 07(GETNEXT)
|  |
|  154:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 154(GETNEXT), 142(OPEN), 152(OPEN)
|  |
|  153:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 142(GETNEXT), 152(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  29:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 142(GETNEXT), 152(GETNEXT)
|  |
|  08:UNION
|  |  pass-through-operands: 142
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 142(GETNEXT), 152(GETNEXT)
|  |
|  |--152:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 152(GETNEXT), 146(OPEN), 150(OPEN)
|  |  |
|  |  151:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 146(GETNEXT), 150(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  22:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 146(GETNEXT), 150(GETNEXT)
|  |  |
|  |  09:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 146(GETNEXT), 150(GETNEXT)
|  |  |
|  |  |--150:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 150(GETNEXT), 16(OPEN)
|  |  |  |
|  |  |  149:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  21:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=21 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=18
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=15,17,19 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 16(GETNEXT), 19(OPEN)
|  |  |  |
|  |  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  148:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=19 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 19(GETNEXT)
|  |  |  |  |
|  |  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  19:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=19 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 19(GETNEXT)
|  |  |  |
|  |  |  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=19
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=15,17 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  |  runtime filters: RF022[bloom] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk, RF023[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  147:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=17 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |  |
|  |  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF022[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  146:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 146(GETNEXT), 10(OPEN)
|  |  |
|  |  145:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  15:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=14 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=8,10,12 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 10(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  144:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=12 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=12 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=8,10 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
|  |  |
|  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  143:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 11(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=8 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 10(GETNEXT)
|  |
|  142:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=149.12K cost=25263984
|  |  in pipelines: 142(GETNEXT), 23(OPEN)
|  |
|  141:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=17.89M cost=2975838
|  |  in pipelines: 23(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=30 row-size=12B cardinality=17.89M cost=3047563509
|  |  in pipelines: 23(GETNEXT)
|  |
|  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=14
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=24,26,28 row-size=32B cardinality=2.16G cost=944945506
|  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |
|  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  140:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=28 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 26(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  26:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=28 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 26(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=24,26 row-size=24B cardinality=2.16G cost=944945506
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  |  runtime filters: RF015[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  139:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=26 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=24 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 23(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=20
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=44B cardinality=511.32M cost=223870100
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=311.57MB mem-reservation=306.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=20 plan-id=21 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=306.00MB mem-reservation=306.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  138:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=18.45MB mem-reservation=18.44MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=17.44MB mem-reservation=17.44MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  137:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 02(GETNEXT)
====
