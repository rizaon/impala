# TPCDS-Q14a first of two
# start query 14 in stream 0 using template query14.tpl using seed 521152908
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1998 AND 1998 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1998 AND 1998 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1998 AND 1998 + 2) x
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2) x)
  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
 limit 100
---- PLAN
Max Per-Host Resource Reservation: Memory=319.38MB Threads=1
Per-Host Resource Estimates: Memory=1009MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=1008.70MB mem-reservation=319.38MB thread-reservation=1 runtime-filters-memory=10.00MB
|  max-parallelism=1 segment-costs=[5106386099, 20422279899, 10211969877, 1760391, 2659596, 1394313, 1529349445, 11061232872, 5106386099, 20422279899, 10211969877, 1760391, 2659596, 1394313, 762521171, 11061232872, 5106386099, 20422279899, 10211969877, 1760391, 2659596, 1394313, 383455865, 11061232872, 91738, 77, 27, 78]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) WHEN 157 THEN sum(SALES) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) WHEN 157 THEN sum(NUMBER_SALES) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=78
|
139:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  mem-estimate=624B mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=13 cost=27
|  in pipelines: 139(GETNEXT), 138(OPEN)
|
138:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) WHEN CAST(157 AS INT) THEN sum(SALES) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(157 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN CHANNEL WHEN CAST(157 AS INT) THEN CHANNEL WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_BRAND_ID WHEN CAST(156 AS INT) THEN I_BRAND_ID WHEN CAST(157 AS INT) THEN I_BRAND_ID WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CLASS_ID WHEN CAST(156 AS INT) THEN I_CLASS_ID WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CATEGORY_ID WHEN CAST(156 AS INT) THEN NULL WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) WHEN CAST(157 AS INT) THEN CAST(157 AS INT) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=160 row-size=52B cardinality=13 cost=77
|  in pipelines: 138(GETNEXT), 137(OPEN)
|
137:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=13 cost=76
|  in pipelines: 137(GETNEXT), 45(OPEN), 90(OPEN), 135(OPEN)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=154 row-size=48B cardinality=3 cost=0
|  in pipelines: 45(GETNEXT), 90(GETNEXT), 135(GETNEXT)
|
|--136:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=153,118 row-size=52B cardinality=1 cost=30554
|  |  in pipelines: 135(GETNEXT), 103(OPEN)
|  |
|  |--103:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=118 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 103(GETNEXT), 94(OPEN), 97(OPEN), 100(OPEN)
|  |  |
|  |  92:UNION
|  |  |  pass-through-operands: 93
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=116 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 94(GETNEXT), 97(GETNEXT), 100(GETNEXT)
|  |  |
|  |  |--102:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=112,114 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--101:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=114 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=112 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  93:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=111 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 94(GETNEXT), 97(GETNEXT)
|  |  |
|  |  |--99:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=107,109 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 97(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  |--98:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=109 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=107 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 97(GETNEXT)
|  |  |
|  |  96:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=103,105 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 94(GETNEXT), 95(OPEN)
|  |  |
|  |  |--95:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=105 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  94:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=103 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 94(GETNEXT)
|  |
|  135:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=149.12K cost=185273043
|  |  in pipelines: 135(GETNEXT), 129(OPEN)
|  |
|  134:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  fk/pk conjuncts: none
|  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=147,149,151,146 row-size=48B cardinality=127.83M cost=56310721
|  |  in pipelines: 129(GETNEXT), 128(OPEN)
|  |
|  |--128:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=360.00K cost=1069444
|  |  |  in pipelines: 128(GETNEXT), 125(OPEN)
|  |  |
|  |  127:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_12.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_12.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=143,144 row-size=36B cardinality=447.36K cost=231809
|  |  |  in pipelines: 125(GETNEXT), 126(OPEN)
|  |  |
|  |  |--126:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_12.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_12.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=144 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 125(GETNEXT), 124(OPEN), 118(OPEN)
|  |  |
|  |  104:UNION
|  |  |  pass-through-operands: 124
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=142 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 124(GETNEXT), 118(GETNEXT)
|  |  |
|  |  |--118:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 118(GETNEXT), 111(OPEN), 117(OPEN)
|  |  |  |
|  |  |  105:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=133 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 111(GETNEXT), 117(GETNEXT)
|  |  |  |
|  |  |  |--117:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 117(GETNEXT), 112(OPEN)
|  |  |  |  |
|  |  |  |  116:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=126,128,130 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  |  in pipelines: 112(GETNEXT), 115(OPEN)
|  |  |  |  |
|  |  |  |  |--115:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=130 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 115(GETNEXT)
|  |  |  |  |
|  |  |  |  114:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  runtime filters: RF082[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF083[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=126,128 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 112(GETNEXT), 113(OPEN)
|  |  |  |  |
|  |  |  |  |--113:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=128 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 113(GETNEXT)
|  |  |  |  |
|  |  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF083[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk, RF082[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=126 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  111:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 111(GETNEXT), 106(OPEN)
|  |  |  |
|  |  |  110:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=119,121,123 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  |  in pipelines: 106(GETNEXT), 109(OPEN)
|  |  |  |
|  |  |  |--109:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=123 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 109(GETNEXT)
|  |  |  |
|  |  |  108:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  runtime filters: RF078[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF079[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=119,121 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 106(GETNEXT), 107(OPEN)
|  |  |  |
|  |  |  |--107:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=121 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |
|  |  |  106:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF079[min_max] -> tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk, RF078[bloom] -> tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=119 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 106(GETNEXT)
|  |  |
|  |  124:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  in pipelines: 124(GETNEXT), 119(OPEN)
|  |  |
|  |  123:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=135,137,139 row-size=32B cardinality=2.16G cost=944952811
|  |  |  in pipelines: 119(GETNEXT), 122(OPEN)
|  |  |
|  |  |--122:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=139 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  121:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  runtime filters: RF075[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=135,137 row-size=24B cardinality=2.16G cost=945305506
|  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |
|  |  |--120:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=137 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 120(GETNEXT)
|  |  |
|  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF075[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=135 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 119(GETNEXT)
|  |
|  133:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=147,149,151 row-size=44B cardinality=127.83M cost=56327115
|  |  in pipelines: 129(GETNEXT), 132(OPEN)
|  |
|  |--132:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=151 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 132(GETNEXT)
|  |
|  131:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=147,149 row-size=28B cardinality=127.89M cost=55978804
|  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |
|  |--130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=149 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 130(GETNEXT)
|  |
|  129:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=147 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 129(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=2 cost=0
|  in pipelines: 45(GETNEXT), 90(GETNEXT)
|
|--91:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=101,66 row-size=52B cardinality=1 cost=30554
|  |  in pipelines: 90(GETNEXT), 58(OPEN)
|  |
|  |--58:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=66 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 58(GETNEXT), 49(OPEN), 52(OPEN), 55(OPEN)
|  |  |
|  |  47:UNION
|  |  |  pass-through-operands: 48
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 49(GETNEXT), 52(GETNEXT), 55(GETNEXT)
|  |  |
|  |  |--57:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,62 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 55(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  |--56:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=62 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 55(GETNEXT)
|  |  |
|  |  48:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=59 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 49(GETNEXT), 52(GETNEXT)
|  |  |
|  |  |--54:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=55,57 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 52(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  |--53:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=55 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=51,53 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 49(GETNEXT), 50(OPEN)
|  |  |
|  |  |--50:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=53 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=51 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 49(GETNEXT)
|  |
|  90:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=149.12K cost=368471435
|  |  in pipelines: 90(GETNEXT), 84(OPEN)
|  |
|  89:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  fk/pk conjuncts: none
|  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=95,97,99,94 row-size=48B cardinality=254.69M cost=111837302
|  |  in pipelines: 84(GETNEXT), 83(OPEN)
|  |
|  |--83:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=360.00K cost=1069444
|  |  |  in pipelines: 83(GETNEXT), 80(OPEN)
|  |  |
|  |  82:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_7.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_7.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=91,92 row-size=36B cardinality=447.36K cost=231809
|  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |
|  |  |--81:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_7.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_7.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=92 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 81(GETNEXT)
|  |  |
|  |  80:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 80(GETNEXT), 79(OPEN), 73(OPEN)
|  |  |
|  |  59:UNION
|  |  |  pass-through-operands: 79
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=90 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 79(GETNEXT), 73(GETNEXT)
|  |  |
|  |  |--73:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 73(GETNEXT), 66(OPEN), 72(OPEN)
|  |  |  |
|  |  |  60:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=81 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 66(GETNEXT), 72(GETNEXT)
|  |  |  |
|  |  |  |--72:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 72(GETNEXT), 67(OPEN)
|  |  |  |  |
|  |  |  |  71:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=74,76,78 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |  |  |  |
|  |  |  |  |--70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=78 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 70(GETNEXT)
|  |  |  |  |
|  |  |  |  69:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  runtime filters: RF052[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF053[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=74,76 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |  |  |  |
|  |  |  |  |--68:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=76 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 68(GETNEXT)
|  |  |  |  |
|  |  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF053[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF052[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=74 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  66:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 66(GETNEXT), 61(OPEN)
|  |  |  |
|  |  |  65:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=67,69,71 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  |  in pipelines: 61(GETNEXT), 64(OPEN)
|  |  |  |
|  |  |  |--64:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=71 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  63:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  runtime filters: RF048[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF049[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=67,69 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 61(GETNEXT), 62(OPEN)
|  |  |  |
|  |  |  |--62:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=69 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 62(GETNEXT)
|  |  |  |
|  |  |  61:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF049[min_max] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk, RF048[bloom] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=67 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 61(GETNEXT)
|  |  |
|  |  79:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  in pipelines: 79(GETNEXT), 74(OPEN)
|  |  |
|  |  78:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=83,85,87 row-size=32B cardinality=2.16G cost=944952811
|  |  |  in pipelines: 74(GETNEXT), 77(OPEN)
|  |  |
|  |  |--77:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=87 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  runtime filters: RF045[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=83,85 row-size=24B cardinality=2.16G cost=945305506
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--75:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=85 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF045[min_max] -> tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=83 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 74(GETNEXT)
|  |
|  88:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=95,97,99 row-size=44B cardinality=254.69M cost=111869966
|  |  in pipelines: 84(GETNEXT), 87(OPEN)
|  |
|  |--87:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=99 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 87(GETNEXT)
|  |
|  86:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=95,97 row-size=28B cardinality=254.82M cost=111533149
|  |  in pipelines: 84(GETNEXT), 85(OPEN)
|  |
|  |--85:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=97 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 85(GETNEXT)
|  |
|  84:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=95 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 84(GETNEXT)
|
46:NESTED LOOP JOIN [INNER JOIN]
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity, tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=50,15 row-size=52B cardinality=1 cost=30554
|  in pipelines: 45(GETNEXT), 13(OPEN)
|
|--13:AGGREGATE [FINALIZE]
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 13(GETNEXT), 04(OPEN), 07(OPEN), 10(OPEN)
|  |
|  02:UNION
|  |  pass-through-operands: 03
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 04(GETNEXT), 07(GETNEXT), 10(GETNEXT)
|  |
|  |--12:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,11 row-size=20B cardinality=2.16G cost=945425284
|  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
|  |  |
|  |  |--11:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 10(GETNEXT)
|  |
|  03:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 04(GETNEXT), 07(GETNEXT)
|  |
|  |--09:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=4,6 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  in pipelines: 07(GETNEXT), 08(OPEN)
|  |  |
|  |  |--08:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 08(GETNEXT)
|  |  |
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=4 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 07(GETNEXT)
|  |
|  06:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0,2 row-size=20B cardinality=8.64G cost=3781706938
|  |  in pipelines: 04(GETNEXT), 05(OPEN)
|  |
|  |--05:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=2 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=0 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 04(GETNEXT)
|
45:AGGREGATE [FINALIZE]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=149.12K cost=739071710
|  in pipelines: 45(GETNEXT), 39(OPEN)
|
44:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  fk/pk conjuncts: none
|  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=44,46,48,43 row-size=48B cardinality=511.32M cost=224164524
|  in pipelines: 39(GETNEXT), 38(OPEN)
|
|--38:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=360.00K cost=1069444
|  |  in pipelines: 38(GETNEXT), 35(OPEN)
|  |
|  37:HASH JOIN [INNER JOIN]
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_2.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_2.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=40,41 row-size=36B cardinality=447.36K cost=231809
|  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |
|  |--36:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_2.i_item_sk)
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_2.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=41 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 36(GETNEXT)
|  |
|  35:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 35(GETNEXT), 34(OPEN), 28(OPEN)
|  |
|  14:UNION
|  |  pass-through-operands: 34
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=39 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 34(GETNEXT), 28(GETNEXT)
|  |
|  |--28:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 28(GETNEXT), 21(OPEN), 27(OPEN)
|  |  |
|  |  15:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=30 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 21(GETNEXT), 27(GETNEXT)
|  |  |
|  |  |--27:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  in pipelines: 27(GETNEXT), 22(OPEN)
|  |  |  |
|  |  |  26:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=23,25,27 row-size=32B cardinality=4.32G cost=1889960460
|  |  |  |  in pipelines: 22(GETNEXT), 25(OPEN)
|  |  |  |
|  |  |  |--25:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 25(GETNEXT)
|  |  |  |
|  |  |  24:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  runtime filters: RF022[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF023[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=23,25 row-size=24B cardinality=4.32G cost=1890313155
|  |  |  |  in pipelines: 22(GETNEXT), 23(OPEN)
|  |  |  |
|  |  |  |--23:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=25 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 23(GETNEXT)
|  |  |  |
|  |  |  22:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk, RF022[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=23 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 22(GETNEXT)
|  |  |
|  |  21:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  in pipelines: 21(GETNEXT), 16(OPEN)
|  |  |
|  |  20:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=16,18,20 row-size=32B cardinality=8.64G cost=3779817034
|  |  |  in pipelines: 16(GETNEXT), 19(OPEN)
|  |  |
|  |  |--19:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=20 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 19(GETNEXT)
|  |  |
|  |  18:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=16,18 row-size=24B cardinality=8.64G cost=3780169729
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--17:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=18 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=16 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 16(GETNEXT)
|  |
|  34:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=149.12K cost=2967204009
|  |  in pipelines: 34(GETNEXT), 29(OPEN)
|  |
|  33:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=32,34,36 row-size=32B cardinality=2.16G cost=944952811
|  |  in pipelines: 29(GETNEXT), 32(OPEN)
|  |
|  |--32:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 32(GETNEXT)
|  |
|  31:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  runtime filters: RF014[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF015[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32,34 row-size=24B cardinality=2.16G cost=945305506
|  |  in pipelines: 29(GETNEXT), 30(OPEN)
|  |
|  |--30:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=34 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 30(GETNEXT)
|  |
|  29:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk, RF014[bloom] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=32 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 29(GETNEXT)
|
43:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=44,46,48 row-size=44B cardinality=511.32M cost=224230100
|  in pipelines: 39(GETNEXT), 42(OPEN)
|
|--42:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item_3.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=48 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 42(GETNEXT)
|
41:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=44,46 row-size=28B cardinality=511.58M cost=223916534
|  in pipelines: 39(GETNEXT), 40(OPEN)
|
|--40:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=46 row-size=12B cardinality=108 cost=16728
|     in pipelines: 40(GETNEXT)
|
39:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=44 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 39(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=12.24GB Threads=341
Per-Host Resource Estimates: Memory=32.98GB
F96:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[82] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) WHEN 157 THEN sum(SALES) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) WHEN 157 THEN sum(NUMBER_SALES) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=78
|
232:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=13 cost=4
|  in pipelines: 139(GETNEXT)
|
F95:PLAN FRAGMENT [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[96, 77, 27, 20] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
139:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  mem-estimate=624B mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=13 cost=27
|  in pipelines: 139(GETNEXT), 138(OPEN)
|
138:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) WHEN CAST(157 AS INT) THEN sum(SALES) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(157 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN CHANNEL WHEN CAST(157 AS INT) THEN CHANNEL WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_BRAND_ID WHEN CAST(156 AS INT) THEN I_BRAND_ID WHEN CAST(157 AS INT) THEN I_BRAND_ID WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CLASS_ID WHEN CAST(156 AS INT) THEN I_CLASS_ID WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CATEGORY_ID WHEN CAST(156 AS INT) THEN NULL WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) WHEN CAST(157 AS INT) THEN CAST(157 AS INT) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=160 row-size=52B cardinality=13 cost=77
|  in pipelines: 138(GETNEXT), 231(OPEN)
|
231:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=13 cost=76
|  in pipelines: 231(GETNEXT), 163(OPEN), 193(OPEN), 223(OPEN)
|
230:EXCHANGE [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)]
|  mem-estimate=415.49KB mem-reservation=0B thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=15 cost=20
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Instance Resources: mem-estimate=556.41MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=109 segment-costs=[31467972, 31467972, 31443812, 91747, 270] cpu-comparison-result=1557 [max(109 (self) vs 1557 (sum children))]
137:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=15 cost=85
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=154 row-size=48B cardinality=3 cost=0
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
|--136:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=153,118 row-size=52B cardinality=1 cost=30554
|  |  in pipelines: 223(GETNEXT), 228(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  229:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=118 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 228(GETNEXT)
|  |  |
|  |  F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  228:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=118 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 228(GETNEXT), 103(OPEN)
|  |  |
|  |  227:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=117 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 103(GETNEXT)
|  |  |
|  |  F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  103:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=117 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 103(GETNEXT), 94(OPEN), 97(OPEN), 100(OPEN)
|  |  |
|  |  92:UNION
|  |  |  pass-through-operands: 93
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=116 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 94(GETNEXT), 97(GETNEXT), 100(GETNEXT)
|  |  |
|  |  |--102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=112,114 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  226:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=114 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F91:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=114 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=112 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  93:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=111 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 94(GETNEXT), 97(GETNEXT)
|  |  |
|  |  |--99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=107,109 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 97(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  |--F107:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  225:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=109 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=109 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=107 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 97(GETNEXT)
|  |  |
|  |  96:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=103,105 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 94(GETNEXT), 95(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  224:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=105 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F86:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=105 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  94:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=103 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 94(GETNEXT)
|  |
|  223:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=149.12K cost=26496317
|  |  in pipelines: 223(GETNEXT), 129(OPEN)
|  |
|  222:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  mem-estimate=11.95MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=17.88M cost=4947495
|  |  in pipelines: 129(GETNEXT)
|  |
|  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=50 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=50 segment-costs=[462932005, 50665788] cpu-comparison-result=399 [max(50 (self) vs 399 (sum children))]
|  135:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=17.88M cost=265568963
|  |  in pipelines: 129(GETNEXT)
|  |
|  134:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=147,149,151,146 row-size=48B cardinality=127.83M cost=55950721
|  |  in pipelines: 129(GETNEXT), 220(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=86.45MB mem-reservation=85.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=85.00MB mem-reservation=85.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  221:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 220(GETNEXT)
|  |  |
|  |  F83:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  220:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 220(GETNEXT), 217(OPEN)
|  |  |
|  |  219:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 217(GETNEXT)
|  |  |
|  |  F81:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  128:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 217(GETNEXT)
|  |  |
|  |  127:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=33
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_12.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_12.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=143,144 row-size=36B cardinality=447.36K cost=195809
|  |  |  in pipelines: 217(GETNEXT), 126(OPEN)
|  |  |
|  |  |--F130:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_category_id, tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  218:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=144 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 126(GETNEXT)
|  |  |  |
|  |  |  F82:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_12.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_12.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=144 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  217:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 217(GETNEXT), 205(OPEN), 215(OPEN)
|  |  |
|  |  216:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 205(GETNEXT), 215(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  125:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 205(GETNEXT), 215(GETNEXT)
|  |  |
|  |  104:UNION
|  |  |  pass-through-operands: 205
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=142 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 205(GETNEXT), 215(GETNEXT)
|  |  |
|  |  |--215:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 215(GETNEXT), 209(OPEN), 213(OPEN)
|  |  |  |
|  |  |  214:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 209(GETNEXT), 213(GETNEXT)
|  |  |  |
|  |  |  F78:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  118:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 209(GETNEXT), 213(GETNEXT)
|  |  |  |
|  |  |  105:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=133 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 209(GETNEXT), 213(GETNEXT)
|  |  |  |
|  |  |  |--213:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 213(GETNEXT), 112(OPEN)
|  |  |  |  |
|  |  |  |  212:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |  |
|  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  117:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |  |
|  |  |  |  116:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=38
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=126,128,130 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 112(GETNEXT), 115(OPEN)
|  |  |  |  |
|  |  |  |  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  211:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=130 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 115(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  115:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=130 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 115(GETNEXT)
|  |  |  |  |
|  |  |  |  114:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=39
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=126,128 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 112(GETNEXT), 113(OPEN)
|  |  |  |  |
|  |  |  |  |--F136:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  |  runtime filters: RF082[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF083[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=128 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 113(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  113:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=128 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 113(GETNEXT)
|  |  |  |  |
|  |  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF083[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk, RF082[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=126 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  209:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 209(GETNEXT), 106(OPEN)
|  |  |  |
|  |  |  208:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 106(GETNEXT)
|  |  |  |
|  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  111:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 106(GETNEXT)
|  |  |  |
|  |  |  110:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=36
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=119,121,123 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 106(GETNEXT), 109(OPEN)
|  |  |  |
|  |  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  207:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=123 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 109(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  109:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=123 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 109(GETNEXT)
|  |  |  |
|  |  |  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=119,121 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 106(GETNEXT), 107(OPEN)
|  |  |  |
|  |  |  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  |  runtime filters: RF078[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF079[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=121 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  107:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=121 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |
|  |  |  106:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF079[min_max] -> tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk, RF078[bloom] -> tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=119 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 106(GETNEXT)
|  |  |
|  |  205:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 205(GETNEXT), 119(OPEN)
|  |  |
|  |  204:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 119(GETNEXT)
|  |  |
|  |  F66:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  124:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 119(GETNEXT)
|  |  |
|  |  123:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=135,137,139 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 119(GETNEXT), 122(OPEN)
|  |  |
|  |  |--F131:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  203:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=139 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 122(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=139 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=135,137 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |
|  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  runtime filters: RF075[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  202:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=137 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=137 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 120(GETNEXT)
|  |  |
|  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF075[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=135 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 119(GETNEXT)
|  |
|  133:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=147,149,151 row-size=44B cardinality=127.83M cost=55967115
|  |  in pipelines: 129(GETNEXT), 132(OPEN)
|  |
|  |--F137:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=175.57MB mem-reservation=170.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=170.00MB mem-reservation=170.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  201:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=151 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 132(GETNEXT)
|  |  |
|  |  F65:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=151 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 132(GETNEXT)
|  |
|  131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=147,149 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |
|  |--F138:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=10.70MB mem-reservation=10.69MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  mem-estimate=9.69MB mem-reservation=9.69MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  200:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 130(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=149 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 130(GETNEXT)
|  |
|  129:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=147 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 129(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=2 cost=0
|  in pipelines: 163(GETNEXT), 193(GETNEXT)
|
|--91:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=101,66 row-size=52B cardinality=1 cost=30554
|  |  in pipelines: 193(GETNEXT), 198(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  199:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=66 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 198(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  198:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=66 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 198(GETNEXT), 58(OPEN)
|  |  |
|  |  197:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 58(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  58:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 58(GETNEXT), 49(OPEN), 52(OPEN), 55(OPEN)
|  |  |
|  |  47:UNION
|  |  |  pass-through-operands: 48
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 49(GETNEXT), 52(GETNEXT), 55(GETNEXT)
|  |  |
|  |  |--57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,62 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 55(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  196:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=62 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=62 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 55(GETNEXT)
|  |  |
|  |  48:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=59 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 49(GETNEXT), 52(GETNEXT)
|  |  |
|  |  |--54:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=55,57 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 52(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  195:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |  |
|  |  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=55 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=51,53 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 49(GETNEXT), 50(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  194:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=53 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 50(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=53 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=51 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 49(GETNEXT)
|  |
|  193:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=149.12K cost=26516592
|  |  in pipelines: 193(GETNEXT), 84(OPEN)
|  |
|  192:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  mem-estimate=13.52MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=17.89M cost=4951380
|  |  in pipelines: 84(GETNEXT)
|  |
|  F31:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=90 segment-costs=[842060891, 50705571] cpu-comparison-result=399 [max(90 (self) vs 399 (sum children))]
|  90:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=17.89M cost=448830935
|  |  in pipelines: 84(GETNEXT)
|  |
|  89:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=95,97,99,94 row-size=48B cardinality=254.69M cost=111477302
|  |  in pipelines: 84(GETNEXT), 190(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=154.45MB mem-reservation=153.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=153.00MB mem-reservation=153.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  191:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 190(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  190:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 190(GETNEXT), 187(OPEN)
|  |  |
|  |  189:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 187(GETNEXT)
|  |  |
|  |  F49:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  83:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 187(GETNEXT)
|  |  |
|  |  82:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=23
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_7.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_7.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=91,92 row-size=36B cardinality=447.36K cost=195809
|  |  |  in pipelines: 187(GETNEXT), 81(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=23 plan-id=24 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_category_id, tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  188:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=92 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  F50:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_7.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_7.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=92 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 81(GETNEXT)
|  |  |
|  |  187:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 187(GETNEXT), 175(OPEN), 185(OPEN)
|  |  |
|  |  186:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 175(GETNEXT), 185(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  80:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 175(GETNEXT), 185(GETNEXT)
|  |  |
|  |  59:UNION
|  |  |  pass-through-operands: 175
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=90 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 175(GETNEXT), 185(GETNEXT)
|  |  |
|  |  |--185:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 185(GETNEXT), 179(OPEN), 183(OPEN)
|  |  |  |
|  |  |  184:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 179(GETNEXT), 183(GETNEXT)
|  |  |  |
|  |  |  F46:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  73:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 179(GETNEXT), 183(GETNEXT)
|  |  |  |
|  |  |  60:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=81 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 179(GETNEXT), 183(GETNEXT)
|  |  |  |
|  |  |  |--183:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 183(GETNEXT), 67(OPEN)
|  |  |  |  |
|  |  |  |  182:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  72:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  71:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=28
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=74,76,78 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |  |  |  |
|  |  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=78 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 70(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F44:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=78 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 70(GETNEXT)
|  |  |  |  |
|  |  |  |  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=29
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=74,76 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |  |  |  |
|  |  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  |  runtime filters: RF052[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF053[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=76 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 68(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  68:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=76 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 68(GETNEXT)
|  |  |  |  |
|  |  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF053[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF052[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=74 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  179:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 179(GETNEXT), 61(OPEN)
|  |  |  |
|  |  |  178:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 61(GETNEXT)
|  |  |  |
|  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  66:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 61(GETNEXT)
|  |  |  |
|  |  |  65:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=26
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=67,69,71 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 61(GETNEXT), 64(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  177:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 64(GETNEXT)
|  |  |  |  |
|  |  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  64:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=71 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  63:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=67,69 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 61(GETNEXT), 62(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  |  runtime filters: RF048[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF049[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=69 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 62(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  62:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=69 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 62(GETNEXT)
|  |  |  |
|  |  |  61:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF049[min_max] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk, RF048[bloom] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=67 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 61(GETNEXT)
|  |  |
|  |  175:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 175(GETNEXT), 74(OPEN)
|  |  |
|  |  174:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 74(GETNEXT)
|  |  |
|  |  F34:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  79:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 74(GETNEXT)
|  |  |
|  |  78:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=83,85,87 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 74(GETNEXT), 77(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  173:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=87 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 77(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=87 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=83,85 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  runtime filters: RF045[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  172:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=85 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 75(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=85 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF045[min_max] -> tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=83 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 74(GETNEXT)
|  |
|  88:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=95,97,99 row-size=44B cardinality=254.69M cost=111509966
|  |  in pipelines: 84(GETNEXT), 87(OPEN)
|  |
|  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=311.57MB mem-reservation=306.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=306.00MB mem-reservation=306.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  171:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=99 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 87(GETNEXT)
|  |
|  86:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=95,97 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 84(GETNEXT), 85(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=18.45MB mem-reservation=18.44MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  mem-estimate=17.44MB mem-reservation=17.44MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  170:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=97 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 85(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=97 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 85(GETNEXT)
|  |
|  84:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=95 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 84(GETNEXT)
|
46:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity, tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=50,15 row-size=52B cardinality=1 cost=30554
|  in pipelines: 163(GETNEXT), 168(OPEN)
|
|--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  169:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=15 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 168(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  168:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 168(GETNEXT), 13(OPEN)
|  |
|  167:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=14 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 13(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  13:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 13(GETNEXT), 04(OPEN), 07(OPEN), 10(OPEN)
|  |
|  02:UNION
|  |  pass-through-operands: 03
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 04(GETNEXT), 07(GETNEXT), 10(GETNEXT)
|  |
|  |--12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,11 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 11(GETNEXT)
|  |  |  |
|  |  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 10(GETNEXT)
|  |
|  03:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 04(GETNEXT), 07(GETNEXT)
|  |
|  |--09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=4,6 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 07(GETNEXT), 08(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=6 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 08(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 08(GETNEXT)
|  |  |
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=4 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 07(GETNEXT)
|  |
|  06:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0,2 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 04(GETNEXT), 05(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  164:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 05(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  05:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=2 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=0 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 04(GETNEXT)
|
163:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity, tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=149.12K cost=26516592
|  in pipelines: 163(GETNEXT), 39(OPEN)
|
162:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  mem-estimate=14.26MB mem-reservation=0B thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=17.89M cost=4951380
|  in pipelines: 39(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=43.03MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=109 segment-costs=[1608889166, 50705571] cpu-comparison-result=399 [max(109 (self) vs 399 (sum children))]
45:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=17.89M cost=819431211
|  in pipelines: 39(GETNEXT)
|
44:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  fk/pk conjuncts: none
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=44,46,48,43 row-size=48B cardinality=511.32M cost=223804524
|  in pipelines: 39(GETNEXT), 160(OPEN)
|
|--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=188.45MB mem-reservation=187.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |
|  161:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=360.00K cost=478440
|  |  in pipelines: 160(GETNEXT)
|  |
|  F20:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_2.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  160:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=360.00K cost=1068777
|  |  in pipelines: 160(GETNEXT), 157(OPEN)
|  |
|  159:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_item_sk)]
|  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=445.08K cost=57637
|  |  in pipelines: 157(GETNEXT)
|  |
|  F18:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  38:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=445.08K cost=1291265
|  |  in pipelines: 157(GETNEXT)
|  |
|  37:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_2.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_2.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=40,41 row-size=36B cardinality=447.36K cost=195809
|  |  in pipelines: 157(GETNEXT), 36(OPEN)
|  |
|  |--F110:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[42649]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_category_id, tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  158:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=16B cardinality=36.00K cost=6649
|  |  |  in pipelines: 36(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[148701]
|  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_2.i_item_sk)
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_2.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=41 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 36(GETNEXT)
|  |
|  157:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 157(GETNEXT), 145(OPEN), 155(OPEN)
|  |
|  156:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 145(GETNEXT), 155(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  35:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 145(GETNEXT), 155(GETNEXT)
|  |
|  14:UNION
|  |  pass-through-operands: 145
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=39 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 145(GETNEXT), 155(GETNEXT)
|  |
|  |--155:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 155(GETNEXT), 149(OPEN), 153(OPEN)
|  |  |
|  |  154:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 149(GETNEXT), 153(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  28:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 149(GETNEXT), 153(GETNEXT)
|  |  |
|  |  15:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=30 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 149(GETNEXT), 153(GETNEXT)
|  |  |
|  |  |--153:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 153(GETNEXT), 22(OPEN)
|  |  |  |
|  |  |  152:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 22(GETNEXT)
|  |  |  |
|  |  |  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  27:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 22(GETNEXT)
|  |  |  |
|  |  |  26:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=18
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=23,25,27 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 22(GETNEXT), 25(OPEN)
|  |  |  |
|  |  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  151:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 25(GETNEXT)
|  |  |  |  |
|  |  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  25:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 25(GETNEXT)
|  |  |  |
|  |  |  24:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=19
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=23,25 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 22(GETNEXT), 23(OPEN)
|  |  |  |
|  |  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  |  runtime filters: RF022[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF023[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  150:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=25 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 23(GETNEXT)
|  |  |  |  |
|  |  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  23:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=25 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 23(GETNEXT)
|  |  |  |
|  |  |  22:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk, RF022[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=23 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 22(GETNEXT)
|  |  |
|  |  149:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 149(GETNEXT), 16(OPEN)
|  |  |
|  |  148:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=16,18,20 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 16(GETNEXT), 19(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  147:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=20 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 19(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  19:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=20 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 19(GETNEXT)
|  |  |
|  |  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=16,18 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  146:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=18 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=18 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=16 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 16(GETNEXT)
|  |
|  145:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=149.12K cost=25263984
|  |  in pipelines: 145(GETNEXT), 29(OPEN)
|  |
|  144:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=17.89M cost=2975838
|  |  in pipelines: 29(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  34:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=17.89M cost=3047563509
|  |  in pipelines: 29(GETNEXT)
|  |
|  33:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=14
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=32,34,36 row-size=32B cardinality=2.16G cost=944945506
|  |  in pipelines: 29(GETNEXT), 32(OPEN)
|  |
|  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  143:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 32(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  32:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 32(GETNEXT)
|  |
|  31:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32,34 row-size=24B cardinality=2.16G cost=944945506
|  |  in pipelines: 29(GETNEXT), 30(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  runtime filters: RF014[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF015[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  142:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=34 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 30(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  30:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=34 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 30(GETNEXT)
|  |
|  29:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk, RF014[bloom] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=32 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 29(GETNEXT)
|
43:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=20
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=44,46,48 row-size=44B cardinality=511.32M cost=223870100
|  in pipelines: 39(GETNEXT), 42(OPEN)
|
|--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=379.57MB mem-reservation=374.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=20 plan-id=21 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  141:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 42(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  42:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item_3.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=48 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 42(GETNEXT)
|
41:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=44,46 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 39(GETNEXT), 40(OPEN)
|
|--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.33MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  140:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=46 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 40(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  40:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=46 row-size=12B cardinality=108 cost=16728
|     in pipelines: 40(GETNEXT)
|
39:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=44 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 39(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=12.24GB Threads=341
Per-Host Resource Estimates: Memory=32.98GB
F96:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[82] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) WHEN 157 THEN sum(SALES) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) WHEN 157 THEN sum(NUMBER_SALES) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=78
|
232:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=13 cost=4
|  in pipelines: 139(GETNEXT)
|
F95:PLAN FRAGMENT [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[96, 77, 27, 20] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
139:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  mem-estimate=624B mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=13 cost=27
|  in pipelines: 139(GETNEXT), 138(OPEN)
|
138:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) WHEN CAST(157 AS INT) THEN sum(SALES) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(157 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN CHANNEL WHEN CAST(157 AS INT) THEN CHANNEL WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_BRAND_ID WHEN CAST(156 AS INT) THEN I_BRAND_ID WHEN CAST(157 AS INT) THEN I_BRAND_ID WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CLASS_ID WHEN CAST(156 AS INT) THEN I_CLASS_ID WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CATEGORY_ID WHEN CAST(156 AS INT) THEN NULL WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) WHEN CAST(157 AS INT) THEN CAST(157 AS INT) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=160 row-size=52B cardinality=13 cost=77
|  in pipelines: 138(GETNEXT), 231(OPEN)
|
231:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=13 cost=76
|  in pipelines: 231(GETNEXT), 163(OPEN), 193(OPEN), 223(OPEN)
|
230:EXCHANGE [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)]
|  mem-estimate=415.49KB mem-reservation=0B thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=15 cost=20
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Instance Resources: mem-estimate=556.41MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=109 segment-costs=[31467972, 31467972, 31443812, 91747, 270] cpu-comparison-result=1557 [max(109 (self) vs 1557 (sum children))]
137:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=15 cost=85
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=154 row-size=48B cardinality=3 cost=0
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
|--136:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=153,118 row-size=52B cardinality=1 cost=30554
|  |  in pipelines: 223(GETNEXT), 228(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  229:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=118 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 228(GETNEXT)
|  |  |
|  |  F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  228:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=118 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 228(GETNEXT), 103(OPEN)
|  |  |
|  |  227:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=117 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 103(GETNEXT)
|  |  |
|  |  F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  103:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=117 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 103(GETNEXT), 94(OPEN), 97(OPEN), 100(OPEN)
|  |  |
|  |  92:UNION
|  |  |  pass-through-operands: 93
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=116 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 94(GETNEXT), 97(GETNEXT), 100(GETNEXT)
|  |  |
|  |  |--102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=112,114 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  226:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=114 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F91:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=114 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=112 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  93:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=111 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 94(GETNEXT), 97(GETNEXT)
|  |  |
|  |  |--99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=107,109 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 97(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  |--F107:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  225:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=109 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=109 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=107 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 97(GETNEXT)
|  |  |
|  |  96:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=103,105 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 94(GETNEXT), 95(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  224:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=105 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F86:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=105 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  94:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=103 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 94(GETNEXT)
|  |
|  223:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=149.12K cost=26496317
|  |  in pipelines: 223(GETNEXT), 129(OPEN)
|  |
|  222:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  mem-estimate=11.95MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=17.88M cost=4947495
|  |  in pipelines: 129(GETNEXT)
|  |
|  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=50 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=50 segment-costs=[462932005, 50665788] cpu-comparison-result=399 [max(50 (self) vs 399 (sum children))]
|  135:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_5.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_5.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=153 row-size=36B cardinality=17.88M cost=265568963
|  |  in pipelines: 129(GETNEXT)
|  |
|  134:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=147,149,151,146 row-size=48B cardinality=127.83M cost=55950721
|  |  in pipelines: 129(GETNEXT), 220(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=86.45MB mem-reservation=85.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=85.00MB mem-reservation=85.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  221:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 220(GETNEXT)
|  |  |
|  |  F83:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  220:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 220(GETNEXT), 217(OPEN)
|  |  |
|  |  219:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 217(GETNEXT)
|  |  |
|  |  F81:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  128:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=146 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 217(GETNEXT)
|  |  |
|  |  127:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=33
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_12.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_12.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=143,144 row-size=36B cardinality=447.36K cost=195809
|  |  |  in pipelines: 217(GETNEXT), 126(OPEN)
|  |  |
|  |  |--F130:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_category_id, tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  218:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=144 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 126(GETNEXT)
|  |  |  |
|  |  |  F82:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_12.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_12.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=144 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  217:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 217(GETNEXT), 205(OPEN), 215(OPEN)
|  |  |
|  |  216:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 205(GETNEXT), 215(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  125:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=143 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 205(GETNEXT), 215(GETNEXT)
|  |  |
|  |  104:UNION
|  |  |  pass-through-operands: 205
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=142 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 205(GETNEXT), 215(GETNEXT)
|  |  |
|  |  |--215:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 215(GETNEXT), 209(OPEN), 213(OPEN)
|  |  |  |
|  |  |  214:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 209(GETNEXT), 213(GETNEXT)
|  |  |  |
|  |  |  F78:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  118:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 209(GETNEXT), 213(GETNEXT)
|  |  |  |
|  |  |  105:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=133 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 209(GETNEXT), 213(GETNEXT)
|  |  |  |
|  |  |  |--213:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 213(GETNEXT), 112(OPEN)
|  |  |  |  |
|  |  |  |  212:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |  |
|  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  117:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=132 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |  |
|  |  |  |  116:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=38
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=126,128,130 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 112(GETNEXT), 115(OPEN)
|  |  |  |  |
|  |  |  |  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  211:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=130 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 115(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  115:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=130 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 115(GETNEXT)
|  |  |  |  |
|  |  |  |  114:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=39
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=126,128 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 112(GETNEXT), 113(OPEN)
|  |  |  |  |
|  |  |  |  |--F136:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  |  runtime filters: RF082[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF083[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=128 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 113(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  113:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=128 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 113(GETNEXT)
|  |  |  |  |
|  |  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF083[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk, RF082[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_5.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=126 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  209:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 209(GETNEXT), 106(OPEN)
|  |  |  |
|  |  |  208:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 106(GETNEXT)
|  |  |  |
|  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  111:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=125 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 106(GETNEXT)
|  |  |  |
|  |  |  110:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=36
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=119,121,123 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 106(GETNEXT), 109(OPEN)
|  |  |  |
|  |  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  207:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=123 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 109(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  109:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=123 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 109(GETNEXT)
|  |  |  |
|  |  |  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=119,121 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 106(GETNEXT), 107(OPEN)
|  |  |  |
|  |  |  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  |  runtime filters: RF078[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF079[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=121 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  107:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=121 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |
|  |  |  106:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF079[min_max] -> tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk, RF078[bloom] -> tpcds_partitioned_parquet_snap.store_sales_5.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=119 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 106(GETNEXT)
|  |  |
|  |  205:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 205(GETNEXT), 119(OPEN)
|  |  |
|  |  204:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 119(GETNEXT)
|  |  |
|  |  F66:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  124:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=141 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 119(GETNEXT)
|  |  |
|  |  123:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=135,137,139 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 119(GETNEXT), 122(OPEN)
|  |  |
|  |  |--F131:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  203:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=139 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 122(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=139 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=135,137 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |
|  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  runtime filters: RF075[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  202:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=137 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=137 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 120(GETNEXT)
|  |  |
|  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF075[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=135 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 119(GETNEXT)
|  |
|  133:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=147,149,151 row-size=44B cardinality=127.83M cost=55967115
|  |  in pipelines: 129(GETNEXT), 132(OPEN)
|  |
|  |--F137:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=175.57MB mem-reservation=170.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=170.00MB mem-reservation=170.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  201:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=151 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 132(GETNEXT)
|  |  |
|  |  F65:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=151 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 132(GETNEXT)
|  |
|  131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=147,149 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |
|  |--F138:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=10.70MB mem-reservation=10.69MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  mem-estimate=9.69MB mem-reservation=9.69MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  200:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 130(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=149 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 130(GETNEXT)
|  |
|  129:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=147 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 129(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=2 cost=0
|  in pipelines: 163(GETNEXT), 193(GETNEXT)
|
|--91:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=101,66 row-size=52B cardinality=1 cost=30554
|  |  in pipelines: 193(GETNEXT), 198(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  199:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=66 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 198(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  198:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=66 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 198(GETNEXT), 58(OPEN)
|  |  |
|  |  197:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 58(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  58:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 58(GETNEXT), 49(OPEN), 52(OPEN), 55(OPEN)
|  |  |
|  |  47:UNION
|  |  |  pass-through-operands: 48
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 49(GETNEXT), 52(GETNEXT), 55(GETNEXT)
|  |  |
|  |  |--57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,62 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 55(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  196:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=62 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=62 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 55(GETNEXT)
|  |  |
|  |  48:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=59 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 49(GETNEXT), 52(GETNEXT)
|  |  |
|  |  |--54:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=55,57 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 52(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  195:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |  |
|  |  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=55 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=51,53 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 49(GETNEXT), 50(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  194:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=53 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 50(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=53 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=51 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 49(GETNEXT)
|  |
|  193:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=149.12K cost=26516592
|  |  in pipelines: 193(GETNEXT), 84(OPEN)
|  |
|  192:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  mem-estimate=13.52MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=17.89M cost=4951380
|  |  in pipelines: 84(GETNEXT)
|  |
|  F31:PLAN FRAGMENT [RANDOM] hosts=10 instances=90 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=90 segment-costs=[842060891, 50705571] cpu-comparison-result=399 [max(90 (self) vs 399 (sum children))]
|  90:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=101 row-size=36B cardinality=17.89M cost=448830935
|  |  in pipelines: 84(GETNEXT)
|  |
|  89:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=95,97,99,94 row-size=48B cardinality=254.69M cost=111477302
|  |  in pipelines: 84(GETNEXT), 190(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=154.45MB mem-reservation=153.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=153.00MB mem-reservation=153.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  191:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 190(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  190:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 190(GETNEXT), 187(OPEN)
|  |  |
|  |  189:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 187(GETNEXT)
|  |  |
|  |  F49:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  83:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=94 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 187(GETNEXT)
|  |  |
|  |  82:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=23
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_7.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_7.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=91,92 row-size=36B cardinality=447.36K cost=195809
|  |  |  in pipelines: 187(GETNEXT), 81(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=23 plan-id=24 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_category_id, tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  188:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=92 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  F50:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_7.i_item_sk)
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_7.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=92 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 81(GETNEXT)
|  |  |
|  |  187:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 187(GETNEXT), 175(OPEN), 185(OPEN)
|  |  |
|  |  186:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 175(GETNEXT), 185(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  80:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=91 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 175(GETNEXT), 185(GETNEXT)
|  |  |
|  |  59:UNION
|  |  |  pass-through-operands: 175
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=90 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 175(GETNEXT), 185(GETNEXT)
|  |  |
|  |  |--185:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 185(GETNEXT), 179(OPEN), 183(OPEN)
|  |  |  |
|  |  |  184:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 179(GETNEXT), 183(GETNEXT)
|  |  |  |
|  |  |  F46:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  73:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=82 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 179(GETNEXT), 183(GETNEXT)
|  |  |  |
|  |  |  60:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=81 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 179(GETNEXT), 183(GETNEXT)
|  |  |  |
|  |  |  |--183:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 183(GETNEXT), 67(OPEN)
|  |  |  |  |
|  |  |  |  182:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  72:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=80 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  71:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=28
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=74,76,78 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |  |  |  |
|  |  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=78 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 70(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F44:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=78 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 70(GETNEXT)
|  |  |  |  |
|  |  |  |  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=29
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=74,76 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |  |  |  |
|  |  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  |  runtime filters: RF052[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF053[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=76 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 68(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  68:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=76 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 68(GETNEXT)
|  |  |  |  |
|  |  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF053[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF052[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=74 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  179:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 179(GETNEXT), 61(OPEN)
|  |  |  |
|  |  |  178:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 61(GETNEXT)
|  |  |  |
|  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  66:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 61(GETNEXT)
|  |  |  |
|  |  |  65:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=26
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=67,69,71 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 61(GETNEXT), 64(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  177:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 64(GETNEXT)
|  |  |  |  |
|  |  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  64:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=71 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  63:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=67,69 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 61(GETNEXT), 62(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  |  runtime filters: RF048[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF049[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=69 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 62(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  62:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=69 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 62(GETNEXT)
|  |  |  |
|  |  |  61:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF049[min_max] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk, RF048[bloom] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=67 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 61(GETNEXT)
|  |  |
|  |  175:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 175(GETNEXT), 74(OPEN)
|  |  |
|  |  174:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 74(GETNEXT)
|  |  |
|  |  F34:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  79:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=89 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 74(GETNEXT)
|  |  |
|  |  78:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=83,85,87 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 74(GETNEXT), 77(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  173:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=87 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 77(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=87 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=83,85 row-size=24B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  runtime filters: RF045[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  172:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=85 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 75(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=85 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF045[min_max] -> tpcds_partitioned_parquet_snap.web_sales_2.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=83 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 74(GETNEXT)
|  |
|  88:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=95,97,99 row-size=44B cardinality=254.69M cost=111509966
|  |  in pipelines: 84(GETNEXT), 87(OPEN)
|  |
|  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=311.57MB mem-reservation=306.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=306.00MB mem-reservation=306.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  171:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=99 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 87(GETNEXT)
|  |
|  86:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=95,97 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 84(GETNEXT), 85(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=18.45MB mem-reservation=18.44MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  mem-estimate=17.44MB mem-reservation=17.44MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  170:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=97 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 85(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=97 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 85(GETNEXT)
|  |
|  84:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=95 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 84(GETNEXT)
|
46:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity, tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=50,15 row-size=52B cardinality=1 cost=30554
|  in pipelines: 163(GETNEXT), 168(OPEN)
|
|--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  169:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=15 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 168(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  168:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 168(GETNEXT), 13(OPEN)
|  |
|  167:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=14 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 13(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  13:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 13(GETNEXT), 04(OPEN), 07(OPEN), 10(OPEN)
|  |
|  02:UNION
|  |  pass-through-operands: 03
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 04(GETNEXT), 07(GETNEXT), 10(GETNEXT)
|  |
|  |--12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,11 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 11(GETNEXT)
|  |  |  |
|  |  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 10(GETNEXT)
|  |
|  03:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 04(GETNEXT), 07(GETNEXT)
|  |
|  |--09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=4,6 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 07(GETNEXT), 08(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=6 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 08(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 08(GETNEXT)
|  |  |
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=4 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 07(GETNEXT)
|  |
|  06:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0,2 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 04(GETNEXT), 05(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  164:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 05(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  05:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=2 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=0 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 04(GETNEXT)
|
163:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity, tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=149.12K cost=26516592
|  in pipelines: 163(GETNEXT), 39(OPEN)
|
162:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  mem-estimate=14.26MB mem-reservation=0B thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=17.89M cost=4951380
|  in pipelines: 39(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=43.03MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=109 segment-costs=[1608889166, 50705571] cpu-comparison-result=399 [max(109 (self) vs 399 (sum children))]
45:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales_1.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales_1.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=50 row-size=36B cardinality=17.89M cost=819431211
|  in pipelines: 39(GETNEXT)
|
44:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  fk/pk conjuncts: none
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=44,46,48,43 row-size=48B cardinality=511.32M cost=223804524
|  in pipelines: 39(GETNEXT), 160(OPEN)
|
|--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=188.45MB mem-reservation=187.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |
|  161:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=360.00K cost=478440
|  |  in pipelines: 160(GETNEXT)
|  |
|  F20:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_2.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  160:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=360.00K cost=1068777
|  |  in pipelines: 160(GETNEXT), 157(OPEN)
|  |
|  159:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_item_sk)]
|  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=445.08K cost=57637
|  |  in pipelines: 157(GETNEXT)
|  |
|  F18:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  38:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=43 row-size=4B cardinality=445.08K cost=1291265
|  |  in pipelines: 157(GETNEXT)
|  |
|  37:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_2.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_2.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=40,41 row-size=36B cardinality=447.36K cost=195809
|  |  in pipelines: 157(GETNEXT), 36(OPEN)
|  |
|  |--F110:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=2.15MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[42649]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_category_id, tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  158:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=16B cardinality=36.00K cost=6649
|  |  |  in pipelines: 36(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[148701]
|  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_2.i_item_sk)
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_2.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=41 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 36(GETNEXT)
|  |
|  157:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 157(GETNEXT), 145(OPEN), 155(OPEN)
|  |
|  156:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 145(GETNEXT), 155(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  35:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=40 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 145(GETNEXT), 155(GETNEXT)
|  |
|  14:UNION
|  |  pass-through-operands: 145
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=39 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 145(GETNEXT), 155(GETNEXT)
|  |
|  |--155:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 155(GETNEXT), 149(OPEN), 153(OPEN)
|  |  |
|  |  154:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 149(GETNEXT), 153(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  28:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 149(GETNEXT), 153(GETNEXT)
|  |  |
|  |  15:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=30 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 149(GETNEXT), 153(GETNEXT)
|  |  |
|  |  |--153:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 153(GETNEXT), 22(OPEN)
|  |  |  |
|  |  |  152:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 22(GETNEXT)
|  |  |  |
|  |  |  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10291866608, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  27:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 22(GETNEXT)
|  |  |  |
|  |  |  26:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=18
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=23,25,27 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 22(GETNEXT), 25(OPEN)
|  |  |  |
|  |  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  151:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 25(GETNEXT)
|  |  |  |  |
|  |  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  25:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 25(GETNEXT)
|  |  |  |
|  |  |  24:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=19
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=23,25 row-size=24B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 22(GETNEXT), 23(OPEN)
|  |  |  |
|  |  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  |  runtime filters: RF022[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF023[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  150:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=25 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 23(GETNEXT)
|  |  |  |  |
|  |  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  23:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=25 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 23(GETNEXT)
|  |  |  |
|  |  |  22:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk, RF022[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=23 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 22(GETNEXT)
|  |  |
|  |  149:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 149(GETNEXT), 16(OPEN)
|  |  |
|  |  148:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502176631, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=22 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=16,18,20 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 16(GETNEXT), 19(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  147:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=20 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 19(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  19:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=20 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 19(GETNEXT)
|  |  |
|  |  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=16,18 row-size=24B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  146:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=18 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=18 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=16 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 16(GETNEXT)
|  |
|  145:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=149.12K cost=25263984
|  |  in pipelines: 145(GETNEXT), 29(OPEN)
|  |
|  144:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=17.89M cost=2975838
|  |  in pipelines: 29(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  max-parallelism=520 segment-costs=[5186282830, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  34:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=38 row-size=12B cardinality=17.89M cost=3047563509
|  |  in pipelines: 29(GETNEXT)
|  |
|  33:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=14
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=32,34,36 row-size=32B cardinality=2.16G cost=944945506
|  |  in pipelines: 29(GETNEXT), 32(OPEN)
|  |
|  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  143:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 32(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  32:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 32(GETNEXT)
|  |
|  31:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32,34 row-size=24B cardinality=2.16G cost=944945506
|  |  in pipelines: 29(GETNEXT), 30(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=414.57MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  runtime filters: RF014[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF015[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  142:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=34 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 30(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  30:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=34 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 30(GETNEXT)
|  |
|  29:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk, RF014[bloom] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=32 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 29(GETNEXT)
|
43:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=20
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=44,46,48 row-size=44B cardinality=511.32M cost=223870100
|  in pipelines: 39(GETNEXT), 42(OPEN)
|
|--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=379.57MB mem-reservation=374.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=20 plan-id=21 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  141:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 42(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  42:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item_3.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=48 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 42(GETNEXT)
|
41:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=44,46 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 39(GETNEXT), 40(OPEN)
|
|--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.33MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  140:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=46 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 40(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  40:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=46 row-size=12B cardinality=108 cost=16728
|     in pipelines: 40(GETNEXT)
|
39:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=44 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 39(GETNEXT)
====
